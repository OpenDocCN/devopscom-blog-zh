# 高级自动化–让您的系统为您服务

> 原文:[https://devo PS . com/advanced-automation-getting-systems-work/](https://devops.com/advanced-automation-getting-systems-work/)

在我之前的帖子中，我讨论了如何通过补丁和更新，将您的 [DevOps](http://getcloudify.org/cloud_orchestration_cloud_automation.html) 提升到一个新的水平，超越基础设施自动化，实现部署和代码推送的自动化。

然后我承诺让它变得有趣…这是下一个阶段——实际使用提取的数据让您的系统为您工作。

### 监控，就像这是你的事一样

让我们从讨论监控应用程序意味着什么，以及可以从中提取什么样的数据开始。

在最基本的层面上，您想知道您的应用程序是否对您的用户可用。听起来很基础很简单，但是设置得当，其实并不是一件容易的事情。它旨在为您的业务提供最重要问题的答案:我的用户可以使用该应用程序吗？把它想象成你仪表板上的一盏大红灯或绿灯。虽然答案看似显而易见和简单，但其实根本不是。在回答这个问题时，有各种各样的参数需要考虑，例如，如果系统表面上已经启动并在运行，但响应时间非常慢，或者如果只有部分系统在实际运行，该怎么办。在一天结束时，您希望有一个提醒的“交通灯”,告诉您系统是否正常工作——是/否，向上/向下。

### 系统、应用和业务指标

绿-红交通灯是多级监控的集合。最基本的是系统相关。它包含进程可用性、CPU 和内存利用率等指标。

下一级监控与应用程序相关，由应用程序级 KPI(关键性能指标)组成。KPI 可以是从用户对某个请求的平均响应时间到并发数据库连接的数量。换句话说，任何特定于应用程序及其架构的东西。

在这些之上，是最高级别的指标，即业务指标。最终这些才是真正重要的。如果您的业务指标正常，那么您可以假设一切都运行良好。示例业务指标包括注册网站的失败率、有多少用户在网站上执行了某项操作或有多少用户执行了某项特定交易。如果我们想非常具体，那么以 Google hangout 为例，他们的一个商业指标将是在特定时间内有多少人加入或开始了一个 hangout。

### 救援日志

这里经常使用日志作为收集指标和警告错误情况的手段。日志通常包含许多有用的信息，但是您需要能够提取并理解这些信息。这意味着收集从所有服务器发出的所有日志，解析它们，并寻找特定的模式来帮助您随着时间的推移生成 KPI。例如，您查找一条日志消息，上面写着“用户 X 登录”，通过对这些消息进行计数，您可以生成一个业务级别的指标，来衡量一段时间内有多少用户进行了注册。如果您在日志消息中添加更多的数据，比如用户的位置、操作系统或任何相关的东西，您可以对数据进行分割，从而更深入地了解应用程序的行为。当日志以结构化和一致的方式发出时(例如，以 JSON 格式)，分析它们并生成相关的 KPI 就变得非常容易。有许多[工具](http://logstash.net/)可以帮助你做到这一点。

### 从简单的自动化到流程编排

这就是编排发挥作用的地方。在最基本的层面上，流程编排是自动化的更高形式，它可以帮助您设置与应用程序相关的所有部分，从基础架构(虚拟机、网络、数据块存储卷、安全组等)开始。)，应用程序运行的平台(数据库、web 服务器等)。)，一直到应用程序模块和代码。这整个设置通常被称为[拓扑](http://docs.oasis-open.org/tosca/TOSCA/v1.0/TOSCA-v1.0.html)。编排框架的作用是具体化某个拓扑。更高级的编排器不仅仅是具体化拓扑，而是对其进行更改，以满足应用程序当前的工作负载和需求。

您现在可能已经意识到，监控和日志收集是任何正在运行的应用程序的重要组成部分，因此它们应该是编排好的应用程序拓扑中不可或缺的一部分。因为编排过程是拓扑感知的，所以它可以非常容易地为您的应用程序组件连接和配置监控，这是它最大的好处之一。在没有全局拓扑视图的情况下完成这些过程通常非常耗时，而且容易出错。此外，随着拓扑结构的变化，您需要重新配置和重新连接您的监控工具，一个好的指挥者也会为您这样做。

### 下一个:反应式和主动式编排，Devops 圣杯

希望到目前为止，您已经将编排的价值视为自动化的更高形式。在下一篇文章中，我将深入探讨后设置阶段，并讨论编排工具如何对事件和监控数据做出反应，以及如何调整应用程序的运行时拓扑结构以最大限度地适应当前的工作负载。