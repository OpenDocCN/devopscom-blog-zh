# 要持续:你的公司必须全力以赴做连续交货吗？

> 原文：<https://devops.com/continuous-company-continuous-delivery/>

在[持续](https://twitter.com/continuouscast)的这一部分中，Edith Harbaugh 和 Paul Biggar 讨论了持续交付的范围，以及持续交付在哪些情况下可行，哪些情况下不可行。

![Edith Harbaugh, CEO LaunchDarkly](img/959d7f6b353cdba9034e43827b064d75.png)

伊迪丝是“功能标志即服务”的持续交付工具[launch darky](http://launchdarkly.com/)的首席执行官和联合创始人。LaunchDarkly 使软件团队能够快速启动、测量和控制他们的功能。

![Paul Biggar, CEO CircleCI](img/9a99d84d981527b171383842e23d372f.png)保罗是  [ CircleCI ](https://circleci.com/)  的创始人，这是一个持续集成和部署平台，可以自动化开发工作流和 IT 操作，使开发人员能够更快地交付优质软件。

* * *

[soundcloud url=”https://api.soundcloud.com/tracks/231204216?secret_token=s-45TTy” params=”auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&visual=false” width=”100%” height=”166″ iframe=”true” /]

* * *

伊迪丝:保罗，连续送货一定要全力以赴吗？

保罗:所以我认为答案显然是否定的。特别是，你知道答案肯定是否定的，因为没有人会全身心投入，或者至少如果你开始一个新项目，你可以全身心投入，而许多项目并不是全身心投入的。

所以有人从某个地方开始，他们说，“现在我们要以某种方式进行连续交付，”所以他们必须以某种方式从零到完全连续交付。

**伊迪丝:**

> 人们有这样一种观念，持续交付仅仅意味着在你想要的任何时候推送，许多非常老的学校开发商店就是这样做的。他们只是不停地修补和生产。

保罗:对。所以，我的意思是，我们称之为连续交付？我感觉 SSH-ing 进入服务器的想法在某种程度上不是连续交付。

伊迪丝:但是人们有这种误解，因为他们喜欢，“哦，在这是一个东西之前，我有一个连续的交付，我只是修补它的生产。”

保罗:我将在这里押上一大笔钱，说如果你将连续交付定义为“我 SSH 到生产服务器”，那么你就没有做好连续交付。事实上，你做得大错特错。

伊迪丝:那你到底做错了什么？你跳过了哪些步骤？

保罗:

> 关键是你有这个发布软件的自动化过程。而 SSH-进入生产服务器则正好相反。

这并不是说你不应该在偶尔的紧急情况下这样做。偶尔，如果我们遇到某种灾难，我们会通过 SSH 进入生产服务器，替换一些代码，在服务器上执行一些代码，以保持现状，防止客户注意到或事情发生。

但这与连续交付管道、发布工作流或自动化发布工作流不同，后者本质上是连续交付。

伊迪丝:因此，连续交付不仅仅是将产品运送到生产部门，更重要的是其背后的所有流程。

保罗:这是一个过程。所以，当你考虑你能不能有点连续交付时，我想你正在看的是不是有一个轻量级版本，当我们在所有和没有之间转换时，我们可以获得连续交付的一些好处？

伊迪丝:你能不能，你必须全力以赴，或者你能不能持续一点？

保罗:

> 我认为一点点持续的一个非常明显的例子是，你交付代码，你让自动化发布过程构建某种工件，然后有人通过单击手动部署它。

或者，事实上，在构建和测试发生的地方，剩下的自动化发布过程是由一个人说“现在我们要发布了”而触发的，然后其他一切都是脚本化的，所以他们只有一个输入，就是现在。

伊迪丝:哦，那真的很有趣。所以，你认为要真正做到持续，就必须完全自动化，所有的事情都必须被推动吗？

保罗:不，不。我不这么认为。我认为这很大程度上取决于团队的规模之类的事情。但是我已经看到了一些例子，在这些例子中，我们的客户要求特定的东西，这表明他们有某种半连续的工作流。

其中一个例子是，一个团队只想在工作时间进行连续交付。

伊迪丝:是的。

**Paul:** 还有另一个团队，他们只想在午夜进行连续交付，因为这是他们网站上唯一没有足够客户来清理缓存的时间。

伊迪丝:是的。

**Paul:** 现在，如果他们想要完成连续交付，他们必须说，“我们将清除缓存的一个子集，”或者有一些其他的缓存策略，允许我们继续或允许我们随时部署，但他们基本上是半连续的。

**Edith:** 我和 [Douglas Squirrel](http://@douglassquirrel) 进行了一次非常有趣的聊天，他实际上听了我们的播客，他为英国的公司做了很多咨询，他说他去了很多公司，这些公司都有持续发展的所有工具。

保罗:好的。

伊迪丝:但是他们实际上并不使用它。

保罗:那到底是什么意思？

**Edith:** 他们已经建立了持续集成，理论上，他们可以随时进行部署，但是出于各种原因，他们仍然坚持原来的计划。

保罗:好的。所以，我在第一轮资本博客上看到了这篇非常有趣的文章。

伊迪丝:哦，乔斯林的。

保罗:是的，听起来没错。

伊迪丝: [乔斯林·戈德费恩](https://twitter.com/jgoldfein)，她在脸书，对吗？

保罗:是的，没错。是的。所以，她谈论的是这个想法，即交货时间表在某些情况下是有用的。在某些情况下，速度很重要，这有点像脸书的情况，在某些情况下，可预测性更重要。例如，如果你正在交付企业软件。

> 一个企业是不会允许你不断地将你的产品交付到他们的防火墙或企业中的。他们想要的是每个季度都有新的东西。

最好是一年多次，但每次您向他们发布时，都会创建一个新的工作流，他们希望能够审核该工作流，查看更改日志，并验证事情是否属实，他们内部可能有一个更改流程。

因此，在那里持续交付不一定是个好主意。但是一个为此而构建的团队可以在内部进行一个持续的交付过程，在这个过程中他们生产所有的工件，并且在每一次推送中完成一次完整的发布。即使它没有被释放。

**伊迪丝:**

> 一个企业不想不断采用新功能的原因有很多，其中很大一部分归结于培训。如果有大的新功能需要向人们推出，那么他们必须承担培训的费用。

保罗:对。

伊迪丝:其实挺有意思的。我和一个来自 Square 的家伙聊了聊，他谈到了他们是如何真正试图限制他们向实际收银员推送的数量的。

保罗:好的。

**伊迪丝:**因为培训费用。我的意思是，咖啡店的收银员正在做大量的其他事情，他们不能突然弹出一些新的功能，并期望他们去体验一下，甚至参观一下。

保罗:对。那是一个有趣的想法。

**Edith:** 因此，尽管他们已经准备好了所有的流程来进行大量的更改，以进行持续交付，但他们实际上限制了他们向真正的最终用户推出的内容。

有趣的是，那些拥有更多用户的人，比如脸书，可以做这些改变，因为他们不一定重视网站上的个人用户

伊迪丝:你正走在一条小路上。

保罗:不，我不是说他们不重视用户。激怒个人用户是安全的。对于 Square 这样的人来说就不那么好了。随着你在价值链上越往上走，他们给你的报酬越多，或者他们在产品决策中的参与越多，你就越不可能激怒他们。

伊迪丝:脸书实际上是一个迷人的例子，因为在任何时候他们都会惹恼别人。这只是一个问题，有点像苹果。

你知道吗？

保罗:对。

伊迪丝:他们总是惹毛某个人，就是那个人。

保罗:你有没有听说今天在脸书，所有的旗帜都挂上了？

伊迪丝:是 LinkedIn。

保罗:哦，是 LinkedIn 吗？好吧。

伊迪丝:雅。好吧，这可能发生在每个做过特色标志的人身上。总有一天会这样。

保罗:对。

伊迪丝:而且，还很丑。脸书很迷人。实际上，我写了一篇关于脸书和他们如何使用特征标志的[博文](http://blog.launchdarkly.com/secret-to-facebooks-hacker-engineering-culture/)。他们有一个产品叫做看门人。

保罗:对。

伊迪丝:那控制着一切，一切。在他们经历了一场巨大的公关灾难后，我想是在 2011 年，通过他们的新闻反馈，他们真的很在乎他们是否惹恼了很多人。

保罗:对，对。

**Edith:** 这就是为什么他们实施了 Gatekeeper，在那里他们进行了大量的 1%部署。

**Paul:** 我记得当我建立 Circle 的时候，我坐下来和我在脸书工作的朋友聊了聊他们的工作流程之类的事情，他们的发布流程是代码在周二发布，每个发布代码的人，或者有即将发布的代码的人，都必须在发布流程中可用。

发布过程没有开启任何功能，因为这都是由 Gatekeeper 完成的，但是代码本身必须被发布出去。他们必须确认一切保持不变，每个人都必须到场。因此，他们有一个相当连续的交付过程，但仍然手动发布。

**伊迪丝:**嗯丫。你希望有某种强制措施，让人们关注这些东西。

保罗:在什么意义上关心？

**Edith:** 我在脸书也听说过这样一个例子，它太大了，以至于所有的团队都无法相互协调。因此，实际上他们所做的是，当他们使用 Gatekeeper 推出东西时，他们会在内部向仅限脸书的员工推出，这就是他们如何发现东西是否损坏的。这与 CircleCI 这样的小公司不同。

保罗:对。但是被推出的代码和被推出的特性是有区别的。

他们不做，我不知道现在的故事是什么，但当时他们肯定没有在代码上做持续交付。或连续释放或随便你怎么称呼它。

伊迪丝:我实际上并不在脸书工作，但我确实听说——他们真的无法协调。当你是一家小公司时，你仍然可以在 HipChat 或 Slack room 中进行协调，比如，“嘿，我们现在正在推动这个，开始寻找变化。”

保罗:对。

**伊迪丝:**

> 但是在脸书，他们知道东西坏了的唯一方法是有人投诉。

**Paul:**AWS 上有一个关于微服务的有趣讨论。我猜他们当时并不称之为微服务，而是拥有完全面向服务的架构。

因此，他们谈论的一件事是，当您滚动或持续部署一项服务时，您可能会中断其他服务。所以，实际上坏掉的东西可能和警报开始响起的人没有任何关系。事实上，离谁的警报响起可能还有几步之遥。

**伊迪丝:**谷歌也有类似的系统，我听说他们监控 200 多个不同的指标。他们监测的一个问题是，人们会不会说，“Gmail 更烂？”在推特上。

保罗:哦。有意思。

> 我想知道的是，就你能持续交付的多少而言，如果你是谷歌或脸书，你有完整的代码回购，你发布的东西是不同于像亚马逊这样的人的发布过程，他们有我所说的纯粹的持续交付。

每个服务都有自己的持续交付方式，您的依赖关系可能会随时发生变化，而您实际上并不知道发生了什么。与脸书相比，我们正在将这个数千兆字节的二进制文件上传到一组服务器上，当然，我们正在慢慢发布，也许我们一周或一天会发布多次。

但和亚马逊每 11 秒发布一次不太一样。我认为我们可以看到，即使在这些拥有非常先进的发布流程的大公司之间，你也可以说他们在持续交付方面显然处于不同的范围。

伊迪丝:那么，你认为有 10 名开发人员的中型公司适合做什么？

保罗:我的意思是，这里有很多不同的东西。你的客户群是谁？您需要的安全级别是什么？让我们假设它是一个消费者网络应用程序。如果它是一个消费者网络应用程序，我希望该公司应该一直持续提供。尤其是如果砸东西稍微没问题的话。

伊迪丝:是的。

保罗:或者至少，你可以在几分钟之内把坏掉的东西复原。这样规模的团队可能没有资源来完善他们的持续交付过程。但是看起来他们更有可能通过持续交付来获得成功，而不是不通过持续交付。所以风险更低，速度更快。诸如此类的事情。

伊迪丝:有趣的是，持续交付甚至渗透到了风险投资界。杰森·莱姆金，萨斯特背后的人，

保罗:对。

Edith: 他昨天在推特上说，他的一个尽职调查问题是“你多久能回滚一次，这有用吗？”

保罗:对。

伊迪丝:有趣的是，我认为这是一件非常技术性的事情，就像“你能倒回去吗？”但对风投来说，这被视为技术成熟的标志。

要了解更多关于连续播出的内容和新剧集，您可以在 Twitter 上关注该剧，网址为 [@continuouscast](https://twitter.com/continuouscast) 。