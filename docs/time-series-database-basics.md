# 时序数据库基础

> 原文：<https://devops.com/time-series-database-basics/>

在过去的几年里，人们对时间序列数据议论纷纷。无论你在监控什么——财务数据、服务器性能、社交媒体活动或其他完全不同的东西——时间序列数据都可以给你对趋势和模式的宝贵见解。

但是 [时间序列数据库](https://tdengine.com/tsdb/how-to-choose-the-best-time-series-database/) 到底是什么，为什么需要一个？本文将仔细研究时间序列数据库，以及它们如何帮助您理解数据。

## 什么是时序数据库？

时序数据库(TSDB)是一个数据库管理系统，为存储和查询随时间变化的数据而优化。时间序列数据通常用于监控应用，在这些应用中，快速检索有关系统当前状态、趋势和模式的信息非常重要。

在大多数定义中，时间序列数据通常被称为时间戳数据，是按时间顺序索引的一系列值。时间戳是指在不同时间收集的数据，其中每个值都有时间戳。这些数据点通常是从同一来源收集的，用于衡量一段时间内的进展。

**重要提示:**

您可以使用关系数据库或 NoSQL 数据库来处理时间序列数据，但是专门构建的时间序列数据库是为利用时间序列数据的独特功能而定制的。这意味着时序数据库的接收速度更快，查询速度更快，数据压缩效率更高。此外，时间序列数据库包括特殊的分析能力和管理功能，这是大多数关系数据库或 NoSQL 数据库所没有的。

### 一些优势

此列表并不详尽，但以下是使用时序数据库可能带来的一些好处:

1.)时序数据库可以很好地处理高速数据。

2.)时间序列数据库是专门为存储时间序列数据而构建的，使它们在存储和查询方面更加高效。

3.)时间序列数据库通常具有专门为时间序列数据设计的内置分析和管理功能。

4.)许多时间序列数据库是开源的，这意味着它们可以免费使用。

### 一些缺点

在使用时序数据库之前，您还应该了解一些缺点:

1.)时间序列数据库的建立和管理通常比关系数据库或 NoSQL 数据库更复杂。

2.)可供选择的时间序列数据库相对较少，因此在选择满足您特定需求的平台时，您可能没有那么大的灵活性。

3.)时间序列数据可能非常大，因此您需要足够的存储容量来容纳您的数据。

## 时间序列数据的特征是什么？

时间序列数据有几个特点，使其独特，需要特殊处理。从数据库的角度来看，最重要的如下:

1.  **时间戳:**每个数据点都有它的时间戳。时间戳对于计算或分析信息至关重要。
2.  **结构化:**来自设备或监控的指标几乎总是结构化的，不像互联网应用程序产生的那些指标。它们有预先确定的数据类型和长度，在设备固件更新之前，其结构不会改变。
3.  **流状:**音频或视频节目等数据源以固定或恒定的速率生成数据。这些数据流彼此完全不相关。
4.  **稳定流量:**时间序列数据流量在时间上是恒定的，如果在某个采样周期内使用了足够多的数据源，是可以计算和预测的。
5.  **不变性:**这个数据的来源是一个时序数据存储。每个数据点仅创建一次，并且从不更新或更正。像日志数据一样，时序数据通常是只追加的。

## 时间序列数据是如何使用的？

你们中的许多人可能想知道为什么时间序列数据如此重要。答案是，它允许我们跟踪随时间的变化，这对监控和故障排除非常有价值。

例如，假设您是一名系统管理员，负责监控服务器性能。通过监控各种指标(如 CPU 使用率、内存使用率和网络流量)，您可以快速确定服务器何时开始出现问题。

时间序列数据也可用于预测目的。例如，如果您注意到 CPU 使用率在一天中的特定时间达到峰值，您可以使用该信息来规划未来的容量需求。

当然，时间序列数据不仅仅局限于服务器性能。它可以用于任何需要跟踪时间变化的应用程序。这包括从天气和金融数据到社交媒体和网站分析的一切。

### 让我们具体点

以下是你应该了解的时间序列数据:它通常用于寻求对运营的洞察，基于实时分析创建警报以及预测未来趋势。

时间序列数据应用程序具有以下特征:

1.  **高读写比:** Twitter 和 LinkedIn 是有数百万人阅读的单篇文章的互联网应用程序，但原始时间序列数据主要是由应用程序和算法扫描和评估的。
2.  **保留政策:**一般来说，时间序列数据不会永久保留。组织有一个保留策略，指定何时以及如何销毁其数据。
3.  **实时分析和计算:**必须实时计算时间序列数据，以根据获得的信息或综合发现识别异常活动和声音警报。
4.  **查询范围:**时间序列数据一般是在一段时间或一组数据源上被请求，使用过滤器来防止所有历史信息被请求。此外，具有过滤条件的所有或部分数据源总是被聚集。
5.  **趋势:**单个数据点在时间序列数据中通常不显著。重点是数据如何演变，比如前一小时或前一天的波动。

例如，像 [TDengine](https://tdengine.com/) 或 [InfluxDB](https://www.influxdata.com/) 这样的流行时间序列解决方案，通过利用这些品质，创建了比一般数据库更高效的时间序列数据处理和更好的性能。

## 时间序列数据库需要专门的数据库吗？

我们生活在一个现代世界，数据以前所未有的速度不断产生。为了满足需求，企业需要能够快速高效地存储和处理大量数据。这就是专门的时间序列数据库的用武之地。

一切都是在线的，包括仪表、汽车、电梯、装配线甚至自行车。这些项目正在发出永无止境的数字和事件流，物联网和云已经释放了时间序列数据生成的爆炸。

考虑到这一点，创建几个专门的[时间序列数据库](https://devops.com/?s=time-series+database)来处理这种类型的数据流入就不足为奇了。

时间序列数据集非常庞大，给一般的数据库管理系统带来了很大的问题，比如关系数据库和 [NoSQL 数据库](https://devops.com/why-nosql-new-database-darling-devops/) 。非专业数据库在处理时序数据的以下元素时会遇到问题:

1.  **数据摄取率:**在很多时序数据场景中，每秒钟都会产生数百万个数据点，必须实时摄取。关系数据库不是为处理这种数量的数据而构建的，虽然 NoSQL 数据库可以扩展来处理这种数据，但所需的资源量很快就会变得令人望而却步。
2.  **查询延迟:**通常情况下，时间序列系统必须扫描大量数据点才能获得聚合结果，这可能会导致性能下降。例如，一个基本的数据库需要几天时间来计算所有 Amazon.com 点击的平均响应时间，到那时，总的结论可能是不正确的。
3.  **存储成本:**联网设备和应用程序产生的数据是全天候不间断的，一天产生的数据多达 1tb。因为关系数据库和 NoSQL 数据库不能有效地压缩这些数据，存储成本会迅速飙升。

这些问题通常与处理大数据集的效率有关，尽管在某些地方，普通数据库甚至经常不能满足时序应用的基本需求:

1.  **数据生命周期管理:**随着时间序列数据老化，通常会批量删除，而不是一次删除一个数据点。
2.  **Roll-up:** 在大多数情况下，时间序列数据在存储到新表之前，会在一个设定的时间段内进行收集和汇总。原始数据和汇总数据可以有不同的生命周期和保留策略。
3.  **特殊分析功能:**时间序列应用需要比一般数据库更专业的功能，如时间加权平均、移动平均、累积和、变化率、特定状态的经过时间以及两个连续数据点之间的差值。
4.  **插值:**当应用程序或算法需要时，数据库管理系统必须能够根据相邻数据点和规则对数据进行插值，以调整数据集。
5.  **连续查询:**因此，如果你听到一个用户或客户说他们想知道他们的数据什么时候更新，那么有理由假设他们想要这个功能。
6.  **会话和状态窗口:**聚合和分析过程可以在会话或状态窗口上执行，而不仅仅是时间-例如，考虑一个仅在机器打开时计算平均功耗的窗口。

对于通用数据库，开发人员必须编写自定义代码来实现特定于其数据集的功能。不同的数据工作负载需要不同的数据库解决方案；一种尺寸不适合所有人。对于时间序列数据，无论数据集的大小如何，专门构建的时间序列数据库都是最好的工具。

## 为什么时间序列数据库变得流行？

两年前，时间序列数据库是业务中最受欢迎的数据库类型，因为它的用例数量不断增加。如果您正在执行复杂的交易，如广告、电子商务、供应链管理等，它尤其有用。

然而，由于物联网的快速扩张，它们变得更加流行。随着越来越多的设备接入互联网并将数据(当然是时间序列)发送到云端，许多行业都对专门构建的时间序列数据库感兴趣。

时间序列数据被证明是一个重要的工具，不仅用于决策和优化，也用于工业应用。最后，IT 基础设施一直在快速增长，从服务器、容器、网络设备、应用程序到微服务的一切都受到监控，从而产生了大量的时间序列数据。

另一方面，较旧的时间序列数据库通常是封闭的系统，采用陈旧的结构，无法扩展以处理不断增长的数据量。100 万个时间序列数据点过去似乎很多，但现在数百万甚至数十亿个数据点已经司空见惯。

最后，将旧的(以前的)时间序列解决方案与人工智能和机器学习平台等流行的数据分析工具相集成是很困难的，如果不是不可能的话。如果不做大量的工作，这些遗留系统就无法转移到云中，并且它们的许可条款不再适合当前的应用程序。

## 最后的想法

不断扩大的市场和以前时间序列数据库的限制正在为新一代数据库腾出空间。这些新的时间序列数据库是从头开始构建的，以利用云、大数据和 AI/ML 技术。

如果您的业务或应用程序处理时间序列数据，您需要一个专门构建的时间序列数据库。使用这种数据库的优势太大了，不容忽视，而使用旧的、功能较弱的数据库的劣势也越来越明显。