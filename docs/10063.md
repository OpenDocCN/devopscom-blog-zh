# 2022 年最佳:将事件驱动架构与微服务结合使用

> 原文：<https://devops.com/using-event-driven-architecture-with-microservices/>

随着 2022 年的临近，我们 DevOps.com 想要突出今年最受欢迎的文章。以下是我们 2022 年最佳系列的最新内容。

微服务架构正在兴起，已经形成了当前几个转型项目的关键部分，将传统的单片应用程序分解为独立部署的自包含服务，这些服务使用领域驱动的设计进行识别。

来自最近 [研究](https://www.oreilly.com/radar/microservices-adoption-in-2020/) 的统计数据发现，超过 60%的受访者已经使用微服务一年或更长时间。特别是，金融和银行在使用微服务方面处于领先地位，但许多其他行业也在效仿，包括零售/电子商务和电信。

微服务不仅具有增强可扩展性、灵活性和耐用性的潜力，而且部署和维护组件所需的时间也显著减少。并非所有微服务架构都是如此。主要障碍来自生态系统整合挑战和薄弱的分配过程。

### 打破分布式计算的神话

微服务的实现比人们最初想象的要复杂，许多 DevOps 团队陷入了对分布式计算做出错误假设的陷阱，这一事实加剧了这种复杂性。

1994 年，Sun 微系统公司 的 L. Peter Deutsch 等人首次提出了分布式计算谬误 [的清单，至今仍然适用。有一些关键的谬误对微服务的实现特别重要:可靠、同质、安全的网络，零延迟和零传输成本。](https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing)

每个微服务做得越小，服务数量就越多，分布式计算的谬误对稳定性和用户体验/系统性能的影响就越大。这使得建立一个能够在处理网络和服务中断的同时最大限度地减少延迟的体系结构和实施变得至关重要。

### 揭开新的，更新旧的

微服务需要连接和数据来履行其职责并提供商业价值，然而，数据采集/通信在很大程度上被忽视，工具严重落后。我们可以从只支持同步、请求/回复交换模式的 API 管理或网关产品中看到这一点。这只会加剧分布式计算的挑战——他们没有能力与遗留系统集成或从遗留系统获取数据。

与此同时，事件/消息工具也停留在过时、不灵活的世界中，与开发运维、自助服务等微服务的许多指导原则不兼容。

### 解决整合的逻辑迷宫

随着服务变得越来越小，它们的目的越来越单一，可重用性的潜力增加了，但是这取决于服务协作的能力。为绿地系统获取数据很容易，但微服务几乎总是数字化转型、现代化或以更快速度构建新功能的需求的副作用。

### **断开** 

大多数现有系统位于内部，而微服务位于私有云和公共云中，因此数据在通常不稳定且不可预测的广域网(wan)中传输的能力非常棘手且耗时。

到处都有不匹配:对遗留系统的更新很慢，但微服务需要快速和敏捷。遗留系统使用旧的通信媒介，但是微服务使用现代的开放协议和 API。传统系统几乎总是内部部署，最多使用虚拟化，但微服务依赖于云和 IaaS 抽象。

情况变得很清楚，组织需要一个事件驱动的架构来链接所有这些遗留系统，防止微服务不匹配。

### **打造完美微服务和谐**

服务越小，它为最终用户提供的价值就越少——价值来自编排。历史上，编排是由一个中心组件处理的，比如 BPEL 引擎或 ESB，或者现在的 API 网关。

配器是一个很好的描述——作曲家创作包含乐谱的乐谱，这些乐谱将由音乐家用不同的乐器演奏。每个乐谱和它的音乐人就像一个微服务。在一首复杂的交响乐中，有 100 名音乐家演奏各种各样的乐器——就像任何具有复杂应用程序的企业一样——需要更多的编排。

### 微服排练的很好

因此，[微服务](https://devops.com/?s=microservices)编排的一个例子是微服务在代码中执行一系列步骤。微服务的输入或输出是具有领域重要性的数据事件。但关键是，由于微服务仅仅产生一个事件，它不知道是否或何时会被处理。其他服务必须注册它们对事件或事件集的兴趣，并相应地做出反应。这都需要微服务编排。

### 是时候转移焦点了

事件驱动最大限度地提高了灵活性，因为它将数据从“静止”状态解放到“运动”状态，可以实时使用。选择正确的事件或消息平台是实现微服务巨大优势的最关键步骤之一。

微服务本身是不够的。Gartner 早在 2018 年 就已经确定了这种需求，当时它强调“事件驱动”是其顶级战略技术趋势之一，并引用“数字业务是事件驱动的，因此组织需要投资以事件为中心的设计实践和技术，以利用数字业务时刻。”

### 事件驱动的微服务的全部潜力

将事件驱动架构与微服务相结合可以带来巨大的好处。开发人员可以构建高度可伸缩、可访问、健壮和通用的系统，这些系统可以实时消化和聚合异常大量的事件和信息。

现代活动平台不仅应该能够部署在每个云和平台即服务中，还应该支持 DevOps 自动化。在这样一个不断变化的世界中，开发人员需要无缝的自助服务体验——只有通过事件驱动的微服务才有可能实现。