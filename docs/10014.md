# 迁移到 AWS 云:注意事项

> 原文:[https://devops.com/migration-to-aws-cloud-dos-and-donts/](https://devops.com/migration-to-aws-cloud-dos-and-donts/)

如果有一天，你被告知要迁移到 AWS/GCP/Azure/任何其他云提供商，会怎么样？它可能会引入一些压力，以轻描淡写的情况下，对不对？

在我的职业生涯中，我见过不少迁移，在本文中，我想分享一些想法，以帮助 DevOps 工程师、架构师、经理或其他任何可能参与此类迁移的人。我把重点放在向 AWS 的迁移上，主要是因为我在这个主题上有专长，而且因为它相当普遍，但是我认为这些经验适用于任何其他云提供商。在这种情况下，我将讨论从内部到云的迁移，因为这些类型的迁移比云到云的迁移要困难得多(在我看来)。我还将分享我自己对迁移的注意事项的看法。但是请通过批判性思维过滤它们，记住每个人都有自己的背景和经历。对一个人好的可能对另一个人不好。

### 什么是云迁移？

让我们从定义什么是迁移开始。怎么知道是不是迁移？我喜欢下面的定义:

*云迁移是将数据中心的* *能力* *移动到 IaaS 提供商的过程。*

“能力”是关键词。企业不会迁移服务器/虚拟机/硬件/数据或其他任何东西。企业迁移其功能。

有七种迁移策略(或七个 r):重新定位、重新托管(提升和转移)、重新搭建平台、重新购买、重新架构/重构、保留和淘汰。

例如，我曾见过这样的情况，一家公司正在开发一种新产品来替代现有的内部托管产品。该产品从一开始就被设计为架构良好的云原生产品，并将被托管在云中。是迁移还是新建项目类型？从上面的定义，我们可以说这是一个迁移。这是一个迁移的重新架构策略。

如果我们购买新的 SaaS 订阅，而不是我们在内部托管的一些软件，会怎么样？这也是一种迁移:一种回购策略。

让我们更深入地了解这七种迁移策略:

**搬迁。**我们在内部托管一些工作负载，并将其按原样迁移到云中。这在有限的情况下是可能的；当我们迁移与云无关的工作负载时，或者当平台可能是云原生的时。示例:将 Kubernetes 集群从内部重新部署到云，或者使用 VMware 云重新部署 VMware 机器。

**主机更换。**这也被称为提升和移位。我们将内部的虚拟机/服务器转换为云中的虚拟机。示例:使用 cloud bearing 将本地虚拟机迁移到 EC2 实例，或者创建 EC2 实例，安装软件并应用与本地相同的配置。

**重新搭建平台。**我们将工作负载迁移到云原生平台，无需重新架构系统。示例:将 PostgreSQL 迁移到 AWS RDS 或将 Docker 容器迁移到 ECS。

**回购**。我们用 SaaS 取代了一些定制/遗留系统。示例:用 SendGrid 替换自定义内部电子邮件系统，或用 Salesforce 替换 CRM。

**重组**。我们将您的应用架构改为云原生架构，并使用托管云服务。这也包括从头开始重建。示例:更改应用程序的代码，将文件上传到 S3，而不是本地存储，或将应用程序容器化并迁移到 ECS。

**退休**。如果不需要的话，我们决定删除一部分工作量。示例:不再需要日志服务器，因为迁移的应用程序使用 CloudWatch。

**保留**。我们把它留在店内。通常，这是暂时的。示例:由于巨大的成本，具有大量功能和定制的大型 Oracle 数据库没有迁移到 AWS。在现代化阶段被另一种解决方案取代之前，It 部门决定将其保留在内部。

我喜欢下图，它展示了每种迁移类型的高级阶段。这可能是一个有助于实现迁移的备忘单。

![](../Images/b3ae1b8449323ed55a78ef754c2d3467.png)T2】

*图片来源:*[*https://AWS . Amazon . com/blogs/enterprise-strategy/new-possions-seven-strategies-to-accelerate-your-application-migration-to-AWS/*](https://aws.amazon.com/blogs/enterprise-strategy/new-possibilities-seven-strategies-to-accelerate-your-application-migration-to-aws/)

## 迁移不要

在执行迁移时，我不建议执行以下操作:

迁移得太快。企业可能会想，“我们必须快速迁移到云。让我们现在就做托举和移位！”最好不要马上开始。你确定主机更换策略真的比其他策略更快吗？在一个例子中，我们尝试迁移本地虚拟机，但没有成功，因为机器上的操作系统非常旧。一些操作系统级的依赖在 AWS 的硬件上不起作用。这需要大量的配置工作、定制代码和测试，而最初的估计完全错误。它最终被证明是一个平台。T3】

评估你所拥有的，分析它，分析商业案例并思考。在这项工程工作中，我们应该在行动之前停下来想一想。

**没有明确目标的迁移**。你为什么要迁移？如果你不能回答这个问题，你可能需要找到一个答案或者根本不迁移。我见过企业希望迁移到云以降低成本的情况。他们在没有进行总成本分析的情况下执行了提升和转移迁移。事后，他们才意识到这比在托管中心花费更多。该迁移可能被认为是不成功的。

为了避免这种情况，定义明确的目标，并定义实现这些目标的目标状态。如果成本是驱动因素，进行适当的计算并相应地计划。当你计划你的目标状态时，成本优化将是主要关注的事情。如果可用性是原因，那么衡量它，定义 SLO 并关注目标状态下的可用性。

**黑盒迁移**。不要将您迁移的工作负载视为黑盒。了解您具体要迁移什么、它有什么技术要求、它有什么依赖关系以及它是如何工作的几乎是至关重要的。这些信息将帮助您选择正确的工作负载迁移策略。如果不这样做，很有可能你会选择错误的道路，结果会丢失。规划时，获取系统信息是最重要的任务。

**不要忘记架构良好的**。迁移是有压力的。这就是为什么人们倾向于在尽可能短的时间内快速完成它，专注于唯一的事情:让一切尽快在云中工作。他们搁置了架构良好的框架支柱。这是一个错误；它可能会导致一系列不同严重程度的负面后果。不要忽视架构良好的框架支柱，否则在潜在的问题或风险实现之前，您不会知道它们。

对所有事情使用一种策略。为所有工作负载制定一个总体规划总是很容易的。例如，决定进行提升和转移，然后将所有内容转移到云中。但是如果有些东西可以退役呢？如果一些组件不费吹灰之力就能重新组装，那会怎么样？通过分析工作负载的所有组件并为每个组件确定独特的策略，您将节省大量资源。收集数据，合理规划。

## 云迁移任务

务必执行云就绪性评估。如果一个人迁移到一个新的地点，他们应该考虑:

*   气候将会不同
*   那个地方说的语言可能不同
*   生活费用会不同，也许会更贵

当一家公司迁移到云时，他们应该问的问题包括:

*   我们考虑到所有的风险了吗？
*   要让工作负载真正工作，必须进行哪些更改？
*   我们有完成所有工作所需的人力资源吗？
*   我有完成所有事情的预算吗？

云就绪性评估是一个关于公司中各种流程的长形式访谈，旨在确定公司是否准备好生活在云环境中。它基于云采用框架(CAF ),使我们能够了解应该做出哪些改变，以便成功进行迁移。AWS 有一个涵盖所有这些内容的云就绪性评估工具。我强烈建议您对所有考虑迁移的工作负载使用此流程。

**创建商业案例。**描述业务案例。迁移的驱动因素是什么？迁移解决了哪些问题？迁移应该达到什么目标？具体一点:如果你打算降低成本，那么计算一下总数。如果您打算提高可用性，那么定义一个清晰的 SLO。这将是您迁移的首要驱动力。其他所有工件都应该基于它。

**自动化发现和数据收集。**使用自动化数据收集和分析来创建用于迁移的投资组合。不要将你的分析建立在手动创建的电子表格或口头交流的基础上。让机器收集关于库存和使用统计的数据。你收集的数据越精确越好。在大多数情况下，AWS 迁移评估服务将帮助您做到这一点。

**投资组合管理。**创建要迁移的工作负载组合，分析它们，为每个工作负载选择迁移策略，为试点/第一波迁移选择一些工作负载，估计时间表并准备计划。之后执行迁移。重复直到迁移文件夹为空。分享数据。让主题专家审查它。

**发现 CCoE。**这是上面提到的 CAF 的一部分。在执行迁移之前，创建一个团队，负责创建一个策略并定义一个良好的云中生活标准:一个卓越的云中心。它应该包括具有各种主题专业知识的人员，包括管理、运营、平台、人员、财务以及在云中消费或提供服务的每个其他部门。这些人会为迁移准备一个着陆区，对着陆区采取硬政策和软政策；让公司为云生活做好准备。不要害怕重新审视任何政策。  随着新因素的出现而做出改变。

架构良好的框架评审(WAFR)。在迁移浪潮期间和之后进行架构良好的框架评审(WAFRs)。这将使你避免愚蠢的错误，并从技术角度对你所做的事情有一个高层次的了解。

现代化计划。准备一份现代化计划和迁移计划。移民并不是故事的结尾。为了在云中有效，您必须进行架构良好的审查和现代化。第一次现代化很可能是巨大的；这就是提前计划和安排预算和资源非常重要的原因。做不到这一点将导致运营成本增加，而不是降低成本。

## 摘要

如果我们想降低与迁移相关的风险，并减少迁移的压力，我们就不要急于求成。你可能认为匆忙会节省你的时间，其他问题会在以后处理，但经验告诉我们这是错误的。最有可能的结果是，当您切换到新的基于云的生产环境时，您将最终解决在最紧张的情况下遇到的所有问题。不是以一种深思熟虑的方式提前解决问题，而是在胁迫下做出选择。这里必须应用适当的工程原理。拿起一座桥，把它从一条河移动到另一条河，从来没有成功过。迁移成功的关键是测量、分析、设计和规划。将工作负载迁移到云很难，但我希望这些注意事项会让迁移变得更容易。