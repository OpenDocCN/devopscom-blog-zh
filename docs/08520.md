# 这几毫秒值得吗？

> 原文:[https://devops.com/milliseconds-worth/](https://devops.com/milliseconds-worth/)

证明一个人的编码能力的压力可以让开发人员用他们的源代码做一些非常聪明和有创造性的事情。有时这只是一种独特的方法，但是偶尔这种聪明也会将一些性能指标缩短几毫秒。到头来不值得。虽然这似乎是我们希望从同行那里获得的创新类型，但我得出的结论是，这种创新往往弊大于利。几周前在我的 twitter 上看到的一句话很好地总结了这一点:“那么如果你在编写它的时候尽可能地聪明，你将如何调试它呢？”这颗智慧之珠来自一本名为《[编程风格要素》](https://www.amazon.com/The-Elements-Programming-Style-Edition/dp/0070342075)的书。这是一本 1978 年的编程书籍，至今仍然完全适用。如果你不准备相信我的话，你可以看看维基百科上的一篇[文章](https://en.wikipedia.org/wiki/The_Elements_of_Programming_Style)。

我知道我以一种独特的方式编写了一些东西，当时我非常肯定我很聪明，但后来回过头来却完全不知道我为什么要这样写代码。如果我添加评论，我可能会再次找到我的位置，但有时这需要一段时间。当另一个开发人员想到这些好主意时，该怎么办？任何数量的冥想或沉思能让他们理解我写的时候在做什么吗？一个新的或初级的开发人员在能够和我一起工作之前应该有一些灵魂出窍的经历吗？当然不是。我讨厌自己这样，更不要说碰到别人的灵光一现。我当然会尽我所能让其他开发者不要经历这种精神错乱。

虽然这个练习可以成为一个有趣的室内游戏，并有助于扩展我们的编程语言知识，但它带来的问题比它在团队环境中解决的问题还要多。一个更明智的开发人员坚持使用一种可靠的方法。他们已经经历了足够长的时间，知道代码需要对将来可能使用它的任何 garden variety 开发人员有意义(实际上可能是最初编写它的开发人员)。

我第一次学到这一课是在几年前辅导数学的时候。我开发了一个生成单位圆的算法。我辅导的计算机科学专业的学生在数学上使用这种方法在草稿纸上快速生成圆比任意记忆它或理解显示一串三角形不知何故变形为圆的标准证明更容易。

[![Unit Circle](../Images/f7b16485d2610da041e8389ee9a75e28.png)](https://devops.com/wp-content/uploads/2014/04/unitCircle.gif)

Radian Values of the Unit Circle

该算法需要一定量的种子数据。要知道一个完整的圆周长是 2π弧度。这使得其他四分之一圆测量分别位于π/2、π、3π/4。只需要对分数有简单的理解就能看出这一点。接下来我们需要填充第一个象限，它只有三个值，π/6、π/4 和π/3。从这里开始，该算法帮助我们推断圆的剩余弧度值。

**第一象限:** π/6，π/4，π/3(初始种子值，你要记住这些)

**第二象限:**π–第一象限推论值(例如，3π/3–π/3 = 2π/3，我们的第二象限值)

**第三象限:** π +第一象限推论值(如 3π/3 + π/3 = 4π/3，我们的第三象限值)

**第四象限:**2π–第一象限推论值(例如，6π/3–π/3 = 5π/3，我们的第四象限值)

因此，象限二至象限四的公式可以采用(n–s)、(n + s)和(2n -s)的形式，其中 n = π，而“s”是第一象限的三个种子值之一。三个简单的方程式，任何一个计算机专业的学生都应该可以轻松使用。在这个证明上还有一些其他的注释，以使坐标、符号和度数测量正确。然而，这不是一篇关于数学的文章，所以我将把它作为一个练习留给更倾向于数学的人自己去完成。

其他数学家并不像计算机专业学生和学生运动员那样对此印象深刻。观察那些积极轻视数学的学生努力记忆单位圆以完成他们的核心部分是擅长数字的乐趣的一部分。有人(某个怪人)暗示说，我自己可能是个数学迷，是个装腔作势的人，不比他辅导的那些傻瓜聪明多少。冒名顶替综合症出现了，我觉得我别无选择，只能证明我的数学能力。

首先，我变得强大，并谴责我与克莱恩四组所做的事情。巨魔们很快指出，这和我的第一个模型一样，根本不是一个圆，而是一个平面上的一堆点。接下来，我用一个[旋转矩阵](http://mathworld.wolfram.com/RotationMatrix.html)做了一个版本。这实际上产生了一个完整的圆，上面有你喜欢的任何值。巨魔对我没有更多的讽刺，但他们也没有对我所做的工作给予任何赞美或鼓励。

至于我所帮助的学生，他们都不太理解我所遇到的问题。他们认为那些巨魔只不过是巨魔。那些对他们的挣扎嗤之以鼻，甚至拒绝帮助他们的同龄人。我最终发现，我的学生们担心我陷入了这个泥潭。我做的研究超出了他们的理解范围，他们还在使用我开发的第一个模型。它做了他们需要它做的事情。我被告知，我应该把不断上升的分数作为我的工作有价值的证据，并继续更有效地利用我的时间和精力。

直到那时，我才注意到巨魔说得有道理。Klien 四群模型和我最初的算法根本不是圆，只是附有值的点。数学家对此会有异议，而开发人员不会，因为面向对象的开发人员应该对抽象有根深蒂固的理解。一个叫做树的类很少类似于我们所知道的树。最终重要的是用例。对造纸公司来说，一棵树只需要用他们期望它产出的纸浆量来表示。对一个苹果种植者来说，这可能归结为这棵树结出的苹果数量，也许是它在果园中的位置。我们认为一棵树是什么，它的大小，它的叶子的形状，它的气味，当风抓住它时它发出的声音，这些细节都超出了我们将编写的大多数软件的范围。

这对大多数新的 OOP 开发者来说是一个巨大的障碍，尤其是那些擅长数学的开发者。我用来教计算机系学生如何做三角学的对象模型最终成为了教数学家如何进行面向对象编程的完美工具。旋转矩阵版本很重要，因为有时需要非标准值。当标准值不适用时，展示方法调用如何使用标准值或扩展到另一个模型(如旋转矩阵)是很有用的。

数学家们很欣赏 Klien 四群模型，当我有机会的时候，我很乐意展示它。更重要的是，它提醒人们不要对他们放入软件中的数学过于着迷。数学是美丽的，而不是聪明的，我写的代码也有同样的感觉。像大多数艺术作品一样，它源于爱好，如果不实用，就应该被排除在任何应用场景之外。如果我们可以用一些简单的，容易理解的，容易使用的，甚至是普通的东西得到同样的结果，那么这就是我们每次都应该使用的东西，因为它很容易维护。智慧只不过是随着时间的推移而应用的知识。一次又一次，我得出的结论是可维护性胜过性能。我们应该迅速牺牲任何最小的性能增益，使我们的代码难以理解。如果一个主要的性能提升是触手可及的，那么我们最好抽象出任何用来获得它的奇怪代码。我还建议你也对《生活日之光》进行评论，因为有一天你可能需要记住它是如何工作的。