# 日志分析，或日志囤积

> 原文:[https://devops.com/log-analysis-log-hoarding/](https://devops.com/log-analysis-log-hoarding/)

让我们回顾一下 web 应用程序时代的开端:当客户遇到问题时，它打电话给支持团队抱怨服务失败或错误，客户支持团队会写一份事件报告并将其转发给运营团队，然后运营团队会检查该报告，主要是通过查看日志以及他们从客户那里获得的任何有用信息。

**你需要日志** **分析**

当今天的平均日志每天积累 864，000 个条目(600 个条目/分钟)，并且一个拥有 15 个设备的网络每天生成 1，300 万个事件时，您能想象最终用户会报告问题吗？筛选所有这些文件需要多少人和多少时间？

关于这种大量数据的两种极端立场是:“谁需要它？我们腾点空间吧！”以及“我想一直保留所有数据，因为拥有更多数据意味着更好的决策，而且谁知道我什么时候会需要它！”(数字囤积)。

也许正确的方法是折中的:仔细考虑哪些数据可能有用(PCI-DSS、HIPAA、SOX、GLBA、FISMA 合规性审计需要这些数据)，只关注这些数据，但是对于现在拥有所有这些数据的 80%的大公司来说，这没有太大帮助，因为即使在所有这些“清理”之后，数据量仍然非常高。

Splunk 等工具提供了帮助，不仅可以从任何网络流量、Web 服务器、定制应用程序、应用服务器、GPS 系统、股票市场信息、社交媒体中搜索数据，还可以从预先存在的结构化数据库、日志、配置文件、消息、警报、脚本和指标中搜索数据。

Splunk 为 DevOps 的团队成员提供了所有机器数据的集中视图，实现了威胁预防和检测以及情报收集，同时它还捕获了 web 交互和关键指标，如在页面上花费的时间、跳出率、导航路径和产品性能。

但是，即使 Splunk 本质上已经成为机器数据世界中的一个动词，并且可以说是功能最丰富的日志记录解决方案，它也有它的警告:除了它的价格对小公司来说令人望而却步之外，它还有一个陡峭的学习曲线，并且它不是非常用户友好。设置 Splunk 是一个漫长而乏味的过程，当数据第一次导入时，Splunk 不太可能正确地对其进行索引，因此您需要一个团队来完成一个耗时的过程，根据需要格式化粗略的数据，并准备好平台以准确读取每个字段。

要解决复杂的实际技术问题，您不仅需要对整个系统有非常好的理解，对要查询的内容有良好的直觉，还需要了解一种叫做 Splunk 的搜索处理语言(SPL)的语言，这种语言非常强大，但很复杂。

DevOps 团队花在寻找问题(性能、bug、安全问题等)上的每一分钟。)现在是客户受到影响的时候了，所以在过去几年里，成为领跑者的要求已经发生了变化。在意外事件发生后几小时甚至几分钟内做出反应是不可接受的。你不能再只是被动反应，你需要主动预防问题。实时消息将对指示异常系统行为模式的活动或关键指标发出警报，并允许您在问题发生之前进行预测并采取措施。

让我们将 Splunk 方法与市场上的“更现代”的例子进行对比。

现代日志分析平台，如基于云的日志管理和实时分析服务 [Logentries](https://logentries.com/) ，正在通过基于历史活动创建性能的未来图景来实现这一点。如果性能或特征不符合此模型，管理员将立即收到警报。

通过其可视化平台 Logentries，它可以实时聚合数据，并在需要时异步推送信息，而不是基于基于时间的常规快照。这些数据不仅包括应该发生的事件，还包括错过的事件(使用不活动警报功能):未被处理的信用卡或网站流量意外停止。所有这些都不需要花费一大笔钱或者雇佣一大批专家。

Logentries 提供简单、直观和灵活的搜索，使用关键字、正则表达式和字段模式获取事件。来自基础设施的实时信息补充了日志:CPU、内存和磁盘 I/O 信息。将 Logentries 与 [HipChat](www.hipchat.com) 、[page duty](pagerduty.com)和 [Campfire](www.campfire.com) 结合使用，它可以在运营的每个阶段提供可操作的见解，从开发到部署，再到持续的管理和支持。

现代日志系统是为 Devops 方法设计的，其中协作至关重要:

*   团队注释功能允许放置带有注释、建议、解决方案和相关系统上下文的注释，当以后发现类似问题时，其他 Devops 工程师可以看到这些注释
*   可共享的仪表板通过在开发运维团队和整个组织中发布日志和带时间戳的数据和趋势来集中监控
*   通知模块使用自定义标记和实时警报向个人、小组或整个团队发送警告，以避免应用程序崩溃、内存不足、请求超时等导致的问题。在它们变得致命之前。

通过添加来自防火墙、路由器、漏洞扫描器、入侵检测系统/入侵防御系统(IDS/IPS)的日志，现代日志分析可以实时监控、探索和诊断系统安全事件，并跟踪针对网络的恶意企图。

这些服务可以使用 API 连接到任何平台。他们还已经与流行的云提供商(如 AWS)进行了广泛的集成，并拥有针对操作系统平台的代理和挂钩。

日志记录还可以进一步改进，不仅仅是理解海量数据和提供实时信息。有趣的新特性一直都在出现，让我们举一个例子，这是我在研究本文时注意到的一个特性:将完整的信息直接从生产机器日志传递到开发工具。因为在生产环境中，日志的详细程度通常会受到性能约束的限制，所以一家名为 [Takipi](https://www.takipi.com/) 的私人公司提出了一个想法，即从日志文件错误直接进入记录的调试会话，从而在出现错误时看到源代码和变量值。

随着物联网的慢慢出现，并创造了连接一切的无限可能性，需要记录和分析的数据量将继续扩大到[布朗托字节](http://www.businessinsider.com/new-big-data-word-brontobytes-2014-6)和[地质字节](https://www.urbandictionary.com/define.php?term=Geopbyte)，这需要难以预测的新技术。这意味着从这些日志中获取价值的努力至关重要。因此，囤积所有日志并学习复杂查询语言的方法是行不通的。

十年或二十年后，我们回过头来想想本世纪头十年的“传统”日志记录软件，会笑着说，当时最大的数据中心(犹他州数据中心)只能存储 12 艾字节的数据。