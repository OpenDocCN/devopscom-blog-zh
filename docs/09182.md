# 安全软件峰会:开放源码软件供应链安全状况

> 原文：<https://devops.com/secure-software-summit-the-state-of-oss-supply-chain-security/>

开源软件供应链正受到攻击。正如最近的 [Log4Shell](https://devops.com/?s=Log4j) 漏洞所证明的，开源软件供应链越来越成为攻击者寻求利用安全薄弱环节的焦点。许多研究报告记录了过去十年中所谓的“[下一代软件供应链攻击](https://www.blackhat.com/sponsor-posts/07032021-preparing-for-the-next-generation-of-software-supply-chain-attacks.html)的显著增加。这些攻击旨在破坏软件供应链中的关键环节，包括源代码、构建系统、CI/CD 工具和代码测试工具等。下一代攻击发生在所有语言、所有类型的软件中，并且频率越来越高。常见的形式包括域名抢注、恶意代码注入和工具篡改(如 CodeCov 事件)。据集装箱安全公司 Anchore 称，2021 年，64%的组织报告他们受到软件供应链攻击的影响。

越来越多的下一代攻击浪潮推动了新法规的出台，这些法规要求采取特定步骤来清点软件应用程序和软件供应链的内容，并使其更加透明。具体来说，美国总统约瑟夫·拜登(Joseph Biden)发布的第 14082 号行政命令规定了一长串安全措施，包括在美国联邦政府运行的每个应用程序中包含软件材料清单(SBOM)。作为该行政命令的结果，美国国家标准与技术研究所(NIST)正在为应用安全创建参考架构和模板。换句话说，软件安全法规可能会影响每一个生产代码或销售基于代码的产品的公司(包括 SaaS 的产品)。

需要说明的是，OSS 软件供应链遇到的一些问题并不仅限于开源软件。最近针对微软 Exchange Server 的供应链攻击和针对网络安全管理软件产品网络管理工具的 SunBurst 攻击都是针对专有代码库的。也就是说，OSS 的生产和维护与专有软件非常不同。这确实会导致一些独特的风险。在这里，我们将涵盖这些风险，以及一些有希望的举措正在进行中，以解决它们。

## 为什么 OSS 供应链是一个诱人的目标？

开放源码软件供应链成为诱人目标有两个主要原因。一个是它的无处不在，一个是它的弱点。说 OSS 无处不在并不为过。根据 Sonatype，98%的代码库包含 OSS。这可能是代表性不足。今天，如果不使用 OSS 组件，你根本无法从头开始构建代码。太耗费人力，太贵了。OSS 的无处不在使得创造、分配和管理它的供应链成为一个明显的目标。与此同时，这种广泛使用转化为公司维护、更新和修补其应用程序中所有 OSS 依赖项的日益增加的负担。

这是一项不可能完成的任务；插入 OSS 代码来解决眼前的问题要比随着时间的推移确保代码得到更新并且不容易受到攻击容易得多。因此，Sonatype 估计 92%的应用程序包含过时或易受攻击的代码。我们已经看到了这种组织无法维护其 OSS 代码的影响，例如针对信用报告公司 Equifax 运行的 Apache Struts 软件的攻击，这种攻击暴露了数亿美国人的敏感个人和财务信息。

在认识到开放源码软件是一个富有成效的攻击渠道后，攻击者更具体地关注供应链，因为它往往是最薄弱的环节。供应链的要素存在于负责组织之间的空隙中，可能没有受到严格监管或保护。持续集成/持续部署(CI/CD)工具、可以轻松访问其他系统的 OSS 库、包管理器和开源开发工具都是供应链的组成部分，它们被广泛使用，但往往是许多兼职维护者的唯一职责，他们将编写和维护代码作为一项无报酬的副业。

## OSS-面临的具体挑战

OSS 的三个主要优势都带来了独特的安全和供应链挑战。具体来说，OSS 是开放、免费和透明的。

### **开放的两面**

莱纳斯·托沃兹说，眼球多了，所有的虫子都变浅了。在某种程度上，这是真的。但是如果同样的眼睛是在寻找漏洞而不是修复呢？并非互联网上的每个人都是好人，许多人试图利用任何拥有 GitHub 帐户的人都可以向关键库贡献代码这一事实。这吸引了很多伟大的贡献者，但也吸引了很多糟糕的演员和不良行为。

这种行为经常被隐藏或延迟。例如，我们经常看到不良行为者要求为由单个维护者运行的项目或库做出贡献，这些项目或库相对受欢迎并被大型应用程序使用。通常，维护人员努力跟上这些项目的需求。一个坏的参与者会主动提供帮助，提交一些好的 PRs 并获得对存储库的提交特权。在这一点上，坏演员会悄悄地插入恶意软件，如密码劫持脚本。

## **免费的小狗。不是免费啤酒。**

免费是个好价钱。没有采购订单。这使得它非常容易使用。免费也是一个很好的分发策略。但是，有时候免费不值得。如果组织依赖某个应用程序，并且该应用程序变得至关重要，他们可能需要快速修补、更好的合规性和官方支持关系。免费的 OSS 没有任何保证，这可能是一个主要的责任。应用程序的维护人员可能会在周末的空闲时间编写代码和应用补丁，因为他们已经有了一份全职工作。事实上，研究表明，支持互联网的重要软件有很大一部分是由志愿者维护的；这就是 OpenSSH 加密库中 Heartbleed 漏洞的原因。

自由代码也可能几年都不会更新。如果漏洞被披露，您可能无法获得合并您编写的修复程序的权限。如果代码被放弃，作者不再检查评论或请求，那么你就被困住了，可能别无选择，只能放弃这个项目。短时间内的硬分叉会导致混乱和自身的问题。这就是一个流行的 Golang 库 JWT Go 所发生的事情，它成为了 Golang 生态系统中的依赖树。JWT 围棋甚至被包括在最受欢迎和最重要的开源项目之一 [Kubernetes](https://containerjournal.com/?s=Kubernetes) 中。当 JWT 围棋的漏洞出现时，所有人都意识到维护者已经放弃了它。同一个 bug 出现了多个不同补丁的分叉版本。混乱随之而来。

要求公司资助志愿维护者是一种常见的说法。这方面有很多项目，包括 GitHub 赞助商、Open Collective 和 Tidelift。这些程序是有帮助的，但还不够。你不能只给人们少量的钱，就能得到更安全的代码和专业级的维护。即使你提供全职薪水，它也可能不会转化成受良好支持的、安全的代码。

## **透明的虚幻利益**

OSS 的透明性是真实的，但是这种代码不断被审计和审查的想法是一种错觉。是的，源代码是分发和开放的。但是绝对的数量使你不可能检查你使用的所有代码。如果你正在使用数百万或数千万行代码，你没有时间或足够的眼球。即使您在代码审查上花费了相当多的资源，仍然很容易遗漏问题和漏洞，对于项目的恶意贡献者来说，隐藏恶意软件或其他不良内含物也相对简单。审查源代码也确实消除了所有风险。当大多数 OSS 代码被消费时，它作为由另一个实体或开发者编译的包运行。

此外，不能保证包的内容来自你审计的相同源代码。实际上，我们经常在像 npm 和 Maven 这样的包存储库中看到这种攻击，其中恶意行为者插入被篡改的构建，或者接管包并插入没有作为包的一部分列出的代码。

CodeCov 事件是最近发生的令人震惊的例子之一。这个检查单元测试代码覆盖率的免费服务使用运行在 CI 服务器内部的 BASH 脚本进行安装。该脚本遭到破坏，攻击者插入了可以窃取代码机密并将其导出的恶意软件。这些秘密可能是用于在 npm 或 Maven 中发布包的令牌，暴露这些秘密允许攻击者随后危害这些包。在另一个例子中，管理 PHP 项目的源代码分发的 PHP 服务器受到危害，并且多次提交将恶意代码注入源代码存储库中。该事件很快被发现，但它展示了攻击者如何绕过代码审查和安全流程，直接篡改源代码。

## 但是并没有失去一切

更好地保护开源及其供应链的创新努力正在获得动力。SBOM 越来越被接受，从 CI/CD 管道自动生成 sbom 或构建系统变得越来越容易。一项名为 Sigstore 的旨在简化代码加密签名的新计划旨在消除代码签名的障碍；无处不在的代码签名将使得通过从根源上解决源代码来源问题来危害供应链变得更加困难。最后，开放源码安全基金会已经从主要技术公司获得了数千万美元的资金，并且正在建立发放赠款的机制，以其他方式为开放源码软件提供更强大的财政支持机制。这些发展预示着一个更加光明的未来，开放源码软件供应链将更加健全，公司可以更加容易地审计、跟踪和信任其应用程序中的所有开放源码软件依赖关系，以及将开放源码软件代码从开发者盒子转移到生产环境的完整供应链。

* * *

***关于安全软件峰会**  安全软件峰会汇聚了全球领先的安全软件开发创新者、从业者和学者，分享和传授安全编码和部署实践的最新方法和突破。如果您正在开发、发布和保护软件，快速交付新功能，并从一开始就构建东西，请单击下面的链接访问本次峰会的所有会议。*

[https://go.shiftleft.io/secure-software-summit-2022-replay](https://go.shiftleft.io/secure-software-summit-2022-replay)