# 2021 年最佳——devo PS 最佳实践的九大支柱

> 原文：<https://devops.com/nine-pillars-of-devops-best-practices/>

随着 2021 年的临近，我们 DevOps.com 想要突出今年最受欢迎的文章。以下是我们 2021 年最佳系列的第十四期。

在之前的博客中，我解释了我的 27 因素 DevOps 评估模型，其中包括 DevOps 的九大支柱和人员、流程和技术三个维度。

九大支柱代表实践的类别。在这篇博客中，我列举了九个支柱中每一个的实践例子。在未来的博客中，我将解释如何使用这些[实践](https://containerjournal.com/?s=practices)来对您的 DevOps 实践进行差距评估。

## **开发团队的领导实践**

领导者展示出对组织方向和团队方向的长期愿景。领导通过鼓励团队提出新问题和质疑关于工作的基本假设，从智力上激励团队。
领导者提供鼓舞人心的沟通，激发成为团队一员的自豪感，对团队做出积极评价，激发激情和动力，鼓励人们看到变化带来的机遇。
领导者通过在行动前考虑他人的个人感受、体贴他人的个人需求和关心个人利益来表示支持。
领导通过表彰团队的出色工作、认可工作质量的提高以及亲自表扬个人的杰出工作来提升个人认可。

## **devo PS 的协作文化实践**

这种文化鼓励跨职能协作和分担责任，避免开发、运营和质量保证之间的孤岛。这种文化鼓励从失败中学习，鼓励部门间的合作。
·在适当的情况下，使用协作工具(例如 Slack、HipChat、Yammer)在端到端跨职能团队中流畅地沟通。
devo PS 系统由一个专家团队创建，并由包括开发、运营和质量保证在内的利益相关方联盟进行审查。
端到端开发运维工作流的变更由一个专家团队领导，并由包括开发、运营和质量保证在内的利益相关方联盟审查。
DevOps 系统变更遵循分阶段流程，以确保变更不会干扰当前的 devo PS 操作。实施阶段的示例包括:测试环境中的概念验证(POC)阶段、有限的生产和在所有实际环境中的部署。
关键绩效指标(KPI)由整个团队设定和监控，以始终验证端到端 DevOps 管道的绩效。KPI 包括部署新变更的时间、交付频率以及变更未能通过开发运维管道中任何阶段测试的次数。

## **面向开发运维的开发运维设计实践**

产品设计支持模块化独立包装、测试和发布。换句话说，产品本身被划分成模块，模块之间的依赖性最小。通过这种方式，可以构建、测试和发布模块，而不需要一次性构建、测试和发布整个产品。
根据 12 因素应用的原则，应用被设计为模块化、不可变的微服务，可随时部署在云基础设施中，而不是单一的可变架构。
·在提交到集成分支之前，使用静态分析工具预先检查软件源代码变更。静态分析工具用于确保修改后的源代码不会引入严重的软件错误，如内存泄漏、未初始化的变量和数组边界问题。
在提交到集成/主干分支之前，使用同行代码评审对软件代码变更进行预先检查。
在提交到集成/主干分支之前，使用动态分析测试预先检查软件代码变更，以确保软件性能没有下降。
软件变更与最新的集成分支版本一起集成到私有环境中，并在将软件变更提交到集成/主干分支之前使用功能测试进行测试。
在检入期间，软件功能用软件开关(即功能标签或切换开关)进行标记，以实现选择性功能级测试、升级和恢复。
在代码变更被检入的同时，自动化测试用例被检入到集成分支，同时还有测试在飞行前测试环境中通过的证据。开发人员定期提交他们的代码变更，至少每天一次。

## **devo PS 的持续集成实践**

软件版本管理(SVM)系统用于管理所有源代码变更。(Git、Perforce、Mercurial 等。)
·软件版本管理(SVM)系统用于管理构建过程中使用的代码映像变更的所有版本。(Git、Perforce、Mercurial 等。)
·软件版本管理(SVM)系统用于管理构建过程中使用的工具和基础设施配置和测试的所有版本。(Git、Perforce、Mercurial 等。)
所有生产软件的变更都维护在代码的单个主干或集成分支中。
支持每个客户版本的软件版本保存在单独的版本分支中，以支持每个版本的软件更新。
每次软件提交都会自动触发模块所有组件的构建过程，该模块的代码因提交而改变。系统被设计成总是有足够的资源来执行构建。
一旦触发，软件构建过程将完全自动化，并产生构建工件，前提是构建时间检查成功。自动化构建过程检查包括单元测试。
·用于构建的资源是按需可用的，并且从不阻塞构建。
·CI 构建速度足够快，不到一小时即可完成增量构建。
·构建过程和构建资源根据变更的复杂性自动扩展和缩减。如果需要完整的构建，CI 系统会自动水平扩展，以确保构建尽快完成。

## **开发运维的持续测试实践**

开发变更在集成到主干分支之前，在生产环境的克隆中进行飞行前测试。(注:“生产环境”是指“产品的客户配置的变化。”测试软件变更所需的新单元和功能回归测试与代码一起创建，并与代码同时集成到主干分支中。然后，新的测试用于测试集成后的代码。测试脚本标准用于指导测试脚本的创建，以确保脚本执行预期的测试目的并且可维护。
根据具体的软件变化自动选择测试。CT 是动态编排的，根据软件变更的复杂程度或风险程度，可以加速或完全跳过部分 CT 测试套件的执行。
测试资源根据所选特定测试的资源需求和测试的可用时间自动调整。
发布回归测试是自动化的。至少 85%的测试是完全自动化的，如果部分测试必须手动执行，其余的是自动辅助的。
释放性能测试是自动进行的，以验证没有不可接受的降级被释放。
蓝/绿测试方法用于在激活试运行环境之前验证试运行环境中的部署。A/B 测试方法与特性切换一起使用，在不同的实际环境中与客户一起尝试不同版本的代码。Canary 测试方法用于在选定的真实环境中测试新的代码版本。整个测试生命周期，可能包括飞行前、集成、回归、性能和发布验收测试，在整个 DevOps 管道中自动协调。每个阶段的测试套件包括一组预定义的测试，可以根据预定义的标准自动选择这些测试。

## **面向开发运维的弹性基础设施实践**

构建和测试构建所需的数据和可执行文件经常自动归档，并且可以根据需要恢复。归档包括所有的发布和集成存储库。如果需要更新一个版本的旧版本，那么可以根据需要检索和恢复用于构建和测试该版本的环境，并且可以在短时间内(例如，几分钟到几小时)完成。构建和测试过程足够灵活，可以自动优雅地处理各种各样的异常。如果某个组件的构建或测试过程无法完成，则该失败组件的过程将被报告并自动安排进行分析，但其他组件的构建和测试过程将继续。如果组件故障的原因可以由系统纠正，则自动分析并重新安排组件故障的原因；如果没有，则报告并暂停。
系统配置管理和系统清单存储并维护在配置管理数据库(CMDB)中。
使用确保等幂的配置管理工具管理和自动化基础设施变更。
自动化工具用于支持不变的基础设施部署。
人人平等。不同团队的构建和测试过程的用户性能体验对于所有用户都是一致的，与位置或其他因素无关。SLA 和监控工具可确保所有用户的用户性能体验保持一致。
提供故障恢复机制。建立并测试系统故障监控、故障检测、系统和数据监控以及恢复机制是否存在。它们是自动化的，并通过模拟故障条件得到一致验证。
经常测试基础设施故障模式。
·灾难恢复程序是自动化的。

## **devo PS 的持续监控实践**

日志记录和主动警报系统使检测和纠正 DevOps 系统故障变得容易。大多数 DevOps 组件故障都有日志和主动系统警报，并以快速识别最高优先级问题的方式进行组织。
·来自每个 DevOps 管道阶段(例如，构建、工件、测试)的每个指标的快照和趋势结果在流程中自动计算，并对开发、QA 和运营团队中的每个人可见。
·devo PS 基础架构组件的关键绩效指标(KPI)会自动收集、计算，并向团队中订阅这些指标的任何人公开。示例指标包括 CI、CT 和 CD 流程计算资源的可用性(正常运行时间)、完成构建的时间、完成测试的时间、失败的提交数量以及由于严重故障而需要恢复的更改数量。
devo PS 基础架构组件的指标和阈值被自动收集、计算，并向团队中订阅它们的任何人公开。示例指标包括 CI、CT 和 CD 流程计算资源的可用性(正常运行时间)、完成构建的时间、完成测试的时间、失败的提交数量以及由于严重故障而需要恢复的更改数量。
·流程分析用于监控和改进集成、测试和发布流程。描述性构建和测试分析推动过程改进。
预测分析用于动态调整 DevOps 管道配置。对于测试结果的分析，数据可能表明需要在故障趋势较高的区域集中更多的测试。

## **开发运维的持续安全实践**

开发人员获得授权并接受培训，以承担个人安全责任。组织接受安全保证自动化和安全监控实践。
所有正在使用的信息安全平台都通过自动化功能的 API 公开全部功能。
devo PS 环境中使用的所有应用软件、脚本、模板和蓝图均采用成熟的版本控制实践和工具。
采用不变的基础设施思维模式，确保生产系统锁定。
安全控制是自动化的，不会影响开发运维的灵活性。
安全工具集成到 CI/CD 渠道中。
构建或测试机器上的关键知识产权的源代码只能由具有经验证的可信用户访问。构建和测试脚本不包含访问任何拥有知识产权的系统的凭据。知识产权是分开的，不是所有的知识产权都存在于同一个档案中，每个档案都有不同的凭据。

## **devo PS 的连续交付实践**

交付和部署阶段是分开的。交付阶段在部署管道之前。所有通过交付标准的可交付成果都被打包，并准备使用容器进行部署。
交付包包括足够的配置和测试数据来验证每个部署。配置管理工具用于管理配置信息。
一旦实现了可接受的交付措施，交付管道中的可交付成果将自动推送到部署管道中。
根据预先确定的指标来决定部署决策。整个部署过程可能需要几个小时，但通常不到一天。
生产环境的部署是分阶段进行的，这样可以及早发现失败的部署，并快速隔离对客户的影响。
部署具有自动恢复和自我修复功能，以防部署失败。

**这意味着什么**

DevOps 是一个强大的工具，可以为使用它的组织带来许多好处。使用 DevOps 高效实现性能取决于以下最佳实践。通过遵循本博客中列举的九个实践支柱，组织可以实现 DevOps 必须提供的性能潜力。