# 大型机:云之前的云

> 原文:[https://devops.com/mainframes-the-cloud-before-the-cloud/](https://devops.com/mainframes-the-cloud-before-the-cloud/)

这里有一些事情需要考虑:尽管 IBM 在 2005 年停止生产个人电脑，转而决定专注于利润更高的商业服务，但该公司仍在生产大型机，并且根据所有估计，在未来很长一段时间内都将继续生产大型机。问题是，为什么？答案是:因为对这类硬件的需求仍然很大。

事实是，在计算和处理事务时，大型机是一个庞然大物。一台大型机每天可以处理 25 亿次交易。这相当于一天内有 100 个网络星期一。为了让你更清楚地了解规模的巨大，请记住，2018 年网络星期一的销售额为 79 亿美元。这相当于一台主机每天能够处理超过 75 万亿美元的交易，几乎是 T2 全年 GDP 的两倍！

![](../Images/b35f9a01bd814db5d4f52dd2d2600958.png)

正如我所说的，大型机是一种重型机器。然而，它的力量和潜力对于大多数在现代云中工作的人来说是隐藏的。这令人惊讶，因为有一个很好的论点，鉴于其强大的功能和可伸缩性，加上对大量并发用户的支持，大型机在云出现之前就是云。然而，这项技术在年轻的开发者中几乎不为人知，主要是由于文化原因和缺乏历史意识。越来越多的人没有利用眼前的巨大机遇，这是一种不幸。说到大型机计算，有很多有趣的技术要学，也有很多钱要赚。这只是一个提高意识的问题。一个好的起点是重新定义叙事。

请允许我详细说明。

## 一个特殊的俱乐部

当大型机出现在商业领域时，很少有人与计算机交互，更少有人作为程序员或系统管理员直接与计算机打交道。就像在现代数据中心一样，这些机器被隔离在很少有人能进入的温控房间里。对实际物理机器的访问仅限于少数人。但与今天不同的是，当时限制访问更多的是出于安全考虑，因为周围有更多的人是潜在的黑帽子，当时的访问也受到限制，因为该职业的排他性。

在 20 世纪 50 年代、60 年代和 70 年代，不是任何人都能编程或成为系统管理员。你可以去一所技术学校学习成为一名电脑操作员，这意味着你可以在一个终端工作，如银行出纳员或旅行社代理人。或者你可以学习成为一名数据处理员，在一家经纪公司的后台工作。但是要学习编程，你必须上大学。大学毕业后，你不得不去一家实际上在日常运作中使用计算机的公司或组织工作。这些公司包括银行、保险公司、通用汽车和通用电气等大型制造商、航空公司、大型零售商和政府。计算机是一个俱乐部，你必须受过良好的教育才能加入，并且受到组织的欢迎才能保持会员资格。是的，确实有例外——盖茨、T2、艾伦、T4、乔伊、沃兹尼亚克、乔布斯，但对大多数人来说，成为程序员的职业道路是上大学，然后进入大企业或政府部门。

因此，计算有一种神秘和神奇的气氛。请记住，直到 20 世纪 80 年代中期，大多数人从未接触过电脑。这是登月和网络电视选举之夜预测的素材。然后个人电脑出现了，改变了一切。不到 10 年，计算机变得很普遍。甚至小学也有——至少那些有预算和远见的学校有。电子表格程序 [Lotus 1-2-3](https://en.wikipedia.org/wiki/Lotus_1-2-3) 等商业应用程序给小企业带来的强大功能，甚至促使大街上的干洗店花数千美元购买一台个人电脑。生产率的提高是值得的。此外，由于干洗店实际上拥有机器，干洗店的孩子可以学习编程的盒子上没有阻碍，当它不在营业时间使用。记住，每台 IBM 兼容的个人电脑上搭载的[微软 DOS](https://en.wikipedia.org/wiki/MS-DOS) 操作系统都捆绑了编程语言 [BASIC](https://en.wikipedia.org/wiki/BASIC) 。你不需要去大学学习编程；你只需要一本书。

于是，电脑编程开始流行。PC 程序员开始建立自己的俱乐部，任何人都可以加入，而不必费力去加入大型机程序员所属的特殊俱乐部。你只要出现就行了。个人电脑编程变成了精英管理。此外，这也成了非常赚钱的工作。出货的个人电脑数量很多，对在这些电脑上运行的应用程序的需求非常大。最不可能的人，如 Lotus 软件创始人米切尔·卡普尔和他的伙伴、感恩而死的作词人 T2 和约翰·佩里·巴洛，由于个人电脑而变得富有。

个人电脑变得越来越酷，为其编程也变得越来越酷。但随着个人电脑的普及，有一个事实变得模糊了:与主机相比，PC 是一个玩具——一个生产玩具，一个解放玩具，但仍然是一个玩具，就像卡丁车与一级方程式赛车相比是一个玩具一样。

就特点而言，大型机吃掉了个人电脑的午餐。1983 年发布的 IBM System/370 Extended Architecture Mainframe 是一台 31 位机器，可以支持高达 8MB 的内存，处理器运行频率为 38 MHz。相比之下， [IBM PC-XT](https://en.wikipedia.org/wiki/IBM_Personal_Computer_XT) 也发布于 1983 年，是一台 8 位机器，配备 128KB 内存和运行速度为 4.77 MHz 的 8088 处理器。

但是，俗话说，“你永远不要低估酷的价值，”而个人电脑非常酷。当主机藏在银行和保险公司地下室的气候控制室里时，它引起了很多关注。然而，大型机功能更强大，尽管 PC 是为了满足单个用户的需求，但大型机可以服务成千上万的用户。

## 从一开始就按规模构建

大型计算机从一开始就被设计成支持数百(如果不是数千)用户。然而，更重要的是，大型机过去和现在都被设计为支持数百万个并发事务。仔细想想，虽然大量用户请求可能会耗尽典型商用机器中的 CPU 利用率，这也是能够通过增加基于云的计算集群中的虚拟机分配来扩大 CPU 数量的原因，但 CPU 的真正负担与其说是请求数量，不如说是每个请求带来的计算负担。例如，一个获取一只猫的. JPG 的请求不会比一个需要转换音频文件的请求带来更多的负担。WAV 格式转 MP3。

减轻请求负担的需求一直存在，因为在一家大银行的各个分支机构工作的银行出纳员必须同时进行存款和取款。大型机工程师几十年前就解决了这个问题。诸如[批处理](https://www.ibm.com/support/knowledgecenter/zosbasics/com.ibm.zos.zmainframe/zconc_batchproc.htm)和[消息队列](https://en.wikipedia.org/wiki/IBM_MQ)之类的技术使计算活动异步，并被优化以有效地充分利用 CPU 容量，这些技术在大型机领域过去和现在都很常见。

IBM 的 360 大型机从 1964 年开始在其 OS/360 系统中支持批处理。批处理允许在预先安排的时间(通常是“非工作时间”)对万亿字节的数据执行数千条指令，所有这些都无需人工干预。

消息队列允许进程以消息的形式获取存储在消息队列中的数据，并根据消息中的数据执行计算活动。以异步方式独立于请求执行处理。当处理完成时，会创建一个新消息并将其发送到另一个队列，在那里另一个进程会做更多的处理或创建一个通知来指示工作已完成。IBM MQSeries 是一种早期的消息队列技术，早在互联网普及之前，于 1993 年在道富银行首次使用。

在大型机中支持用户和事务并发性的原因是由于一项在今天的云环境中很常见的技术，但在大多数数据使用软盘在独立 PC 之间交换的时代，PC 用户对此闻所未闻。这项技术就是虚拟化。

## 虚拟化将大型机计算带到了一个新的高度

如今，我们认为虚拟化——让软件模拟硬件的能力——是理所当然的。没有它，我们就不可能有原生的云提供商，比如亚马逊网络服务、谷歌云和微软 Azure。这些服务依靠虚拟化来提供满足现代计算需求所需的分段和计算隔离。然而，尽管虚拟化在商用云计算世界中至关重要，但在商用 PC 上放置一层虚拟机在计算历史上还是一件相当新的事情。VMWare、VirtualBox 和 KVM 在 2000 年代中期成为主流。另一方面，自 20 世纪 60 年代中期以来，虚拟化一直是大型机技术的一部分。[虚拟内存](https://en.wikipedia.org/wiki/IBM_System/360_Model_67)出现在 1965 年的大型机中。[机器虚拟化](https://en.wikipedia.org/wiki/VM_(operating_system))于 1972 年在 IBM 370 大型机中推出，至今仍是大型机计算体验的重要组成部分。

当在本机大型机操作系统中工作时，登录到大型机的每个人都会获得一个相同的地址空间。您可以将每个地址空间视为一个独立的虚拟主机系统。这些地址空间是即时创建的，不会互相干扰。此外，许多公司为他们的硬件创建逻辑分区，称为 LPARs(逻辑分区)。逻辑分区由一个名为 PR/SM(读作 Prism)的本地固件管理程序控制。

LPARS 提供的价值是环境之间的进一步分离。这意味着您不仅可以分离用户，还可以创建不同的计算环境，例如在虚拟化 X86 机器时创建的环境。例如，您可以拥有一个共享的开发环境以及测试、试运行和生产环境。您可以根据需要为特定环境分配资源和安全访问权限，就像在一个充满商用机器的数据中心一样。这意味着您可以将生产系统配置得更加安全，具有更高的执行优先级和更多的资源，如内存。事实上，根据美国政府的说法，从安全角度来看，在大型机上创建的虚拟机被认为是完全独立的机器。

在本地大型机 z/OS 操作系统下，运行在相同硬件或不同硬件上的 LPARs 可以链接在一起，作为一个 [Sysplex](https://en.wikipedia.org/wiki/IBM_Parallel_Sysplex) ，以实现冗余并轻松提供额外的容量。动态虚拟 IP 寻址(DVIPA)用于在 Sysplex 中的多个 LPARs 之间动态路由 IP 流量。这类似于能够在一个负载平衡器后面将各种 web 服务器连接在一起，或者在一个 Kubernetes 集群中组织它们。能够将计算机连接在一起是使系统可伸缩的一个重要特性。此外，跨地理区域连接计算机可以提高性能。用离你近的机器工作总是比用离你远的机器快。如前所述，能够上下扩展系统是基于云的计算的一个关键特性。动态连接是大型机体系结构的一部分，对于伸缩工作至关重要。

需要理解的重要一点是，就我们赖以让云工作的机器虚拟化而言，我们认为现代的东西已经在大型机上使用了多年。此外，大型机上的虚拟化使程序员和系统管理人员能够使用各种操作系统和编程语言，正如我们在商用云实例中所期望的那样。机器虚拟化让大型机支持 [Linux](https://www.ibm.com/it-infrastructure/z/os/linux) 。无论计算环境是虚拟化的 Linux 还是本机大型机，开发人员都可以用 Java、C/C++、Python、Perl 和各种其他语言编写代码，包括像 Swift 这样的新语言。但是，话说回来，大型机总是旨在支持许多编程语言。

即使回到 60 年代和 70 年代，程序员也可以用 COBOL、PL/I、作业控制语言(JCL)和客户信息控制系统( [CICS](https://en.wikipedia.org/wiki/CICS) )来编写。同样，用汇编语言编写低级代码也一直是可能的。显然，现代开发人员喜欢在云环境中用各种语言编程的多样性已经成为大型机计算的一部分有一段时间了。然而，开发人员从未意识到它的好处。也许是时候改变一下叙述了。

## 改变关于云中大型机计算的叙述

正如我在本文开头所述，IBM 继续生产大型机是因为对该技术的需求不断增长——特别是随着智能手机和物联网设备在全球范围内激增。网飞可能会在数据中心的商用机器上旋转容器，让你观看过去的几集“[橙色是新的黑色](https://www.netflix.com/title/70242311)”但是当使用 iPhone 支付 Lyft 的时候，信用卡交易很可能会在一台主机上处理，这台主机通过某种 [API 网关](https://microservices.io/patterns/apigateway.html)提供服务。

争论大型机应该或者可以与商用服务器互换使用没有什么好处。这就像说一队汽车可以和一辆城市公共汽车互换使用。可以做，但是意义不大。每种技术都有好处，当它们一起使用时，会使整个运输系统更加高效。诀窍是理解这些技术在大环境中的位置和方式。在这种情况下，大局就是云。

围绕大型机技术的旧叙述是基于不再适用的观念。现代大型机并不比容纳区域数据中心的单一建筑更集中。在编程语言方面，大型机在几十年前就超越了 FORTRAN 和 COBOL。当前的大型机虚拟化技术使得运行用任何编程语言编写的程序成为可能。此外，大型机模拟器，如 [ZD & T](https://www.ibm.com/us-en/marketplace/z-systems-development-test-environment) ，可以获得熟悉大型机环境所需的实践经验。

## 过去的观念不再适用

现代大型机是一种强大的资源，为云计算提供了非凡的优势。新的说法是，大型机是现代化的，适应性强，非常适合以闪电般的速度容纳大量的交易。而且，这是一个赚大钱的好方法。

随着当前的工作人员(不可否认正在老化)接近退休，将需要新一代的大型机开发人员来继续工作，使大型机成为现代云中的关键任务资源。除了理解大型机计算的本质，这些开发人员还需要精通推动云计算的现代工具和技术。这是我一直敦促许多有前途的开发人员进行的投资。

## 把所有的放在一起

让我分享一段个人历史:不久前，我需要做一些编程。所以，我走到我的办公桌前，登录我的系统，写了一些代码并运行它。它非常有效！我保存了我的工作，刚好在晚餐前完成。过了一会儿，又到了编程的时候了。我回到我的办公桌，登录系统，编码了。又是一天写代码，对吧？不完全是。

我的第一次编码会议是在 1975 年。“过一会儿”就是今天。四十四年过去了。当时，我在 50 英里外的一台主机上工作。今天，我登录了一个在线编程环境，它也在几英里之外，甚至可能在地球的另一边。云计算就是这样:资源在任何时候都是任何方式的。

有趣的是，尽管时间流逝了很多，我现在的开发者经历和几十年前并没有什么不同。仍然只有我和一个终端。当时，终端是一个满是绿色字符的屏幕。今天，我的终端能够容纳各种媒体和输入设备。但是，在电话线的另一端，谁知道发生了什么？据我所知，我可能还在连接 1975 年使用的同一台主机。这就是我的观点。

我们今天认为的云计算的许多新的和奇妙的东西实际上已经在大型机技术中存在了一段时间。在许多方面，大型机是云之前的云。而且，它仍然是我们所熟知的现代云计算的强大资源。鉴于其强大的功能、多功能性、可扩展性和对现代 DevOps 工具的支持，大型机是当今和未来云计算基础设施的完美资源。这是一种计算资源，当我们在一个日益互联的星球上向前发展时，我们将很好地利用它。

鲍勃·雷瑟曼