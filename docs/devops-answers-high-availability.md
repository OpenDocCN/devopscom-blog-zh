# DevOps 解决了高可用性问题

> 原文：<https://devops.com/devops-answers-high-availability/>

每个人都希望自己的应用程序 SLA 达到 99.99999%。然而，对于某些应用程序，这不是一个愿望，而是强制性的。任务关键型应用程序失败的后果非常严重。随着商业应用程序的破坏，它是声誉和内部支持成本。

问问伦敦希思罗机场的管理部门就知道了，这是欧洲最繁忙的机场，几周前发生了大规模的计算机崩溃。这导致了世界范围内的航班安排混乱，达到了前所未有的程度。原因是交通管理员使用的 Swanwick 工作站无法实现负载平衡。

高可用性只能通过全面的规划和仔细的系统设计来实现。这可能是一项复杂的任务，具有深远的业务影响。

您可以在两个级别上监督高可用性计划:

**系统等级:**

*   **容量规划:**预测不同时间和日期的用户数量和请求并不是一件容易的事情。定期查看流量负载和事件日志有助于创建利用率基线，并据此预测和分析未来趋势。确定基础设施资源，如网络带宽、内存、处理器、群集中的节点数量等。，测量它们的利用率或性能，并与它们的最大可用容量进行比较。这使您可以确定每个设备的可用容量。通过预测利用率趋势报告并将它们与最大可用容量进行比较，您将能够估计给定资源可能在哪个点耗尽其过剩容量。容量规划是一项持续的活动，应该是 DevOps 团队软件交付流程中的常规部分。

*   **冗余规划:**这意味着复制系统组件，以便没有单个组件(电源、服务器、存储、网络等。)失败会导致整个应用程序崩溃。只有一个组件只是自找麻烦，应该不惜一切代价避免 SPOF(单点故障)。在完美的世界中，每个系统组件都有一个冗余组件，以防主组件失效或停止响应…但我们生活在现实世界中。

此外，如果基础架构超出您的控制范围，并且您受云供应商 SLA 的约束，您可以考虑使用多个云服务提供商，投资灵活的 SDN 技术，使您的网络可移植。以便您可以在云之间移动整个多层环境，而无需重新配置。

**故障保护等级**:

预先预测系统问题，即预分析，是一项重要的工作。假设有东西会坏掉，然后逆向工程在哪里，如何坏掉。各种硬件和存储问题都可能导致问题，例如:

1.  集群配置不正确。其中一个节点上的配置文件/存储库与其他节点上的不同吗？
2.  未能监控集群状态，这可能会导致某些组件出现不为人知的降级(例如“嘈杂的”以太网适配器)，
3.  群集资源与物理资源不匹配(例如，Unix 中不存在挂载点，以太网适配器不正确等)。),
4.  网络存储访问问题。并非所有节点都可以访问的关键网络文件系统)，
5.  缺少冗余 SAN I/O 路径、隐藏单点故障(例如同一交换机/vLAN 上的公共或专用链路)等。
6.  软件问题，例如安装的软件版本/补丁不同、许可证过期、配置文件不兼容等。

关注这些常见问题，即您的平台特有的问题，并了解弱点，将有助于您确定每个问题的应对方法。这将节省时间，同时也是一种帮助您在问题发生前发现问题的练习。

使用配置管理工具还可以帮助您标准化环境，并且在发生意外的情况下，允许您按需启动备用基础架构。

借助 DevOps 的交互性，您可以避免可怕的电话通知，告诉您系统由于上述问题之一而关闭。由于伟大的流程与伟大的工具相集成，您应该在性能问题发生之前获得自动警告。

**标准化**

DevOps 一切都是为了自动化，但是你不能自动化你不能标准化的东西。

尽量减少高可用性配置的数量，并致力于标准化和重用相同的设计模式。对所有运行相同软件版本和修补程序级别的所有群集使用相同的存储体系结构。

隐藏的软件变量很难发现，但很容易避免。

选择最适合这项工作的工具，但尽量限制不同基础设施供应商之间的差异。例如，跨不同供应商技术的复制会增加无中断故障转移的挑战。

记录并分发这些标准，以便在您的组织中促进未来系统或当前系统变更的一致性。

**使用(并在使用前测试)自动故障转移**

对于需要零停机环境的组织来说，自动故障转移是最合适的选择，但是仅仅祈祷是不够的，在使用它之前，您需要对它进行测试。

首先你需要一个计划。该计划应该列出您期望处理的所有类型的故障，但是从影响小且逐渐增加的有限测试开始。在模拟设备或链路故障后，开始研究为了让您的应用程序在故障情况下继续运行，还需要哪些服务。

**自动审核**

审核您的高可用性配置是确保成功恢复的最重要因素。这包括使用专用工具，如 ScriptRock，或者一组定制的内部脚本。自动化审计测试可以而且应该每天运行。

成功的审计环境的一些基本规则是:至少自动化重要配置元素(操作系统和软件配置、集群配置、网络配置、存储分配等)的收集。)并定期收集配置数据。否则，当停机发生时，很难执行事后分析。请记住，自动数据收集将减少审计、测试和预测未来停机时间所需的时间和精力。

**创造一个协作的工作环境**

成功的实施需要正确配置网络、存储、服务器等。实践经验表明，仅由一个团队完成的部署通常更容易出错。必须让几个人接受教育并参与进来，否则可能会达到次优甚至不正确的配置。组建高可用性团队和高可用性环境。包括具有高可用性原则和技术要求经验的所有相关部门的成员。团队应计划定期审查基础架构和配置。并一起定义审计和测试目标。

DevOps 工具市场为这一经典挑战带来了巨大的机遇。解决方案可以自动分配负载，并发出故障警告。可以帮助您预测或在问题发生后跟踪问题的分析平台。以及负载测试工具，如 BlazeMeter 和 Visual Studio Online，在部署应用程序之前，在峰值负载下测试应用程序。

没有百分百的事。但是，在您的环境中建立一些灵活性，并预测问题可以防止更多的问题，而且还可以更快地响应，达到自动故障转移的程度。