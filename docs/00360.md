# 脚本或机器映像，引导的最佳方式是什么

> 原文:[https://devo PS . com/scripts-machine-images-best-way-bootstrap/](https://devops.com/scripts-machine-images-best-way-bootstrap/)

在诸如 Chef 和 Puppet 之类的便利工具和 VMWare 和 AWS 之类的虚拟机基础设施出现之后，我觉得关于如何引导机器有一场大辩论。似乎有两个极端。一边是对机器图像(AWS 称之为 AMIs)或脚本(Chef 称之为 recipes)的严重依赖，另一边是中间的一堆灰色。当然，这两者各有利弊，所以让我们来探讨一下。

**机器图像**

机器映像的好处在于，在创建虚拟机的时间内，您可以从零到全功能的机器。当你需要快速旋转时，这是非常有价值的。但是，它们会随着您的配置变化的速度而变得过时。

**脚本**

使用所有脚本方法，您可以避免机器映像遇到的过时问题。最大的缺点是，从脚本启动一台新机器可能需要很长时间，尤其是当您必须编译一个或多个组件时。在我看来，当您的系统配置变化很快并且对旋转延迟有一定的容忍度时，这种方法是最有价值的。

这两种方法都适用于自动扩展，并且释放了云的弹性，那么哪种方法最好呢？帮助您决定哪种方法或哪种方法的组合最适合您的情况。这些似乎是显而易见的，但是我认为您必须权衡脚本或图像提供的三个主要的权衡或好处。

*   **服务就绪时间**

从开始引导一台新机器到处理实时流量，您能承受多少时间？为了满足我们的按需扩展要求，在 Clip，我们的目标是从请求虚拟机到处理实时流量只需 10 分钟。

*   **适应变化的能力**

您的环境有多动态？部署新服务、添加依赖项或部署代码的频率如何？在 Clip，我们定期添加新的服务，从代码和依赖关系的角度来看，我们的系统经常发生变化。

*   **跨平台支撑**

需要支持多少平台？在这种情况下，平台可以解释为操作系统、云提供商和/或虚拟或物理硬件。到目前为止，我们已经能够最小化任何跨平台问题。

因为我们重视灵活性，并且拥有 10 分钟的可接受启动时间，所以我们选择在引导过程中严重依赖 Chef，并且只使用基本的机器映像。然而，随着产品和业务需求的发展，服务就绪的时间变得越来越重要，因此我们的流程也将发生变化。在其他公司，启动时间非常重要，他们的 CI 系统会为部署的每个产品版本构建一个新的机器映像，以便他们能够尽快扩展。无论使用何种技术或流程，最重要的是在服务就绪时间、应变能力和跨平台支持方面满足业务需求，并随着需求的变化而不断调整。