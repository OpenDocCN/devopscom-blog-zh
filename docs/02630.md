# Azure 云中的业务连续性:了解选项

> 原文:[https://devo PS . com/business-continuity-in-the-azure-cloud-understanding-the-options/](https://devops.com/business-continuity-in-the-azure-cloud-understanding-the-options/)

通过各种高可用性和灾难恢复供应，有许多方法可以确保在 Azure 云中运行的应用程序的业务连续性。但是，由于有无数种选择，为每一种应用选择最佳和最具成本效益的配置可能会非常困难。最好的情况是，在开发过程中做出糟糕的选择会浪费金钱。在最坏的情况下，错误的选择会导致在操作期间需要故障转移时失败。

所有业务连续性供应都涉及硬件和软件冗余、数据复制以及一些故障转移和回切手段。基于其经过验证的可靠性和成本效益，专门构建的故障转移群集软件一直是最受欢迎的选择之一。使用共享存储在企业数据中心部署集群相对容易。但是由于公共云中没有可用的共享存储，在 Azure 中配置故障转移集群变得相当具有挑战性。

本文研究了 Azure 云内部和面向 Azure 云的高可用性(HA)和灾难恢复(DR)配置的可用选项。特别强调 SQL Server 是 Azure 的一个特别受欢迎的应用程序。

## Azure 云中可用的选项

Azure 云在三个层面提供冗余:数据中心内、区域内和跨多个区域。在数据中心内，可用性集用于将冗余服务器分布在位于不同机架的不同故障域中，从而防止服务器和机架级别的故障。这为一些故障提供了一些保护，但在全站点故障期间没有提供保护，例如 2018 年 9 月在 Azure 的美国中南部地区发生的故障。99.95%的服务级别协议(SLA)仅保证在具有两台或更多服务器的可用性集中，至少有一台将具有外部连接，但它不保证应用程序级别的可用性。

为了防止站点范围的故障，Azure 现在提供可用性区域(AZs)。有 AZs 的地区至少有三个数据中心通过支持同步复制的高带宽、低延迟网络互连。Azure 为 AZs 提供了 99.99%的 SLA，但同样，只保证至少一台服务器将具有外部连接性——不多也不少。

对于重大灾难期间的冗余，Azure 提供了区域对，其中每个区域都与同一地理位置(例如美国或欧洲)的另一个区域配对。这些区域相隔至少 300 英里，以防止可能影响整个区域(包括多个 az)的大范围灾难。通过将区域配对，微软能够一次应用一个更新，以防止“更新变坏”的情况，并将在 Azurewide 宕机期间优先恢复每对中的至少一个区域。但同样，Azure 只保证服务器的“拨号音”，让客户来确保应用程序级别的可用性。

## 操作系统和 SQL Server 软件中的可用选项

Windows Server 故障转移群集(WSFC)是一项标准操作系统功能，许多应用程序利用它来为企业数据中心提供高可用性保护。然而，WSFC 需要某种形式的共享存储，这在历史上没有在任何公共云中提供，包括 Azure 的。

微软在 Windows Server 2016 的数据中心版中通过添加存储空间直接(S2D)解决了这一问题，这是一种软件定义的虚拟存储区域网络。但是，由于集群必须完全位于一个数据中心内，因此 S2D 与可用性区域不兼容。因此，需要多站点高可用性/灾难恢复保护的应用程序将需要使用第三方故障转移群集软件、日志传送或其他一些附加配置。

由于没有适用于 Linux 的 WSFC 或 S2D，HA/DR 保护需要使用开源软件(如 Pacemaker)或第三方故障转移群集解决方案。因为支持开放源码软件需要大量的和持续的承诺，只有最大的组织有必要的资金来考虑这个自己做的选择。

无论是用于 Windows 还是 Linux，SQL Server 都提供了两个自己的 HA/DR 功能:故障转移群集实例和始终在线可用性组。fci 有两个主要优点:包含在标准版中；和保护，包括系统数据库。一个明显的缺点是需要支持群集的共享存储，包括支持 S2D 的虚拟存储，仅支持 SQL Server 2016 和更高版本。

始终在线可用性组是 SQL Server 更强大的 HA/DR 产品，能够提供 5-10 秒的恢复时间和几秒或更短的恢复点。它的缺点包括缺乏对整个 SQL 实例的保护，并且需要许可更昂贵的企业版，这对许多应用程序来说成本过高。

所有特定于应用程序的选项的一个显著缺点是，开发运维人员需要针对不同的应用程序使用不同的高可用性和/或灾难恢复解决方案。拥有多个高可用性/灾难恢复解决方案不可避免地会增加复杂性和成本，这也是应用无关的第三方解决方案如此受欢迎的另一个原因。

## 第三方故障转移群集软件选项

与应用程序和平台无关，使得专门构建的故障转移群集软件能够为几乎所有 Windows 和 Linux 应用程序提供完整的 HA/DR 解决方案。应用程序不可知论消除了针对不同应用程序使用不同 HA/DR 解决方案的需要。平台不可知论使得利用 Azure 云中的各种功能和服务成为可能，而不依赖于这些功能和服务，这使得该选项适用于私有、公共和混合云环境。

故障转移群集解决方案至少包括实时数据复制、用于检测应用程序级故障的持续监控以及可配置的故障转移/故障回复策略。所有这些都旨在满足任务关键型恢复时间和恢复点目标，而且大多数还提供了各种增值功能来简化实施和管理。

## 满怀信心地进行聚类

无论是单独使用还是以各种方式组合使用，所有这些选项都有助于使 HA 和 DR 保护对所有应用程序来说都更有效、更经济，从那些可以忍受一些停机时间的应用程序到那些需要五个 9 正常运行时间的应用程序。但是要确保所选择的选项能够在应用程序级别为所有可能的故障场景提供保护。

戴夫·伯明翰