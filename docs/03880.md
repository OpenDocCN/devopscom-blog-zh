# 超越 SSH 和 PKI 的安全性

> 原文：<https://devops.com/moving-security-beyond-ssh-pki/>

SSH(安全外壳)仍然是远程访问 Linux 服务器的最常用方法，这使得它成为试图渗透到公司网络的攻击者的常见目标。虽然该协议本身具有许多高级安全属性，但它确实允许人为错误，为未经授权访问敏感的公司资源打开了大门。

跟踪整个公司的所有有效凭证是 IT 部门一直在努力解决的问题。如果它们落入坏人之手，风险就很高，实质上就是交出了众所周知的“王国的钥匙”。Dimensional Research 最近的一项研究发现，90%的受访者没有所有 SSH 密钥的完整和准确的清单，63%的人不主动轮换密钥，即使管理员离开了公司。

在密钥管理中，管理对服务器的特权访问一直是一项严格的工作。有许多最佳实践可以遵循，以避免许多常见的陷阱，例如将私钥存储在 vault service 中或维护严格的轮换策略，但它们没有触及问题的关键:凭据是静态的。这里有一个(不那么)疯狂的想法:如果我们完全摆脱它们会怎么样？静态凭证已经成为过去，代表着企业安全的失败的外围模型。

# 传统 PKI 的问题

支持 SSH 的传统 PKI(公钥基础设施)是为不同的时代构建的，当时密钥交换足以授予信任。没有适当的认证过程，就没有明确的方法来确定一个人，也没有可行的方法来提供任何历史背景。随着这些密钥在基础设施和云服务之间分发，挑战只会越来越大。随着时间的推移，每个公钥都会累积更多的特权；它存在的时间越长，就越有可能被某个资源共享，这使得跟踪和撤销它变得非常困难。在这个模型中，时间是一个无法修复的 bug。

授权一个特定的请求还应该不仅仅是在服务器的 authorized_keys 文件中存在公钥。独立于身份验证，授权是关于谁应该和不应该能够从已知的设备访问特定的服务器，以及他们在机器上有什么权限。您可能有一个策略，规定只有工程团队的成员才能通过 bastion 主机访问生产服务器。然而，如果没有适当的授权程序，在实践中坚持这一政策是不可能的。

## 输入零信任安全性

我们已经在整个行业达成共识，在现代云时代，网络边界正在瓦解。现在是时候更进一步，就新的信任证明模型达成一致了，该模型将决策从网络层移除，并在应用层正确处理。像这样翻转模型意味着默认情况下从零特权开始，并且只有在请求被完全认证*和*授权后才授予对资源的访问权。验证，然后信任——零信任的咒语。

谷歌的 BeyondCorp 是零信任的典范，这是一项旨在更好地保护员工访问公司资源的内部举措。最终结果是一个精心制作的分布式系统，它根据对用户及其设备的了解做出实时信任决策，使全球数千名谷歌员工能够在任何地点安全工作，而无需使用 VPN。BeyondCorp 只是一个例子，我们已经看到越来越多的公司开始采用类似的方法。

## 临时客户端证书

短暂凭证背后的思想是，请求触发独立的身份验证和授权过程，其中根据资源的策略进行信任证明。如果有效，将颁发一次性凭据，用于启动与资源的安全会话。该凭证严格限定在特定请求的范围内，在任何其他情况下都没有用。

该工作流的基础可以通过客户端证书支持的 PKI 体系结构来完成。随着版本 5.4 的推出，客户端证书在 2011 年成为 OpenSSH 的一个受支持的特性。与不携带元数据的标准 SSH 密钥不同，证书是可加密验证的元数据对象，可以注入用户名、角色等信息。时间现在成为一个特征，因为凭证的范围真正代表了信任的动态证明。

客户端证书支持的 PKI 体系结构中固有的细粒度访问控制解决了 SSH 密钥的问题，因为凭证可以绑定到实际用户。丢失、被盗或滥用凭证的威胁载体也消除了，使管理人员免除了与 SSH 密钥管理相关的许多麻烦。

要将这些短暂的凭证付诸实施，您需要用支持的访问控制来包围客户端证书 PKI。有能力的公司可以建立自己的系统，类似于谷歌的 BeyondCorp，但这并不是一项简单的任务，因为你需要操作自己的认证机构以及能够根据策略实时执行动态认证和授权的分布式系统。

## 关于作者/伊万·德怀尔

![](img/5c84684a8823f651f92feed972118c97.png) Ivan Dwyer 是 [ScaleFT](https://www.scaleft.com/) 的产品营销副总裁，他与社区一起提高人们对 BeyondCorp 和 Zero Trust 的认识，帮助各种组织实现安全架构的现代化。在 [LinkedIn](https://www.linkedin.com/in/ivandwyer/) 上与他联系，在 [Twitter](https://twitter.com/fortyfivan) 上关注他。