# 成功应用部署的终极清单

> 原文:[https://devo PS . com/ultimate-check list-successful-app-deployment/](https://devops.com/ultimate-checklist-successful-app-deployment/)

部署软件版本是计划、测试、加班和庆祝啤酒的混合。该清单旨在作为一个指南，帮助您的团队改进如何完成这项复杂且有时棘手的任务。

# **第 1 部分:规划和部署准备**

***开发与运营之间的协作***

在规划任何软件部署时，运营部门都要参与进来，这一点很重要。他们需要知道项目何时开始，而不是在最后一刻才知道您的新部署。确保运营部门提前了解所需的任何基础架构变更。如果运营团队是你对应用进行监控和故障排除的第一线防线，帮助他们通过合作来帮助你如何最好地监控应用，并讨论需要提醒的问题的早期预警信号。如果你正在考虑建立 DevOp 团队，你可能应该读一下这个。

***构建&发布自动化***

消除人为因素对于复制软件部署的成功非常重要。您如何部署代码并不一定是最先进的。利用 Maven、Bamboo 或 TFS 这样的基本构建服务器来自动化这个过程，甚至一个通过网络复制文件的简单脚本有时就足够了。这里的关键是让团队中的任何人都可以轻松地重复它，并消除跳过任何手动步骤的可能性。

***最小化变化量***

当事情发生时，通常是因为事情发生了变化。当您在每个软件更新中引入小的更改时，更容易回滚这些更改，或者确切地知道在哪里寻找问题的根源。由于每个发布都需要一定量的计划和测试工作，关键是找到发布频率和规模的适当平衡，这对于您的团队来说是最佳的。

***创建并测试 SQL 修改脚本***

在部署应用程序之前，确保使用类似于 [Red Gate SQL Compare](https://www.red-gate.com/products/sql-development/sql-compare/) 的工具来了解哪些 SQL 模式和数据更改必须转移到生产中。为了确保没有会导致潜在问题的环境差异，我建议永远不要忘记在最终发布之前备份生产环境并在备份副本上运行测试脚本。生产数据差异或不同的数据库软件版本通常会导致中断。另外，如果发布有问题，要有一个回滚到以前状态的计划。代码很容易回滚，但是 SQL 需要一些规划。

***了解你的 KPI***

每个应用程序都应该有某种形式的关键性能指标或衡量标准，可以用来了解一切是否顺利运行。不同的应用之间会有很大的差异。它们可以简单到服务器 CPU、页面加载时间或数据库性能指标。不过，最好的指标更多的是自定义的。了解每分钟有多少订单发生，或者队列中有多少消息正在被处理，需要多长时间，或者某段代码执行需要多长时间，这些都是应用程序的关键部分。让您的 KPI 成为您应用程序的心跳，并[随时监控它们](http://www.stackify.com/features/app-metrics/)。

***设置合成交易测试***

创建一些测试，测试你的登录页面、应用程序中的关键页面、API 等。这将使您对应用程序部署后所有系统的运行非常有信心。我强烈推荐领先的 web 自动化开源框架 [Selenium](http://www.seleniumhq.org/) 。

***通知你的用户和同事***
不要忘记通知你的用户和公司内的其他人即将发生的变化。请确保您有时间更新文档，培训内部员工了解新功能，并与公司的其他部门进行协调。

# **第二部分:部署后**

***监控服务器利用率***

确保负载平衡器中的所有服务器都在线，并且仍在接收流量。[监控服务器](http://www.stackify.com/features/server-monitoring/)和 app CPU、内存、网络、磁盘使用情况。*没有*利用率会像突然*高*利用率一样糟糕。

***监控异常率***

在新版本发布后，你的软件可能会抛出一些你从未见过的新异常。利用一个[错误跟踪](http://www.stackify.com/features/errors/)程序，这样你就可以立即识别发布中引入的新错误，并确保以前解决的错误不会被再次引入。部署前后的总体错误率的比较将为您提供发布健康的良好指示。

***检查你的 KPI***

密切关注您的[性能指标](http://www.stackify.com/features/app-metrics/)，它让您知道您的应用程序是否正常运行。

***看你的日志***

在应用程序部署后，确保日志记录仍在工作，并且日志记录的数量没有显著变化。完全不记录会和突然的高记录率一样糟糕。集中式的[日志管理工具](http://www.stackify.com/features/log-management/)使得监控变得容易。您可能还想检查已发布的新特性的日志，以确保它们行为正常。

***监控页面加载次数和 HTTP 错误率***

观察应用程序的总体页面加载时间，密切关注对应用程序至关重要的 2-3 个请求。还要注意 400 和 500 级 HTTP 请求的比率，以确保它们没有发生显著变化。

***监控数据库性能***

部署后，确保数据库 CPU、IO 和整体流量看起来正常。没有什么比发布后数据库流量突然下降更可怕的了…除非是数据库流量突然激增。

***监控关键数据库查询***

在您的监视系统中设置监视器来测试关键查询，以确保它们快速加载并返回正确的结果。例如，如果一些重要的后台进程基于 SQL 查询工作，那么运行类似的查询来确保它没有遗漏要做的工作并且工作正常。

***监控应用队列***

监控您的应用程序队列中有多少邮件，以确保所有邮件都正常流动，不会积压。

***缓存服务器变化***

不要忘记缓存。根据您使用缓存的方式，您可能需要清除缓存或进行其他配置更改。数据类型更改通常会导致缓存中出现一些奇怪的序列化类型问题。

***来一杯庆祝啤酒！*T3】**

在[stack ify](http://www.stackify.com)时，我们更喜欢当地的一家酒吧，那里有一些不错的手工 IPA，或者是由我们的[开发商之一酿造的 IPA。确保你的团队在发布后有一个好的传统。](http://www.stackify.com/wp-content/uploads/2015/01/stackifypa-beer.png)

***验尸会议***

停下来几分钟，讨论一下上一个版本的进展如何，以及如何改进，这是非常有价值的。这种类型的对话可以帮助识别团队的弱点，允许人们发泄，并注意到在未来的开发周期中可以试图避免的问题。

# **总结**

长期部署的成功依赖于能够自动化和创建过程，以最大限度地减少所有利益相关者的问题。从长远来看，围绕您的构建和发布过程创建一些自动化或脚本会带来很大的好处。利用各种[监控工具](http://www.stackify.com/features/server-monitoring/)或寻找新的工具来帮助从各个角度监控您的服务器和应用程序的健康状况。随着时间的推移跟踪趋势可以帮助您展示每个版本在可用性、性能、KPI 和用户体验方面的改进。

**关于作者**

[![matt](../Images/78edaf85cc97127be0966fc3792e5763.png)](https://devops.com/wp-content/uploads/2015/01/matt.png) 马特·沃森于 2012 年创立 Stackify，并担任首席执行官，为公司的发展方向提供愿景和领导。在创办 Stackify 之前，他是 VinSolutions 的创始人兼首席技术官。VinSolutions 的创新产品带来了公司的快速发展，甚至在 2010 年登上了 500 强榜单(排名第 447 位)。Matt 本质上是一名企业家，擅长产品和软件开发。

Matt 在 DeVry 大学学习计算机信息系统。他在中学时就开始编程，以便在上学时自动玩视频游戏。从那以后，他就没有停止过编程，并且热爱任何与技术相关的东西。其他爱好包括工作过度，旅游，电影，高尔夫，汽车，当然还有他的家人。你可以通过 @Stackify、@mattwatson81、【www.stackify.com】T3、[https://www.facebook.com/Stackify](https://www.facebook.com/Stackify)联系到马特