# 一个安全的云操作系统——单核的崛起

> 原文:[https://devo PS . com/one-secure-OS-for-the-cloud-the-rise-of-uni kernels/](https://devops.com/one-secure-os-for-the-cloud-the-rise-of-unikernels/)

在过去几年中，许多开源项目已经开始构建有趣的新技术来创建更快、更安全和可伸缩的云应用程序。名字:unikernels。目标是:为云开发一种新的应用程序(或移植现有的应用程序),通过将传统的分层应用程序堆栈减少到单个单核虚拟机(VM)映像中，显著提高安全性、性能和可伸缩性。换句话说，操作系统、您需要的任何库和应用程序本身都被编译成一个小的单内核映像。

传统的应用程序堆栈在操作系统中并行运行，而操作系统又可以在(VM)中运行。操作系统管理资源并将应用程序相互隔离。在单内核中，单个应用程序在单个虚拟机中运行，而是依靠虚拟机管理程序来隔离这些虚拟机。单核是通过使用“库操作系统”构建的，用户可以从中选择运行应用程序所需的最少服务。在一些 unikernels 中，编译器和链接器会删除所有不使用的代码，并将其打包成一个可以直接部署到云中的映像。这些密封的、固定用途的映像直接在虚拟机管理程序上运行，无需 Linux 等来宾操作系统的干预。

[![Screen Shot 2015-04-01 at 10.59.12 PM](../Images/2d0102875c1b7039781adef8445926e5.png)](https://devops.com/wp-content/uploads/2015/04/Screen-Shot-2015-04-01-at-10.59.12-PM.png) 单核还为跨平台环境、大数据分析和横向扩展云计算提供了令人印象深刻的灵活性、速度和多功能性。像基于容器的解决方案一样，unikernels 实现了易于部署的承诺，但也提供了非常小的、专门的运行时内存，更不容易受到攻击

许多单内核开源项目开始起步，每个项目都有自己独特的关注点和方法。例如， [MirageOS](http://openmirage.org) 和 [HaLVM](https://galois.com/project/halvm/) 采取全新的方法，强调安全和保障；ClickOS 强调速度；而 [OSv](http://osv.io) 和 [Rump 内核](http://rumpkernel.org)旨在与现有应用兼容。OSv 和 Rump 内核在移植现有应用程序方面都取得了重大进展:例如 MySQL、PHP 和 Nginx 已经移植到 Rump 内核，而许多应用程序如 Tomcat、Jetty、Cassandra、OpenJDK 和 [others](https://github.com/cloudius-systems/osv-apps) 已经移植到 OSv。与此同时，MirageOS 展示了 1MB 的 unikernels，它服务于 DNS、Git 和 SSL web 流量，并具有完整的类型安全，甚至包括设备驱动程序。

下面让我们仔细看看这种新的、更安全的部署云服务的方法。

**单核应用易于部署**

单核应用程序的基本开发和部署模型与传统的应用程序堆栈有些不同，在传统的应用程序堆栈中，应用程序是作为一组二进制文件、软件包或某种安装程序交付的。不同的单核采用的方法略有不同，但在所有情况下，单核应用程序实际上都是一个 VM 镜像，可以直接部署到云中，无需任何配置。例如，这与 Docker 使用“一次构建，随处部署”的模型没有什么不同。

让我们来看两个单核，每个都有不同的工作流程。

MirageOS 的典型开发工作流程是，开发人员在他的本地机器(如 Mac OSX)上编写单内核应用程序，并针对本地目标进行编译。正确的库是通过 OPAM 软件包管理器提供的，并包含在测试映像中。不直接在管理程序中开发的理由是本地有更丰富的开发工具。毕竟，单内核映像是一个虚拟机映像，它只包含配置数据和应用程序使用的库和服务。当应用程序经过测试后，开发人员将构建一个虚拟机映像，并将其部署到基于 Xen 的云中。

由于 MirageOS unikernels 非常精简，它们甚至可以自己进行版本控制。这种方法已经被 MirageOS 社区实践了两年多，并且被证明是非常灵活和敏捷的。Amir Chaudhry 最近在“Heroku for Unikernels”上发表的一篇文章描述了该团队正在使用的端到端工作流。

以 OSv 为例， [Cloudius Systems](http://www.cloudius-systems.com) 开发了一个工具，用于快速构建和运行 OSv 应用程序，名为 Capstan。Cloudius Systems 表示:“Capstan 与使用 Docker 创建容器一样简单快速，但结果是一个完整的虚拟机映像，可以在任何支持 OSv 的虚拟机管理程序上运行。”。

**单核如何提供更好的安全性**

随着各行各业向网络化、横向扩展设计发展，面对不断变化的新工作负载和数据类型，安全性成为一个关键问题。Haskell 轻量级虚拟机 [(HaLVM)](https://galois.com/project/halvm/) 的创始人亚当·维克(Adam Wick)是 Galois Inc .的研究负责人，该公司的客户包括美国国防部和 DARPA，他表示，2015 年已经成为安全领域的突破之年。

“云计算已经成为一个热门话题好几年了，我们已经看到了大量利用云提供的灵活性的项目和技术，”Wick 说。“但与此同时，我们也看到了一个又一个破纪录的安全漏洞。”

MirageOS 的创建者 Anil Madhavapeddy 表示，“继续故意提供潜在不安全的代码是完全不负责任的，尤其是在我们进入充满智能城市和无处不在的物联网承诺的一年时。”

专门研究新技术 R&D 的伽罗瓦表示，企业越来越感兴趣的是，能够干净地分离功能，将违规的影响限制在受影响的组件，而不是感染整个系统。对于下一代和内部云，单核使得每台主机运行数千个小型虚拟机成为可能。

Galois 在其 CyberChaff 项目中使用了这一功能，该项目使用最少的虚拟机来改进敏感网络上的入侵检测，而其他公司则使用类似的机制来节省大量的硬件、电力和冷却成本；同时减少暴露给恶意黑客的攻击面。

运行在 Linux 上的传统应用程序堆栈，以及在较小程度上的 Docker 映像，依赖于相当重量级的核心操作系统来提供关键服务。Wick 说，因此，Linux 内核中的漏洞会影响每个 Linux 容器。相比之下，单内核遵循一种类似于点菜菜单的方法:因此，在单内核映像中只存在运行应用程序所需的最少功能和服务。因此，编写一个漏洞来攻击单内核应用程序比对传统的应用程序堆栈做同样的事情要困难得多。

Cloudius Systems 正在运行 OSv 的私有测试版，它将操作系统标记为云，它认识到在使容器技术更加安全方面正在取得进展。

“Rocket 确实是对 Docker 的改进，但容器在设计上不是多租户解决方案，”首席执行官 Dor Laor 说。“无论您在容器上抛出多少 SELinux Linux 策略，攻击面仍然会跨越内核的所有方面。”

**结论**

对于担心安全性的组织来说，关键的一点是，他们应该以一种不那么单一的方式来对待他们的基础架构。单核允许对组织的数据和处理需求中特别关键的部分进行仔细的管理。虽然构建单内核应用程序需要一些额外的工作，但随着越来越多的开发人员解决编排、日志记录和监控方面的挑战，这变得越来越容易。同时，unikernels 的打包和部署并不比 Docker 容器难。这意味着当许多开发人员开始构建向外扩展的分布式系统时，他们开始认真考虑安全性，此时单核正在走向成熟。

## **关于作者/拉斯·库斯**

**[![lars-devops](../Images/fe2293312b8555278ac456373a9fda2a.png)](https://devops.com/wp-content/uploads/2015/04/lars-devops.jpg) 拉斯·库斯**是 **Xen 项目顾问委员会主席**。Xen 项目社区是 Linux 基金会的一个合作项目，致力于在许多不同的商业和开源市场领域推进虚拟化，包括服务器虚拟化、基础架构即服务(IaaS)、桌面虚拟化、安全应用程序、嵌入式和硬件设备。Xen 项目成员从一开始就为云计算而设计，包括:亚马逊网络服务、AMD、ARM、Cavium、思科、思杰、谷歌、英特尔、NetApp、甲骨文、Rackspace 和威瑞森 Terremark。欲了解更多信息，请访问 XenProject.org。