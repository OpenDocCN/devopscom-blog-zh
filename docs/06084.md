# 通过了解何时移除特性标志来防止技术债务

> 原文:[https://devo PS . com/prevent-technical-debt-by-know-when-remove-feature-flags/](https://devops.com/prevent-technical-debt-by-knowing-when-to-remove-feature-flags/)

随着越来越多的组织使用特性标志和实验，理解这些变化应该只存在很短或特定的一段时间，然后从你的代码库中删除是很重要的。在适当的时候移除标志可以避免技术上的负担和复杂性，这些会使您的代码变得脆弱、更难测试和更难支持。

评估何时应该删除某个特征标志或实验的最简单方法包括查看它在系统中存在了多长时间，以及它处于多少种不同的状态。如果功能标志在您的系统中已经存在了很长时间，并且您的所有用户都具有相同的功能标志状态，则很可能应该将其删除。

然而，仅仅基于这两个因素进行评估是不够的。明智的做法是，在最终决定移除某个标志或实验之前，也评估一下它的目的。特性标志或实验的适当生命周期，以及何时应该从代码库中移除，很大程度上取决于它的用例。

## **何时移除临时标志和实验**

如果某项功能旨在向所有人推出，并且您不希望在该功能推出后进行试验，那么您需要确保一旦该功能完全向您的用户推出，您就有一个跟踪其删除的标签。这些临时标志可能持续几周、几个月或几个季度。例子包括:

*   **彩绘门实验:**这些实验只打算在软件开发生命周期的早期阶段使用，并不打算在验证或否定实验假设后保留在产品中。
*   **性能实验:**这些实验旨在将两种不同的实现放在一个真实的性能实验中进行对比。一旦收集了足够的数据来确定性能更高的解决方案，通常最好将所有流量转移到性能更高的变体，并删除相关的标志。
*   **大规模重构:**当在框架、语言或实现细节之间转换时，将这些相当冒险的变化部署在一个特性标志后面是很有用的，这样你就有信心它们不会对你的用户或业务产生负面影响。然而，一旦重新因素完成，你希望不会回到另一个方向。
*   **产品重新品牌化:**如果你的企业为了品牌的目的决定改变你产品的外观和感觉，有一个渐进的展示来优雅地转移到新的品牌化是有用的。建立新品牌后，最好移除支持交换机的功能标志。

## **如何查看永久标志和实验的寿命**

如果一个特性被设计成对不同的客户有不同的状态，或者如果你想控制它的操作过程的配置，那么这个标志很可能会在你的产品中停留更长的时间。这些标志和实验的例子包括:

*   **权限标志:**如果您的产品中有不同的权限级别，例如“只读”不允许对功能进行编辑访问，则这些标志很有用。如果您有模块化定价，如不具备该功能的廉价“启动计划”，但具备该功能的更昂贵的“企业计划”，那么它们也很有用。
*   **操作标志:**这些标志控制你的应用程序的操作旋钮。例如，这些标志可以控制是否批处理从应用程序发送的事件，以最大限度地减少出站请求的数量。您还可以使用它们来控制用于水平扩展应用程序的机器数量。此外，它们还可以用于禁用计算成本高昂的非必要服务，或者在停机时允许从一个第三方服务优雅地切换到另一个第三方服务。
*   **基于配置的软件:**对于任何由配置文件驱动的软件或产品来说，这是一个无缝插入实验的好地方，维护成本低，并且仍然允许无止境的产品实验。例如，一些公司的产品布局可能由一个配置文件支持，该配置文件抽象地描述了是否包含不同的模块以及它们在屏幕上的位置。使用这种架构设置，即使您现在没有运行实验，您仍然可以在将来进行产品实验。

请注意，即使一个标志是永久的，定期检查这些标志仍然很重要，以防它们变得过时或应该被废弃，这将增加您的代码库的技术债务。

## **建立特征管理流程**

创建一个始终在线的功能管理流程与有效地使用功能标志和实验是密切相关的。一些组织使用任务跟踪系统和他们的特征标志和实验平台的组合来无缝和快速地管理这个清理过程。如果功能标志和实验的状态可以与标签跟踪工具同步，则工程经理可以运行对其状态在过去 30 天内没有改变的所有功能标志和实验的查询，并跟踪功能标志和实验的所有者以评估他们的审查。其他团队安排重复的功能标记和实验移除日，以确保工程师定期审查最早的项目，从而最大限度地减少技术债务。

[特性标志](https://devops.com/the-relationship-between-feature-flags-and-devops/)和帮助团队快速安全地发布代码和推出新特性的实验的好处远远超过了最小化代码库技术债务和复杂性所需的管理。当作为一个循环过程来管理时，考虑到所有的关键因素(生命周期、状态和用例)，团队可以确信他们的系统将保持高效和可靠。

— [阿萨·夏查尔](https://devops.com/author/asa-schachar/)