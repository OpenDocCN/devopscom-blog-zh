# 持久存储:你会听到更多

> 原文:[https://devops.com/persistent-storage-youll-hearing/](https://devops.com/persistent-storage-youll-hearing/)

随着容器接管 IT 环境，自虚拟机(VMs)流行以来就存在的一个问题变得更加紧迫:如何保持持久存储，并保持其一致性。

正如为每小时 50 到 100 人的客流量设计的业务在每小时 500 到 1000 人的情况下工作不佳一样(想想最近大多数地方的黑色星期五)，为保存跨实例甚至跨设备持续存在的数据而设计的存储通常在集装箱化环境中很困难。

出现这种情况有几个原因。

首先，我们现在将服务器视为一次性资源。如果一个死了，我们让它死了，然后简单地旋转另一个。正常的处理保留死的服务器供以后评估，但是许多商店没有遵循这个最佳实践。该问题与写入永久存储时死亡的服务器有关—写入的状态是什么？它在传送过程中被中断了吗？幸运的是，应用程序的设计可以考虑到这一点，在不基于数据库管理系统(DBMS)的应用程序中，事务处理越来越流行，这表明人们正在这样做。

第二，在容器化的环境中，访问这些持久性存储的服务器实例的数量更多，它们更小、更轻、启动更快，并且它们的容器密度通常高于虚拟机密度。当一个应用从“一个服务器正在向这个持久性存储写入”变成“两个服务器正在向这个持久性存储写入”时，争用问题从零变到完全并且通常有数百个服务器向持久性存储器写入数据。如前所述，权宜之计是实施某种形式的事务处理来防止写入和覆盖。

# 持久存储:它有问题

问题是，我们最终将事务处理写入数十或数百个服务器实例，以保护少量的持久磁盘。这不是最佳的，至少会增加软件的复杂性。

这就是为什么你会听到更多。以下是一些致力于简化但强大的持久性想法的地方:

### **{code}雷克斯雷**

{code}最初是 EMC 的一部分，是戴尔的开源团队，它领导了促进持久存储的容器存储接口(CSI)的发展。该公司已经实现的例子包括数据库和《我的世界》，但该技术适用于任何必须存储在磁盘上的东西。

### **容器编排引擎和云提供商**

所有知名的容器编排引擎(COE)和基础设施即服务(IaaS)云供应商都有处理持久磁盘的方法——有些方法比其他方法更具事务性，有些方法比其他方法工作量更大。预计这一过程将在未来一年左右变得标准化(并且这种标准化可能采取上述 CSI 的形式)。如果持久数据对您的容器环境至关重要，那么值得看看每种解决方案是如何解决问题的，因为有些解决方案是程序性的(比如 Docker 的[建议](https://docs.docker.com/engine/admin/volumes/volumes/))，因此在某种程度上可以跨 COE 解决方案移植。IaaS 提供商的弱点是系统之间的可移植性，但目前所有 IaaS 程序/解决方案都是如此。

### **虚拟引擎**

VMware vSAN 和 Microsoft NTFS 都有提供持久磁盘的系统。虽然这很大程度上是“当容器消失时，磁盘不会消失”的简单情况，但这是持久性需求的主要部分。预计支持将继续扩展，甚至可能会实现 100%的事务共享。

### **存储阵列供应商**

存储阵列供应商拥有这方面的有用工具。虽然您使用什么来访问他们的存储对这些供应商来说不是太大的问题，但他们确实有既得利益来确保他们的存储满足不断变化的企业的需求。因此，他们正在探索帮助实现持久存储可用性和一致性的方法。这对供应商来说并不是一个很大的挑战，因为他们生产的系统总是为多路访问而设计的。他们落后的地方(也是 Rex Ray 进步的地方)是供应商解决方案的互操作性/互换性。

# **结论**

对于那些对持久/共享存储具有受控访问权限的人来说，这些问题并不是什么大问题。然而，对于大容量或高周转率的 DevOps 安装，持久存储是可靠性链中必须保护的另一个环节。继续努力，希望在您的需求变得紧迫之前，有一个可靠的系统来管理和保护持久性存储。

唐·麦克维蒂