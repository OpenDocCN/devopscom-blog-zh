# MongoDB 的备份和恢复，第 2 部分

> 原文:[https://devops.com/backup-recovery-mongodb-part-ii/](https://devops.com/backup-recovery-mongodb-part-ii/)

这篇博客是关于 MongoDB 备份和恢复的两部分系列文章的第二篇。在我之前的一篇博客中，我谈到了为什么公司需要复制和备份来实现企业级数据保护。在这个博客系列的第一部分中，我讨论了现有的 MongoDB 备份和恢复解决方案及其缺点。现在，在这篇博客中，我将讨论保护驻留在 MongoDB 上的数据的关键要求(部署在内部，使用“即服务”模式部署在私有云上，或者使用 Amazon AWS 或 Google 云平台部署在公共云中)。

### 要求 1:在线集群一致备份

部署在 MongoDB 上的下一代应用程序必须始终在线。这意味着暂停数据库以进行备份是不可行的，并且备份操作不应该影响应用程序的性能。随着应用程序的扩展，底层 MongoDB 也需要扩展到多个分片。在这种情况下，备份解决方案必须跨碎片提供一致的备份副本，而不会在备份期间中断数据库和应用程序性能。

### ![Advanced Data Management Services](../Images/44ecb96c87451757201a4cb26761d9f8.png)要求 2:灵活的备份选项

根据不同的应用，数据可能有不同的变化率和模式。例如，在一个产品目录中，某些商品可能每天更新(例如，畅销商品)，而其他商品可能有更长的保质期，例如优质商品。根据应用程序要求，一些集合可能需要每小时备份一次，而其他集合可能需要每天备份一次。我们从使用 MongoDB 的客户那里听到的另一个需求是提供这种灵活性，以任意时间间隔和集合级粒度安排备份。更重要的是，这些备份应该始终以本机格式存储在辅助存储上，以避免供应商锁定。

### 要求 3:可扩展的恢复

在其生命周期中，数据驻留在开发、测试、预生产和生产等多个阶段，也可能驻留在多个云中(私有云与公共云)。每个阶段的 MongoDB 集群的拓扑都是不同的。对于生产，应用程序可以部署在一个分片的 MongoDB 集群上，但是测试团队可能只能访问 Amazon AWS(公共云)中的非共享 MongoDB 集群。因此，备份解决方案应该允许跨这种云配置的多个恢复操作，例如分片到分片(例如从 5×3 集群到 2×3 分片集群)或分片到非共享(例如 5×3 集群到 1×3 非共享)。

***![chart](../Images/4ac155a3123a875e87d949151315c478.png)*** 

### 要求 4:处理故障

在分布式数据库世界中，失败是一种常态。但是，备份解决方案应该能够应对数据库进程故障、节点故障、网络故障，甚至备份和恢复操作期间的数据逻辑损坏。最后，备份解决方案应该能够处理存储分片集群元数据的 MongoDB 配置服务器的故障。

客户正在将 MongoDB 部署在物理服务器、私有云和微服务(如框架)以及公共云中。这些部署示例中的备份和恢复应该是无缝的，对于 MongoDB 客户来说，备份和恢复部署的方便性是一个大问题，我将在下一篇博客中讨论这一点。敬请期待！