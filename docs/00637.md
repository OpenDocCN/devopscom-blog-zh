# 云影响应用程序故障排除的 4 种方式

> 原文:[https://devo PS . com/4-ways-cloud-infected-applications-trouble shooting/](https://devops.com/4-ways-cloud-influenced-applications-troubleshooting/)

## 

在过去几年中，云计算的兴起为开发人员带来了前所未有的生产力时代。对于那些已经接受这种新世界秩序的人来说，硬件采购和安装的漫长准备时间、由缓慢的硬件升级定义的体系结构、受硬件限制的可扩展性和灵活性以及只有系统管理员才能访问基础设施的时代已经一去不复返了。但是，随着开发和交付之间的障碍消失，新的挑战已经出现，这些挑战可能会扰乱开发人员的生活，减缓新产品和新功能的交付，使软件定义的数据中心(SDDC)所创造的一些效率收益付之东流。

无论您是云的新手，还是在云变得很酷之前就已经存在的人，您都可能会看到四个常见的挑战，这些挑战会使您在云中对应用程序进行故障排除变得更加困难。让我们先仔细看看这些常见的棘手问题，以帮助建立对挑战的认识，然后我将提供一些建议，说明在揭开应用程序故障排除之谜时，如何防止这些障碍绊倒您和您的团队。

## 所有权转移

如果您在运营团队的支持有限的情况下采用云，或者您可能是越来越多的开发团队甚至无运营团队中的一员，他们发现自己正在连接运营和开发世界，您将发现运营和支持您的应用程序*和*您的基础架构的责任，至少在某种程度上，将引入您可能没有想到的新动态。

没错，在没有处理物理设备负担的情况下构建自己的架构是一种解放，而且效率更高。但是，随着开发人员工具、部署工具和云运营工具变得不可分割地相互联系在一起，谁是开发人员谁是运营人员之间的旧界限变得模糊，甚至完全消失。这意味着开发团队突然成了运营中不可或缺的一部分，无论是设计上的还是默认的，这给开发人员增加了另一项责任，他们的主要任务通常是*走得更快*。你在运营领域花费的时间越多，尤其是在对你的应用或它所依赖的云资源进行故障排除时，你能够投入到通过代码增加新价值的时间就越少。

## 缺乏透明度和举证责任

虽然只需按一下按钮就能获得云的全部好处确实很棒，但你不会因为对“美好的旧时光”有一点怀旧而受到指责，这种怀旧是指能够与大厅另一端的真人就真实的物理硬件(以及实际接触到它的能力)进行对话。当生产中的应用程序出现问题时，一个常见的说法是，证明的负担最初由运营团队承担——在让开发团队深入研究之前，证明硬件在工作，网络是健康的，并且 SAN 没有丢失磁盘。老实说，每个人都希望它是基础设施中“容易”的东西，因为当它是应用程序时，事情就变得困难了。好吧，这个脚本在云上被颠倒了:现在举证的责任落在了开发团队身上，因为真正困难的是找到源自其他人的复杂、抽象、虚拟化的数据中心的问题。

App 返回 500 错误或者性能很差？如果您使用的是以服务形式交付的东西，如数据库、队列、缓存等，除了云提供商的状态页面和您可以直接观察到的任何内容之外，您将无法真正了解运行状况。它要么工作正常，速度很快，要么不是；如果不是，生活会变得更加黑暗。同样，服务器可以被监控，但是如果您是超出您控制的环境的受害者，您无法真正说出为什么您的虚拟资源的性能会下降。

此外，无论您最喜欢的云提供商的支持团队有多优秀，他们很少会像您自己的内部运营团队那样对您关于某个问题的更多信息的请求做出响应，他们也不会像您一样精通您的架构。在不同程度上，您受到云提供商的支配，以获得一致、可靠的服务，并且当您所依赖的服务出现问题时，他们也有责任提供及时的洞察力。当然，关于你的云提供商是否提供这种级别的沟通和透明度，你的里程数可能会有所不同。但是，如果他们没有，那么举证的责任就完全落在你身上，证明问题不在你的应用上。命运逆转了，不是吗？

## 简单复杂

将基础设施问题与代码问题进行分类的挑战变得更加复杂的一个简单事实是，应用程序正变得越来越复杂，并且在许多情况下，整体架构的某些部分本质上可能是短暂的。把复杂和无常结合起来，你就有了一些真正的福尔摩斯级别的神秘事件的秘方。

SDDC 令人难以置信的一点是，您可以创建几乎任何类型的架构来支持您的应用程序堆栈的需求，这一切都相对容易——如果您有梦想，您就可以构建它。想要凑齐。NET，Java，PHP，Node.js，Ruby，SQL 和 NoSQL 的数据库即服务，消息队列即服务，搜索即服务？从云部署的角度来看，部署和开始变得极其简单。但是，随着这种超多语言方法和对软件定义的服务的严重依赖，带来了一系列新的挑战:

*   首先，你有各种各样的服务，这些服务对你来说是黑箱。这些服务中的每一项都有自己的一套技巧来深入了解性能和可用性，但每一项在监控和故障排除方面都可能有所不同。
*   学习如何支持各种不同的技术会拖累您的交付速度。学习一些技术的性能和可靠性技巧已经够难的了；尝试各种各样的方法可以将注意力从通过软件建立新价值和使业务更加成功的真正目标上转移开来。
*   并非每种监控工具都能支持每种技术体系，而且技术网络覆盖面越广，单个监控工具就越难支持所有的技术体系。
*   如果您正在使用动态(瞬时)资源，如按需扩展服务器，如果您没有考虑如何在服务器取消配置时保留随服务器一起消失的关键信息，您很可能会丢失在对问题进行故障排除时需要的关键数据。

## 更频繁的变化

最后，我们来到这把双刃剑，它首先带来了这一切:走得更快！云带来的更高的灵活性，尤其是当与集成到交付周期中的开发工具相结合时(想想 PaaS 环境)，可以缩短交付周期时间并增加特定周、月和年的发布数量。这在已经采用了[敏捷开发实践](http://stackify.com/tips-making-agile-less-fragile/)的组织中尤其如此。代码可以以更高的频率平稳地流向生产环境，架构的改变也可以更快更容易地完成。不幸的是，随着更频繁的代码发布和架构变更，破坏的机会也越来越多。

走向敏捷和精益的很大一部分也是始终向前的概念——而不是在出现问题时回滚发布，尽早发现问题并快速修补它们。然而，要实现这一要求，需要两件事情，如果您来自一个移动较慢的环境或来自一个更传统的托管模型，这两件事情通常是缺失的:1)开发人员对行为遥测基线的可见性，以了解“好”在历史上是什么样子的；以及 2)相对于健康基线的应用程序发布后健康状况的即时反馈。没有这一点，很难知道你的发布是有所收获还是有所损失——你的用户通常是你唯一真正的晴雨表。

## 那么…我如何编码更多，支持更少？

不可否认，云已经影响了许多开发人员的生活，大多是以非常积极的方式。当然，随着新技术和新能力的出现，总会有一系列新的挑战需要克服。在云托管应用程序的情况下，这包括在新环境中有效和高效地支持这些应用程序的挑战，以便生产力的提高不会被应用程序的支持所抵消。

那么，开发团队能做些什么来适应和克服这些挑战呢？

每个开发团队都应该采取 3 个基本步骤来简化基于云的应用程序。

1.  **建立访问、流程和协议**–帮助开发人员更有效地支持其基于云的应用的首要任务是让他们安全地访问所需的信息和资源。不幸的是，在云环境中，这往往是一个要么全有要么全无的命题——对服务器的完全登录权限，甚至可能对管理门户的完全权限，或者根本没有访问权限。确保为您的开发人员建立正确的[访问](http://stackify.com/app-monitoring/)方法，以便他们拥有所需的可见性和访问权限，而不要移交过多的控制权，否则会增加发生事故的可能性。
2.  **将可支持性设计到应用中**–一旦您的应用进入生产环境，您需要立即回答几个关于您的应用的常见问题:它(以及它所依赖的一切)正在运行吗？用户对性能满意吗？有什么事情会无声无息地让用户失败和沮丧，而不会触发警报吗？如果出现故障，谁受到了影响，是什么导致了问题？还有一些事情不能从应用程序外部进行测量和监控，但是它们直接关系到应用程序的健康状况。为了使您能够快速回答不可避免的问题，请考虑纳入以下内容:
    *   如果它移动，测量它。从您的代码中报告应用程序指标和 KPI，以便查看那些原本会对您保密的事件和数据。有些事件和指标只有您，即开发人员，才有权力公开。了解您的应用在核心级别的行为方式可以提供洞察力，这在搜索故障排除线索时证明是非常宝贵的。如果您能够为这些指标配置监控和警报，那就更好了。我们已经在本文中详细阐述了这个主题[错误&日志:让数据发挥作用](http://stackify.com/smarter-errors-logs-putting-data-work-2/)
    *   经常记录，并且有意义地记录。如果您只报告错误，您将缺乏必要的批判性洞察力来帮助指出错误的根本原因。通过记录信息或调试，而不仅仅是警告或错误，您将拥有找到它所需的线索。不可能在事件发生后获得系统的状态，您需要在事件发生时记录下来。
    *   集中你的洞察力。请记住，云中的生命可能是相当分散的，也可能是相当短暂的，将所有东西——日志、错误、自定义指标和其他遥测数据——集中到一个中心位置以实现标准化、关联和连续性总是好的。在云资源短暂的生命周期之外，您可能还需要数据以及数据告诉您的内容。
3.  **尽早确定运行状况基准**–如今，诸如消息队列长度、平均请求时间、应用池资源利用率、自定义指标值、日志和错误率等关键信息都可以为您的应用绘制图表–监控和绘制图表不再仅仅是 ops 工具的领域。了解您的应用程序在健康和不健康状态下的样子，最好从预生产环境开始，这样您就可以看到您的应用程序在不同版本之间、不同负载下以及随着您的架构的发展而变化。通过追溯到开发和 QA 的基线，您通常可以在问题影响客户并使您和您的团队陷入困境之前就发现问题。

## 结论

不可否认，云给开发人员的生活带来了难以置信的能力:速度、敏捷性、灵活性、可伸缩性等等。与任何新的颠覆性技术一样，新的挑战也是意料之中的。通过对应用程序管理、监控和故障排除应用一些基本策略，您可以拥有云的所有优势，而不会在那些关键的支持项目中失去收益，并且让团队成员和最终用户也更开心。在 Stackify，我们相信我们为本文中提出的问题提供了解决方案，今天就开始免费试用[stackify.com/sign-up](http://stackify.com/sign-up)

***作者简介/克瑞格***

[![Craig Ferril Stackify](../Images/6e1e7a7d72ecc274dde98459c8883b24.png)](https://devops.com/wp-content/uploads/2015/05/1.cf-078-2-e1430876214306.jpg) 克雷格·费里尔，首席运营官·斯塔基菲。Craig 领导 Stackify 的运营方面，确保业务像开发团队一样敏捷。他热衷于将精益原则应用到软件和业务中，并拥有 15 年为初创企业、SaaS 公司和大型企业领导软件工程和 IT 运营的经验。他的背景包括领导支持生产软件的团队，这也是他对 Stackify 帮助开发人员和 DevOps 团队的热情的来源。作为一个文艺复兴时期的人，克雷格涉猎方方面面，从酿造啤酒到摄影，再到在赛道上高速驾驶。在推特上关注他 [@cferril](https://twitter.com/cferril)