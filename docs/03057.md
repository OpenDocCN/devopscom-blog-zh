# 开发管道中的脚本:避免“脚本灾难”的最佳实践

> 原文:[https://devo PS . com/scripts-in-the-development-pipeline-best-practices-for-avoiding-the-scriptocalypse/](https://devops.com/scripts-in-the-development-pipeline-best-practices-for-avoiding-the-scriptocalypse/)

使用脚本作为普通开发人员锦囊妙计中的关键工具，已经在很大程度上改变了开发流程。这甚至导致一些组织将他们的整个团队外包出去，以管理长时间开发的大量脚本。

为了帮助公司超越“脚本困境”，我们最近和我们在 [Tricentis](https://www.tricentis.com/) 的朋友一起参加了[一个网络研讨会](https://electric-cloud.com/resources/webinars/beyond-the-script-apocalypse/)。Electric Cloud 客户之旅全球负责人 Sunil Mavadia 和 Tricentis 产品管理总监 Thomas Stocker 介绍了避免 scriptocalypse 的最佳实践。以下是他们讨论的一些要点。

## **提高流程稳健性和可扩展性**

当然，每个人都想提高他们的过程健壮性和可伸缩性，但是如何提高呢？最有效的方法之一是使用一个工具来帮助编排您的发布，并提供可重用的对象。这降低了风险，因为您不再需要为每一个应用程序编写脚本，这就产生了级联效应——不仅您编写的脚本更少，而且您也不必全面维护这些脚本。因此，您在技术和管道的许多层面上承担的风险要小得多。此外，跨所有过程的系统级可见性将会增加——这对您的整个开发生命周期有许多好处。

## **不要只是自动化，还要协调**

许多开发人员错误地认为，因为他们有脚本，所以他们是自动化的。但是要真正自动化，每一个动作都需要自动化，由你的管道驱动。你的批准，你的移交…一切。在整个发布过程中，团队成员经常会发现他们不得不在任务中途停下来请求批准。这只会创建一个中断整个管道的进程。但是，如果你能自动完成所有这些，会怎么样呢？

“ [2018 加速开发运维状态报告](https://cloudplatformonline.com/2018-state-of-devops.html)”中有一段很棒的话谈到了这一点:“与其他团队相比，高绩效团队自动化了更多的配置管理、测试、部署和更改流程。”如果你纯粹从团队的角度来看，高绩效者是那些已经完全自动化了所有过程的人。虽然这听起来肯定是一项艰巨的任务，但最好以敏捷的心态来看待它——这是一个迭代过程。你必须从某个地方开始，同时保持 100%自动化的目标。

你不仅应该自动化，还应该协调你的管道。这很关键。通过自动化和创建可重用的对象，您可以将管道作为服务来使用。想象一下，在您的流程中为每个应用程序重用这个特定的管道，那么您可能有数百个甚至数千个应用程序都使用这个管道，并且所有这些管道下的对象都是可重用的对象。这是一幅漂亮的画，不是吗？

## **创建价值流图**

当你为一个管道创建价值流图时，你要非常全面地考虑邀请谁来创造价值流。包括来自发布管理、开发、部署工程师、团队领导、执行官和基础设施工程师的代表。基本上，任何与你的释放有关系的人都应该在场。

一旦你觉得你对谁受到你的发布的影响有了一个坚实的表示，坐下来，画出整个过程。这包括弄清楚每个脚本做什么。虽然这可能是一个很大的任务，取决于你的管道目前的结构，但实际上有很多机会。例如，您可能会发现有一个应用程序使用一个脚本来完成部署。通常，该脚本会为另一个应用程序复制，依此类推。想象这样做 100 次。您将有 100 个脚本或一个脚本的变体用于您的 100 个应用程序。这是部署一点自动化的一个明显且有益的地方。

这也是了解每个步骤使用什么工具的好时机。当您从一个工具集跳到另一个工具集时，如果没有完整的价值流，就很难全面了解这对您的整体性能有何影响。当你有了这样的图景，你可以开始问自己这样的问题，“我们与之交互的所有这些工具是什么，我们可以集成到管道中？我们是如何处理审批的？”通过包括详细的排序时间表和识别瓶颈，您可以实现一些有效的效率。

最后，创建价值流图让你有机会组织你的脚本。布局整个价值流可以让您了解您正在运行的脚本的种类和数量——无论它们是 CI 脚本、部署脚本还是测试自动化脚本——并以逻辑的方式对它们进行分类。

## **识别冗余依赖和瓶颈**

当然，识别(并有希望纠正)依赖性和瓶颈对于开发管道的任何方面都是一个很好的最佳实践。但是在使用脚本的环境中，它变得更加重要。如果一个应用程序依赖于另一个应用程序，那么编写脚本几乎是不可能的。例如，假设你正试图对两个相互依赖的应用程序进行测试。如果您没有跨两者的正确版本，您就不能测试一个，因为另一个没有跟上速度或者它没有在环境中更新。即使是如此简单的事情也可能会造成破坏，使脚本编写变得非常困难。通过了解您的依赖项和冗余存在于何处，您可以朝着解决它们所呈现的问题迈出第一步。

脚本是简化您的管道的最有效的方法之一，但是它们需要以允许您的组织的应用程序可伸缩和可持续的方式使用。通过遵循上面概述的一些最佳实践，您的组织可以像 pros 一样使用脚本，并避免可怕的“scriptocalypse”

欲了解更多信息，请点击此处观看完整的网络研讨会[。](https://electric-cloud.com/resources/webinars/beyond-the-script-apocalypse/)

-[否则的话壁分支](https://devops.com/author/anders-wallgren/)