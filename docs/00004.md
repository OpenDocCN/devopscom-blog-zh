# 应用程序发布自动化的方法

> 原文:[https://devo PS . com/approages-to-application-release-automation/](https://devops.com/approaches-to-application-release-automation/)

*这是来自[诺里奥](http://www.noliosoft.com/)T5 的菲尔·切利的[客座博文](https://devops.com/guest-posting-guidelines/ "Guest posting guidelines ")*

讨论基于过程的、基于包的、声明性的、命令性的和通用的应用程序发布自动化方法。

应用程序发布自动化是一个相对较新，但正在迅速成熟的 IT 领域。与所有新领域一样，关于应用程序发布自动化到底是什么以及实现它的最佳方式还有很多困惑。有些人抱着以开发人员为中心的心态，有些人接受现代 DevOps 概念，甚至有些人试图将基于服务器的自动化工具应用到应用程序领域。

与许多不同规模、技术、文化和思维方式的公司合作过；当他们选择 ARA(应用程序发布自动化)工具时，以及当他们继续实现他们选择的工具时，我有很多机会去评估各种方法。在这篇简短的博客中，我将讨论每种方法的利弊。

### 基于包的

基于包的自动化是一种最初为自动化服务器层而设计的技术。由于它在这方面的成功，一些人已经尝试将它应用于自动化应用层。包封装了需要在单个服务器上执行的所有更改，并且可以包括需要进行的先决条件检查以及部署后验证。当修补服务器时，这是完全有意义的，被修补的服务器和同一数据中心中的所有其他服务器之间没有依赖关系，因此可以一次在一个包中应用该修补程序(或多个修补程序)的所有所需更改。然后，该软件包无需修改即可应用于所有适当的服务器。在这一层，一个 Windows Server 2008 与下一个 Windows Server 2008 之间几乎没有什么区别，即使顶层的应用程序可能完全不同。这种打包方法的好处是易于回滚。如果需要，该包可以很容易地回滚到原始服务器状态，但另一方面，它将每个服务器视为一个孤岛，不依赖于另一个服务器。它假设该服务器上的所有更改都可以一次性完成。这种类型的自动化是由 BMC Bladelogic 和 IBM Tivoli Provisioning Manager(TPM)等公司提供的。

### 基于声明的

基于声明的自动化与基于包的自动化有着相似的思维模式，但是采用了不同的解决方案。它最初也是出于自动化服务器层的需要，以及随后将其应用于应用层的尝试。使用基于声明的自动化，服务器的期望状态被定义到每个单独的配置项(注册表项、dll、配置文件条目)等。大多数基于声明的工具要求你通过写一段有效的“代码”来描述期望的状态。一些解决方案，例如 Puppet，提供了一个简化的专有 DSL(领域特定语言),但是这并不允许你做所有的事情，所以保留 Ruby 作为备份。这样做的缺点是用户必须学习至少一种编程语言(或者你必须雇用已经掌握这种知识的人)，因此不容易向非开发人员开放自动化。这种方法也有与基于包的自动化相同的缺点，因为它假设每台服务器都可以独立配置，并且一次完成。但是它也有同样的好处，因为自动回滚在概念上要容易得多。

### 基于命令的

基于命令的自动化更为常见，因为这种语言的结构更接近于传统的编程语言(如 Java、C++、Perl 等)。在这种方法中，一种编程语言被用来描述在以特定顺序执行的一系列步骤中需要对目标服务器做什么。Chef 是命令式自动化工具(基于 Ruby 的编程语言)的一个例子。与基于声明的代码一样，所创建的代码(或 Chef 中称为 recipe)仍然非常关注对单个独立服务器进行更改，并且假设这些相同的更改将应用于相同类型的多个服务器。人们对跨多个服务器进行相关更改的理解有限，因为这在服务器层是不需要的。只有当您向上移动到应用层时，这才是重要的。当然，当前可用的产品仍然要求你熟悉或学习一门编程语言来使用它们。

### 通用和定制的方法

通常，人们试图将通用方法(如 Powershell、DOS 批处理脚本、Perl 等)应用到自动化任务中，甚至使用编译语言(如 Java、C++等)编写自己的自动化工具。任何开发人员都会告诉你，他们可以去写一些东西来部署你的应用程序。他们可以使用自己喜欢的语言，而不必使用自动化平台所支持的语言。他们是对的，一个开发团队确实可以编写一个完全有能力的部署工具，但问题是:花时间构建和维护一个部署工具，而不是专注于他们自己的应用程序的开发，真的对公司有利吗？即便如此，他们在实现并行执行、报告和审计、访问和权限控制，以及重要的跨多个服务器同步活动方面仍将面临许多问题。这些方法的初衷还是集中在特定的服务器上，而不是应用程序部署的跨服务器特性。

### 基于流程的

基于过程的自动化是一种不同的方法，它是最近才创建的，用来解决应用程序发布自动化的需求。像 DeployIt 和 UrbanDeploy 这样的 ARA 平台，当然还有我们自己的工具 Nolio 都采用了这种方法。这些工具旨在支持当前现有的应用程序部署流程，这些流程通常由运营商手动完成。重点是流程，这些工具允许操作员以可视化的方式定义它们，并理解应用程序部署的跨服务器特性。假设您需要在应用程序的 web 服务器上做一些事情，然后是应用程序服务器，然后是更新数据库中的表，然后是对应用程序服务器的第二次更改，最后是对 web 服务器的另一次更改。使用以服务器为中心的方法(如上所述)，很难协调多个不同服务器上的活动，很难同步变化，使它们在彼此相关的正确时间发生，甚至很难在这些服务器之间传递信息。对于基于流程的系统，这一点非常简单——您可以定义不同的服务器类型，将相关步骤放到每个服务器上，并绘制链接来定义同步点(即，只有在应用服务器步骤完成后，才执行数据库步骤)。

[![process-based-automation](../Images/727e1e6d518161ed02ed4ece41ff2030.png)T2】](https://devops.com/wp-content/uploads/2014/01/process-based-automation.png)

图 1–Nolio 部署流程的屏幕截图，包括 4 种不同服务器类型上的活动。

上面提到的问题，如并行执行、跨服务器同步等。应该已经由 ARA 平台处理了，而不是必须在更通用的平台上创建。从上图可以看出，ARA 平台的跨服务器同步就是在一种服务器类型上的动作和另一种服务器类型上的动作之间建立依赖关系。现在，在“存储库节点”上的“准备包分发”完成之前，“应用程序服务器类型”上的“停止应用程序”操作不会运行。

除此之外，基于过程的自动化带来了以下好处:不需要修改部署过程来适应自动化工具不能跨多个服务器同步活动的情况，从而确保保持手动和自动化方法之间的一致性；已定义的流程可用作如何完成部署的文档，因为它本身可读性很强；有一个详细的相关审计跟踪，因为该过程与如何手动完成部署是内联的，并且因为该过程遵循预期的步骤，所以诊断问题要容易得多。

你可以在 Nolio 的博客网站上阅读更多关于应用发布自动化的文章。