# 2018 年最佳:5 款值得一试的开源 SIEM 工具

> 原文：<https://devops.com/5-open-source-siem-tools-worth-checking-out/>

在我们结束 2018 年之际，我们 DevOps.com 想要强调今年最受欢迎的五篇文章。以下是我们为期一周的 2018 年最佳系列的第二部。

安全信息和事件管理(SIEM)是 IT 安全的基石。所有其他网络解决方案都只是流入企业 SIEM 的数据流。并非所有 SIEMs 都是生而平等的，它们的功能可能会有很大差异。根据您的需求选择正确的方法可能意味着发现安全漏洞和成为另一个统计数据之间的差别。

SIEM 解决方案是安全事件管理(SEM)系统和安全信息管理(SIM)系统的组合。SEMs 实时监控服务器和网络，而 sim 存储数据。

SEMs 和 SIMs 都提供分析。SEM 专注于实时事件关联、警报和那些在电影中可能会遇到的花哨的网络操作中心(NOC)“出事了”仪表盘。SIMs 专注于大量日志的批量数据计算分析(BDCA)。

换句话说，SEM 旨在告诉你什么时候事情会发生，sim 旨在发现 SEM 没有发现的微妙攻击。将这两者合并成一个 SIEM 解决方案似乎是一个自然的选择。

* * *

**相关内容:**

[商业开源的价值](https://devops.com/the-value-of-commercial-open-source/)

[开发人员如何采取更主动的安全措施](https://devops.com/how-developers-can-take-a-more-proactive-approach-to-security/)

* * *

SIEM 堆栈通常由至少三个组件组成，分别用于数据收集、数据存储和数据分析。相关数据通常是日志文件，但也可能是网络流量或其他实时数据馈送。

市场上有许多 SIEM 工具，包括开源的和商业的。随着 DevOps、容器和其他现代应用程序开发方法的兴起，开源解决方案重新引起了人们的兴趣。让我们来看看一些顶级的开源 SIEM 工具。

## OSSEC

OSSEC 是一种流行的基于主机的入侵检测系统(IDS ),可与 Linux、Windows、MacOS 和 Solaris 以及 OpenBSD 和 FreeBSD 配合使用。OSSEC 由两个组件组成:主机代理(负责收集日志)和主 OSSEC 应用程序(负责处理日志)。)

还有一个现在已被废弃的 GUI，但是由于其他开源解决方案在数据可视化方面做得更好，OSSEC 项目推荐使用这些解决方案。流行的开源数据可视化工具包括 [Kibana 和 Grafana](https://logz.io/blog/grafana-vs-kibana/) 。

OSSEC 直接监控主机上的许多参数。这包括日志文件、文件完整性、rootkit 检测和 Windows 注册表监控。OSSEC 还可以执行其他网络服务的日志分析，包括大多数流行的开源 FTP、邮件、DNS、数据库、web、防火墙和基于网络的 IDS 解决方案。OSSEC 还可以分析大量商业网络服务和安全解决方案的日志。

OSSEC 有许多警报选项，可以用作自动入侵检测或主动响应解决方案的一部分。OSSEC 有一个原始的日志存储引擎。默认情况下，不会保留来自主机代理的日志消息。一旦分析完毕，OSSEC 就会删除这些日志，除非 OSSEC 管理器的 *ossec.conf* 文件中包含了`<logall>`选项。如果启用了此选项，OSSEC 会将来自代理的传入日志存储在一个文本文件中，该文件每天都会轮换。

OSSEC 算“完整”还是“适当”的 SIEM 是众多互联网辩论的来源。OSSEC 做的是 SIEM 的艰苦工作:收集数据并进行分析。OSSEC 是许多其他 SIEM 解决方案的核心，是许多应用程序堆栈的一部分，这些应用程序堆栈将 OSSEC 与更高级的长期日志保留系统和高级可视化功能结合在一起。

## 鼻息声

Snort 是一种流行的基于网络的入侵检测系统。基于网络的入侵检测系统与基于主机的入侵检测系统完全不同，基于主机的入侵检测系统位于单独的服务器或端点上，而基于网络的入侵检测系统则位于网络的更远处，扫描它们能看到的所有流量。

Snort 的目的是嗅探、记录和执行网络流的实时分析。它可以向控制台显示实时数据包流，将数据包转储到日志文件或执行分析。

Snort 依靠输出插件来决定如何以及在哪里存储它生成的信息。Snort 可以将这些信息存储在平面文本文件中，输出到数据库、Unix 套接字、寻呼机或手机以及任何其他目的地。

Snort 有许多过滤和模式匹配选项。这意味着 snort 不必显示、记录或分析通过网络链路的所有数据包。它可以将自己限制在与特定主机或匹配的特定模式相关的信息上，随着单个网络链路上 100Gbps 的网络吞吐量变得越来越普遍，这一点的效用也越来越大。

配置 Snort 需要仔细规划。将价值 100Gbps 的数据包转储到一个平面文本文件中并不是最佳方案，而且大多数组织也负担不起将这种数据转储到一个基于云的公共日志存储库中。明智地使用 Snort 的过滤和分析功能并结合输出插件，才能使 Snort 变得实用。

通过一组严格配置的警报，Snort 将警报直接发送到手机的能力变得很有意义。可以使用一组更广泛的过滤器将数据传递给长期存储库，以便由另一个工具进行更深入的分析。

与 OSSEC 一样，Snort 依赖第三方解决方案来执行可视化。作为最早的基于网络的入侵检测解决方案之一，有许多解决方案(开源的和商业的)只是为了可视化 Snort 数据而存在，这使得缺少内置的可视化系统变得有些无关紧要。

与 OSSEC 一样，Snort 作为 SIEM 解决方案的资格有些值得商榷。Snort 收集数据并进行分析，是更完整的 SIEM 解决方案的核心组件。Snort 也是许多添加日志保留和高级可视化功能的应用程序栈的一部分。

在数据中心 SIEM 需求的宏伟计划中，Snort 和 OSSEC 合作填补不同的空缺并不罕见。看到它们独立部署也是很正常的，尤其是作为云原生应用的一部分，在这种情况下监控需求可能会更窄。

Suricata 是一个竞争性的基于开源网络的入侵检测系统，经常被用来代替 Snort。

## 麋鹿

ELK stack 可以说是可用的最流行的开源 SIEM 工具，尽管像 OSSEC 和 Snort 一样，关于 ELK stack 本身是否有资格作为 SIEM 还有争论的余地。

ELK stack 由开源产品 Elasticsearch、Logstash 和 Kibana 组成。Logstash 是一个接收来自几乎任何来源的日志数据的接收器。它可以过滤、处理、关联和增强遇到的任何日志数据。

Elasticsearch 是一个存储引擎，是该领域目前可用的最佳解决方案之一。Kibana 是等式的可视化部分，它无疑是开源社区迄今为止最好的可视化系统之一。

Logstash 是 ELK 栈的一部分，它使用输入插件来收集日志；然而，它也可以接受来自更专门构建的解决方案(如 OSSEC 或 Snort)的输入。结合起来，ELK Stack 的日志处理、存储和可视化功能在功能上是无与伦比的。该解决方案功能强大，但这种强大是以复杂性和高总体拥有成本为代价的。像 [Logz.io](https://logz.io) 这样的云产品提供了一个托管的 ELK 替代方案。

ELK 堆栈构成了越来越多的商业 SIEM 产品的核心。这些解决方案带来了在维护、配置和管理堆栈中的应用程序方面的专业知识。他们还可能为 Logstash 提供比原生开源解决方案更现成或更易于设计的过滤器。这两种方法都提供了显著的附加值。

## 序幕

[Prelude](https://www.prelude-siem.org/) 是一个 SIEM 框架，它统一了各种其他开源工具。它是同名的[商业工具](http://www.prelude-siem.com/en/products/preludesiem/)的开源版本。Prelude 旨在填补 OSSEC 和 Snort 等工具遗漏的角色。

Prelude 接受来自多个来源的日志和事件，并使用[入侵检测消息交换格式](https://www.ietf.org/rfc/rfc4765.txt) (IDMEF)将它们全部存储在一个位置。它提供过滤、关联、警报、分析和可视化功能。与商业产品相比，Prelude 的开源版本在所有这些功能上都有很大的局限性。

## OSSIM

如果麋鹿不是最受欢迎的 SIEM，那么 [OSSIM](https://www.alienvault.com/products/ossim) 很可能赢得桂冠。OSSIM 是 Alien Vault 统一安全管理产品的开源版本，是一个类似 Prelude 的框架。OSSIM 将其本机日志存储和关联功能与众多开源项目相结合，构建了一个完整的 SIEM。

OSSIM 包含的开源项目有 FProbe、Munin、Nagios、NFSen/NFDump、OpenVAS、OSSEC、PRADS、Snort、Suricata 和 TCPTrack。包含 OpenVAS 是特别有趣的，因为 OpenVAS 通过将 IDS 日志与漏洞扫描器结果相关联来用于漏洞评估。

像 Prelude 一样，开源 OSSIM 不像它的商业兄弟那样功能丰富。这两种解决方案都适用于小型部署，但在大规模部署时会遇到严重的性能问题，最终促使组织转向商业产品。例如，开源版本的 OSSIM 中的日志管理功能实际上是不存在的。

## 结论

完整的 SIEM 解决方案包括从各种数据源收集信息、长期存储数据、对数据进行分析并以有用的方式可视化的能力。没有明确的开源赢家可以提供所有的功能。

选择开源 SIEM 时，您要么必须使用旨在推动组织投入商业解决方案怀抱的功能和性能有限的解决方案，要么必须结合多个开源项目来实现您的目标。

以 ELK 堆栈为例。ELK 堆栈本身就是一个高质量的 SIEM 解决方案。它的输入过滤器包括其他开源解决方案无法比拟的公共云基础设施监控功能。

也就是说，更专用的收集和分析工具，如 [OSSEC](https://practicalassurance.com/blog/ossec-elk-stack-integration/) 和 [Snort](http://blog.snort.org/2017/11/snort-30-with-elasticsearch-logstash.html) ，在处理内部解决方案时会强大得多。这些解决方案可以结合使用。OSSEC 和 Snort 可以支持 ELK 堆栈，创建更完整的解决方案，满足大多数组织的需求。

开源 SIEM 解决方案(全部或部分)功能多样且强大。它们需要经验、专业知识，最重要的是需要时间来正确部署。正是由于这个原因，商业产品主宰了 SIEM 领域，即使开源工具是这些商业产品的核心。

让您的 SIEM 解决方案的 80%为您处理，这比您必须自己完成所有工作要好。商业解决方案处理安装、基本配置，并为最常见的用例提供过滤器、关联配置和可视化设计。不要低估这些商业功能的价值:在今天的数据中心，要监控的东西似乎是无限的，我们没有人有时间手动配置应用程序来监控所有的东西。

— [丹尼尔·伯曼](https://devops.com/author/daniel-berman/)