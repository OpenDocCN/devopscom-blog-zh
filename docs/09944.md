# Apache Druid 在现代数据分析中的作用

> 原文:[https://devo PS . com/Apache-druids-role-in-modern-data-analytics/](https://devops.com/apache-druids-role-in-modern-data-analytics/)

从 Twitter 和网飞到 Salesforce 和 Confluent，世界领先的数字企业的开发人员正在构建现代分析应用程序，以创建数字工具，为数百甚至数千名并发用户提供实时分析服务。

更仔细地观察这些应用程序所做的事情，可以发现一些关键的、战略性的技术决策。特别是，为什么开发人员越来越多地转向 [Apache Druid](https://druid.apache.org/) 而不是无数的其他数据库？

总的来说，他们希望 Druid 构建能够实现一系列目标的应用，包括创建大规模运营可见性、面向客户的分析、快速深入探索和实时 ML 管道。让我们依次来看一下其中的每一项:

### 规模化运营可见性

为运营可见性构建应用程序可以包括广泛的用例，如产品分析、数字运营、可观察性、欺诈检测和物联网。在每种情况下，开发人员都需要最小化事件创建和洞察时间之间的差距。

从技术角度来看，有几个数据库可以实时分析事件，包括 Apache Flink 或 ksqlDB 这样的流处理器，[influx db 或 TimeScaleDB 这样的时序数据库](https://devops.com/?s=time-series+database)，以及 Redis 这样的键值存储。问题是，所有这些技术都有相同的固有分析局限性:它们无法在任何有意义的规模上有效处理 OLAP 式的查询。

例如，如果有问题的应用程序要求分析过去一个月的时间和非基于时间的维度，假设每秒钟摄入 100 万个事件，这将相当于超过 2.6 万亿个事件。任何支持流接收的数据库都可以查询当前状态(抛开处理这种规模的接收的挑战不谈)，并且在一定程度上可以查询数字和计数器的基本集合。然而，如果应用程序需要对所有这些事件进行聚合，对非基于时间的属性或高并发性进行“分组”,就会出现困难。使用错误的数据库会让用户在等待结果时看着“死亡的转轮”。

在这种情况下，开发者转向阿帕奇德鲁伊。一个真实世界的例子解释了如何:Salesforce 工程师使用 Druid 构建了一个分析应用程序来监控他们的产品体验。该应用程序使工程师、产品负责人和客户服务代表能够在实时日志中查询维度、过滤器和聚合的任意组合，以进行性能分析、趋势分析和故障排除。因此，他们的查询结果会在几秒钟内返回，每天会接收数十亿甚至数万亿的流事件。

### 面向客户的分析

从表面上看，Twitter、Forescout 和 Atlassian 提供的技术没有太多共同点。然而，透过表面看，他们都将分析应用于不仅仅是内部决策。他们还创建了分析应用和流程，作为增值服务或核心产品供应的一部分，为客户提供强大的洞察力

这对其他组织有什么启示？在为外部用户构建分析时，必须解决一系列完全不同的技术挑战。虽然并发性显然是一个关键的考虑因素，但是数据库也应该能够轻松地支持当前和未来的用户增长。问题是，并发还必须经济地交付，否则它会对基础设施成本产生巨大影响。

类似地，交付良好的交互体验依赖于亚秒级的查询响应性能——这几乎在任何地方都已成为用户的最低要求。Druid 提供了开发人员和用户期望的性能，而不是与 PostgreSQL 或 Hive 或任何其他分析数据库竞争来满足大规模的性能需求。

以 Confluent 为例，这是一个流行的事件流平台。他们用 Druid 构建了基于云的监控服务——Confluent Health+。在最初使用了不同的数据库后，他们发现随着数据量的增长，他们的传统管道很难跟上数据接收和查询负载。通过切换到 Druid，他们已经能够创建令人印象深刻的用户体验，这是任何地方的开发人员都关注的。

### 快速向下钻取探索

一般来说，报告的主要作用是满足一个简单的需求:以可消费的形式交付数据。然而，组织越来越多地寻求的是更深层次的洞察力和理解，以显示事情发生的原因。他们可以获取这些信息，并将其应用于广泛的可能性，例如解决、预测或防止未来的问题或机会。

解决这些“为什么？”问题意味着必须以极快的速度分析数据，以揭示根本原因。虽然当所讨论的数据集很小时，这是一个简单的命题，但当处理从今天的大容量来源(如云服务、点击和物联网/遥测)提取的数据时，底层数据库必须将几个到数百个维度与具有数十亿到数万亿行的高度基数数据相关联。这提出了一个更加困难的挑战。

事实上，当大规模分析数据时，全表扫描实在太慢了。加剧问题的是，用于提高性能的典型查询整形技术具有昂贵的折衷:

再次查看真实世界的用例有助于展示 Apache Druid 在这种情况下的作用。例如，网络安全公司 HUMAN 的开发人员使用 Apache Druid 构建了一个用于检测互联网机器人的分析应用程序。以前，他们的云数据仓库速度太慢，无法满足快速挖掘海量 web 流量的需求。如今，他们基于 Apache 的应用程序使他们的数据科学家能够即时聚合和过滤数万亿次事件，这意味着他们可以对异常情况进行分类，并训练他们的机器学习模型来检测实时恶意活动。

### 实时 ML 管道

对于许多人来说，分析等同于查看通过 UI 呈现的合成数据集，如图表、图形、报告或仪表板。然而，新的运营工作流越来越多地完全自动化，无需任何人工干预或数据可视化。

谷歌地图是这种用例的一个例子，因为它根据实时和历史交通流量和模式优化路线。另一个例子是 Reddit 使用 Apache Druid 在新访问者到达应用程序的几毫秒内提供实时广告投放。在这种背景下，没有数据可视化来解释；它已经被通过推理得出的自动化决策所取代。这些性能需求特别适合 Druid 提供的功能。

在越来越多的高要求用例中，开发人员正在采用 Druid 在他们的应用程序中构建基于推理的功能。从诊断、建议到自动化决策，当今的组织需要高基数的即时查询响应，以及大规模、实时的高维度事件数据。对于注重创新、服务质量和竞争优势的企业来说，实现这样的绩效水平变得越来越重要。