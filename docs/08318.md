# 保护微服务与整体应用

> 原文：<https://devops.com/securing-microservices-vs-monolithic-apps/>

**保护微服务与整体应用的新要求**

企业正在从单一应用程序迁移到微服务，希望加快软件部署并提高可扩展性。在这些过渡中，安全性有时会被忽略。

像认证用户和使用 SSL 这样简单的最佳实践仍然很重要。但是团队需要考虑两种架构之间的重要差异，以确保不会无意中引入新的风险。

当您开始从整体迁移到微服务时，其中一些问题可能看起来相对无关紧要。但是，如果不加以解决，它们会造成严重的安全漏洞，降低性能，并导致技术债务。

要考虑的一些最重要的差异包括攻击面的数量和大小，以及团队管理业务逻辑安全性的方式和位置。团队还需要考虑在单独的容器或机器中运行的微服务之间通信增加的额外复杂性。当应用程序状态存储在外部时，也需要解决新的问题。

## **1。一个较大的攻击面对多个较小的攻击面**

最大的区别在于攻击面的大小和数量。根据定义，单一应用程序是具有单一攻击面的单一应用程序。相比之下，微服务架构将相同的功能分布在多个独立运行的微服务应用中，每个应用都有自己的攻击面。

单个单片应用程序的受攻击面也比每个微服务大，因为应用程序要控制的责任要多得多。相比之下，每个微服务的攻击面要小得多，因为他们能做的事情有限。在传统的 [web 应用安全](https://devops.com/web-application-security-is-not-api-security/)中，web 应用防火墙可以保护整个应用。然而，对于微服务安全性，团队需要考虑使用适应性更强的防火墙来保护到每个微服务的连接。

## **2。管理业务逻辑安全**

Web 应用程序防火墙提供了第一道安全防线来跟踪哪些客户端正在请求数据，并确保它们拥有适当的凭证。单体应用程序通常使用 servlet 添加一个额外的业务逻辑安全层。这在应用程序内部执行逻辑过滤，以确保请求在传递给适当的组件之前是合理的。

因此，单一的应用程序组件可以在假设 servlet 已经在应用程序编程接口(API)级别验证了请求的情况下运行。servlet 可以跟踪谁在调用应用程序，并阻止超出正常行为范围的请求。一个微服务很少知道其他微服务之间发生了什么。它们通常被设计为独立于周围一切的细节而运行，这意味着业务逻辑级攻击更容易持续下去。

## **3。服务对服务的复杂性**

在传统的 monolith 中，消息在应用程序的功能之间传递。在微服务架构中，这种流量在多个服务之间传递，这些服务可能位于一个公共防火墙或单独的防火墙之后。

当消息在公共防火墙后面的服务之间传递时，开发人员可能会错误地认为这些通信是安全的。但是由于微服务的动态特性，有时这些通信是通过更宽的网络进行的。当数据以纯文本格式在应用程序之间传递时，可能会出现安全问题。

团队应该考虑在数据在微服务之间传输时对其进行加密，然后在存储静态数据时对其进行加密。这种加密要求团队考虑创建一个与配置和管理微服务相结合的加密流程。每个服务都需要提供一个公共证书和私有密钥。还需要一种方法，用于在服务退役或受到威胁时撤销证书并颁发新的证书。

## **4。认证延迟**

微服务还可以增加执行交易所需的身份验证步骤。在传统的应用程序安全中，API 安全服务只需要保护客户端和服务器之间的一个链接。对于微服务安全性，需要额外考虑保护从客户端到每个微服务的连接以及它们之间的调用。这增加了请求和处理安全令牌所需的安全步骤的数量。除非有效地设计这一过程，否则每个请求都会增加延迟并降低性能。

假设这些服务在安全的虚拟专用网络上通信，一些组织可能会跳过其中的一些步骤。然而，如果网络遭到破坏，这可能会增加应用程序的漏洞。另一种方法是实现更好的 API 安全策略。

## **5。不变性**

单一应用程序将数据作为其操作的一部分进行管理。相比之下，微服务的架构使得所有数据都存储在微服务的外部，这被称为不变性，因为服务不会改变状态。这使得在不影响整个应用程序的情况下增加新的实例或终止正在运行的实例变得更加容易。但是因为微服务本身是不变的，所以一个外部进程需要维护一个允许哪些微服务与他人对话的列表。这些需要集中管理，然后自动推出或引入每个微服务。

另一个挑战是数据完整性。在传统的应用程序中，可以在内部监控事务的状态；如果一个步骤无法完成，整个事务可以回滚。在微服务架构中，这种状态管理需要外部管理。

## **6。要监控的更多服务**

传统的基于基础设施的监控旨在提供终端和服务器安全性。微服务以更精细的粒度级别在服务之间生成更多流量，这使得通过指标、日志和跟踪来自动实现应用程序可观察性变得更加困难。这对于衡量运行状况来说已经足够困难了，对于跟踪安全状况来说就更难了。

安全设计人员面临的另一个挑战是确保跨微服务生成的应用程序可观察性数据的一致性。至少，安全需要良好的日志记录并集成到事件响应系统中，以提醒安全分析师注意微妙和缓慢的安全违规的可能性。更复杂的方法可以将这些更丰富的数据集与机器学习相结合，以帮助检测和阻止攻击，而不会给团队带来误报负担。

## **规划新的安全态势**

这些安全问题都不应该成为过渡到微服务架构的障碍。但是，随着企业开始扩大他们的微服务实施，这些问题将变得更加复杂。提前做一点规划可以减少大量返工的需要。

安全工具，如 [Traceable 的防御人工智能](https://www.traceable.ai/)正在兴起，以更加自动化的方式应对这些挑战。关键在于平衡丰富的可观测性数据和机器学习的适当集合，以及对快速发展的 API 威胁前景的深刻理解。