# 边缘平台上的实时协调

> 原文：<https://devops.com/harmonizing-real-time-on-edge-platforms/>

边缘计算平台位于实时世界和数字企业之间的边界。如果云中的分析推动可靠的业务决策，来自边缘的不间断、未损坏的数据是必不可少的。最好的方法是什么:使用 Linux，一个 RTOS(实时操作系统)，一个管理程序或其他用于边缘平台的东西？让我们谈谈 edge 平台上的实时协调，并介绍 Linux 基金会的 LF Edge 系列中的一个新的基础项目。

## 实时性和确定性

实时仅仅意味着事件在真实世界中展开时被捕获、标记和处理。这种节奏可以是秒、毫秒或微秒，取决于事件的数量和发生频率，以及任务和算法如何保持控制。三个操作系统特性决定了实时执行的速度:优先级、中断响应时间和上下文切换时间。

*优先级*确保任务在需要时获得资源。当较高优先级的任务请求服务时，较低优先级的任务应该抢占先机。拒绝让位于先发制人的任务可能会打乱优先级方案，导致错过截止日期。

*中断响应时间*测量从事件通过硬件中断请求服务到处理程序任务执行的延迟时间。实时硬件平台通常将高优先级事件放在硬件中断上，以实现最快的抢占。

*上下文切换时间*是工作中比较软的调度。它测量处理控制从一个执行实体到另一个执行实体的变化时间，根据需要交换出包括寄存器、高速缓存和内存在内的资源。

确定性意味着行为中没有惊喜。实时事件发生得越快，系统工作得越努力，非决定论就越有可能浮出水面。即使在大多数情况下实时性能已经足够，但是冒险进入虚拟内存分页或网络活动的爆发可能会在不恰当的时间出现。

## **“硬”对“软”**实时

这就是为什么大多数人认为实时对于一个快速的、确定性的操作系统来说是“困难的”。RTOS 平台优化了内核，只在它周围构建了必要的东西，为许多任务提供了严格的、有时是数学上证明了的调度。

“软”实时更宽容。在快速处理器上，与执行窗口相比，中断响应时间很小。如果上下文切换时间有足够的余量，非确定性系统可以以较慢的速度跟上实时事件。Linux 虽然不是确定性的，但可以通过最小化包和调整内核以获得更好的优先级来处理一些实时需求。

Linux 还受益于较轻的上下文切换。最初，Linux 中的执行实体是资源密集型进程。现在，线程可以用少得多的切换开销来处理任务。POSIX 线程通过在 Linux 和 RTOS 环境之间的可移植性标准化了这种方法。

线程有多快？根据 Eli Bendersky 最近的[合成线程基准测试，在理想情况下，在具有足够内存、高速缓存和存储的服务器级平台上切换 10，000 个线程可以在 2 微秒的范围内完成。Eli 指出，他的测试环境比许多 edge 硬件平台提供的内存更多，但大多数 edge 应用程序也不需要那么多线程。](https://eli.thegreenplace.net/2018/measuring-context-switching-and-memory-overheads-for-linux-threads/)

因此，软实时的界限已经转移到新的领域，使得硬实时和软实时之间的权衡变得更加模糊。

## 虚拟机管理程序**和流程编排**

如果您的 DevOps 团队致力于 RTOS，您可能会放弃一些熟悉的功能，并有一个学习曲线要处理，但您会得到硬实时性能的保证。如果您使用 Linux，您可以获得您习惯的工具和编码实践，但是随着代码的堆积，软实时性能可能会成为一个问题。

RTOS 企业网络平台的领导者也注意到了这一点。最近，他们转向裸机方式的虚拟机管理程序。虚拟机管理程序可以获得环境协同工作的优势，因此团队不会被迫选择非此即彼的操作系统。如果边缘应用需要某种形式的认证，例如在医疗、工业或国防应用中，这一点尤其重要。认证代码可以在 RTOS 上划分，而 Linux 可以并行运行。

Linux 提供商更多地转向编排层和容器。这是一个应用程序焦点，它加快了部署，具有更高的可扩展性和更少的硬件依赖性。它还通过在任何地方使用相同的应用程序部署策略，更快地将优势带入企业。更多的代码意味着更多的确定性风险。

在这个目标相互竞争的环境中，融合是一个微弱的希望，但是一种新的方法为软件重用和快速部署提供了一条途径。

## **调和**边缘

Linux 基金会活跃于物联网开发的各个领域，从泽法开源 RTOS 到各种嵌入式 Linux 项目。LF Edge initiative 的最新项目之一是一个以一致、开放的方法为目标的混合部署模型的基础。

[Project EVE](https://www.lfedge.org/projects/eve/)(Edge 虚拟化引擎的简称)同时支持容器、集群、虚拟机和单核。它是一个超薄裸机运行时，提供硬件信任根、设备资源管理以及软件更新和补丁功能。EVE 可以在虚拟机或容器中托管任何应用程序组合，包括在虚拟机中运行 RTOS 及其应用程序。它甚至可以将 CPU 和 GPU 核心分配给特定的应用程序，以增强确定性。

EVE 的路线图是支持 [ACRN 虚拟机管理程序](https://projectacrn.org/)(另一个 LF Edge 项目)，并为更小的嵌入式 Edge 平台缩减 EVE 运行时。当实时要求变得更加困难，并且虚拟机管理程序加上 RTOS 变得有意义时，这些努力是必不可少的。对于更软的实时环境，EVE 正在添加对 Kubernetes K3S、Docker Compose、用于公共云和网格网络的 VPN 的支持，以支持边缘平台之间的数据流。

虽然这个项目还很年轻，但 EVE 为在边缘工作的 DevOps 团队带来了巨大的希望。我们期待看到一些实时的基准测试；它很可能像今天的 Linux 一样处理软实时需求。通过将一系列不同的方法整合到一个基础中，EVE 正在边缘平台上创建一个实时空间，无论团队来自哪个开发视角。