# 九个常见的操作错误(以及如何防止它们)

> 原文:[https://devops.com/nine-common-ops-mistakes-prevent/](https://devops.com/nine-common-ops-mistakes-prevent/)

对于任何成长中、充满活力的组织来说，不断的变化都是现实。接受变化有助于我们快速创新和学习，但同时，管理不善的变化会造成不稳定和停机。问任何一位工程师，他们系统停机的首要原因是什么，他们会说是变化——软件变化、网络变化、配置变化。虽然通过在完全静态的系统上工作来避免这种不稳定性是很好的，但为了应对现代技术业务的需求，运营团队必须学会通过在危及系统之前防止常见的运营错误来更好地管理变化。

运营工程经理 Arup Chakrabarti 和我在 PagerDuty 的同事[拜访了](https://www.google.com/url?q=http%3A%2F%2Fwww.heavybit.com%2Flibrary%2Fvideo%2F2014-06-03-arup-chakrabarti&sa=D&sntz=1&usg=AFQjCNEtcZXorDqNPyO1Itbe1fgZIf0RHw) Heavybit Industries，这是一个面向专注于开发人员的企业家的社区工作空间，讨论了运营团队可能犯的最大错误以及如何避免这些错误:

**1。基础设施设置出错**

*   创建帐户
    许多人在建立企业基础设施部署时使用个人帐户。相反，使用公司地址创建新帐户，以确保一致性。
    小心保存密码。将它们保存在您的 Git 存储库中可能需要您在以后清除整个 Git 历史。最好将密码保存在配置管理中，以便在需要时插入。
*   选择工具
    新部署的另一个重要考虑因素是明智地选择工具。尽可能长时间地利用 PaaS 工具，以便您可以专注于获取客户，而不是构建基础架构。不要害怕使用像 Java 这样“无聊”的产品。成熟可靠的技术可以让你做一些真正酷的事情。

**2。设计不良的测试环境**

*   将测试和生产分开
    不要将测试和生产环境混在一起。请确保使用不同于您在生产中使用的托管和提供商帐户来设置测试环境。同时，确保您的测试环境尽可能地类似于生产基础设施。
*   虚拟机
    您正在执行本地开发吗？这是无法回避的:应用程序在本地机器和生产环境中的运行方式会有所不同。为了尽可能接近地模拟生产环境，请使用类似于 vagger 的工具创建虚拟机。

**3。不正确的配置管理**

*   基础设施即代码
    本质上，基础设施即代码是以这样一种方式构建基础设施的过程，这种方式可以快速一致地加速或减速。无论您的基础架构在哪里运行，服务器配置都会带来问题，因此您必须准备在尽可能短的时间内恢复您的服务器。 [Ansible](https://www.ansible.com/home) 和 [Chef](https://www.chef.io/chef/) 这两个工具使得基础设施即代码部署对于运营团队来说变得超级简单。无论你使用什么工具，作为一个经验法则，最好限制你正在使用的自动化软件工具的数量。每一个都是基础设施中的事实来源，这意味着它也是一个故障点。

**4。部署方式错误**

*   一致性很重要
    每段代码都必须以尽可能相似的方式部署。标准化部署实践需要时间和精力，但是消除可变性和潜在的人为错误是成功的关键。这也适用于回滚——任何拥有部署权限的人都应该能够轻松回滚他们发布的任何代码。

*   协调您的工作
    强大的自动化软件当然有助于增强一致性，但是自动化工具只适合大型部署。当你开始时，Arup 建议使用 Git 和编排工具来运行开发，例如 Rails 的 [Capistrano](http://capistranorb.com) ，Python 或 Ansible 的 [Celery](http://www.celeryproject.org) ，编排和配置管理的 [Salt](https://saltstack.com/community/) 。

**5。未正确处理事件**

*   制定流程
    创建并记录事故管理流程是绝对必要的，即使该流程并不完美。也要确保持续审查事故管理文档。应根据事件的严重性来定义事件响应—轻微延迟和全面停机事件具有不同的响应工作流和预期。

*   让每个人都随叫随到
    公司拥有专门的随叫随到团队越来越不常见——相反，在停机时，每个接触生产代码的人都应该可以联系到。这就需要一个平台，可以用不同的方式通知不同的人。真正重要的是在正确的时间找到正确的人。

**6。忽视监控和报警**

*   从任何地方开始
    你用来监控的特定工具没有把某样东西放在适当的地方重要。在 PagerDuty，我们使用 [StatsD](https://github.com/etsy/statsd/) 与 [Datadog](https://www.datadoghq.com) 协同工作；像 [Nagios](http://www.nagios.org) 这样的开源工具同样有效。对于应用程序性能管理，您可能还会考虑像 [New Relic](https://newrelic.com) 或 [AppDynamics](https://www.appdynamics.com) 这样的工具。有数百种很好的监控工具，但重要的是要准备好一些东西，并确保你对那些对你很重要的异常发出警报。

*   外部检查
    如果正常运行时间对你很重要(让我们面对现实吧，它总是如此)，确保你也在对你的服务或网站进行某种外部检查，使用像 [NodePing](http://nodeping.com) 或 [Ghost Inspector](https://ghostinspector.com) 这样的工具。

7 .**。未能维护备份**

*   系统化备份和恢复
    就像监控和警报一样，备份数据是不可协商的。安排定期备份到 S3 是当今的行业标准做法，并且总是比您认为需要的多一种备份方法。如果不能从备份中恢复，备份也是无用的！至少每月一次，尝试将您的生产数据集恢复到测试环境中，以确认您的备份按设计运行。

**8。忽略高可用性原则**

*   “多”是关键。每一层都有多个服务器、多个无状态应用服务器和多个负载平衡器是显而易见的。只有通过多种故障转移选项，您才能真正说您已经针对高可用性进行了优化。
*   数据存储设计也很重要。
    借助 Cassandra 等多主控数据集群，单个节点可以被移除，完全不会对客户造成影响。因此，集群数据存储非常适合快速部署环境。

**9。落入常见的安全陷阱**

*   仅仅依靠 SSH
    在你的数据库服务器和负载平衡器上使用网关机器而不是 SSH。如果您怀疑有入侵，您可以通过这些网关运行代理并锁定流量。

*   不配置个人用户帐户
    当一名员工离开您的组织时，能够方便地撤销他或她的访问权限是件好事。但是还有其他的原因来为你的各种工具设置用户帐号。有人的笔记本电脑可能会丢失。个人可能需要重置密码。撤销或重设一个用户密码比撤销或重设一个主帐户密码要容易得多。

*   未能在开发中激活加密将加密作为开发周期的一部分有助于您在开发早期发现与安全相关的错误。另外，迫使开发人员不断考虑安全性是一个很好的实践。

这些只是运营团队在管理变更时可能犯的一些错误。你可能会遇到数以百万计的错误，但这九个错误往往是最常见的，即使是在亚马逊和网飞这样的大公司。通过实施这些最佳实践，您将帮助您的团队有效地管理变更。