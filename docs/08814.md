# 用 Moderne 自动重构

> 原文：<https://devops.com/automated-refactoring-with-moderne/>

乔纳森·施奈德和奥尔加·昆兹奇是西雅图初创公司 Moderne 的联合创始人。Moderne 在 2021 年 7 月获得了 470 万美元的种子资金，用于将 OpenRewrite 商业化，open rewrite 是 Schneider 在网飞大学时开始的一款开源代码(最初是 Java)自动化重构工具。 [Moderne 的技术](https://devops.com/microservices-adoption-and-the-software-supply-chain/)减少了软件修复的繁琐和时间；这是当今云原生开发领域的一个大问题。下面是视频，后面是对话的文字记录。

[https://player.vimeo.com/video/569009129](https://player.vimeo.com/video/569009129)

***播音员:*** 这是数字无政府主义者。

***艾伦·希梅尔:*** 嘿，大家好。欢迎来到 TechStrong 电视的另一部分。我们有一家新公司要向你详细介绍，我们有两位联合创始人会告诉你这一切。这也是一个伟大的开源故事。让我向你们介绍——我会尽力不搞砸——奥尔加·昆兹奇，昆兹奇，昆兹奇——魅力的三倍——和乔纳森·施耐德。我想我第一次就明白了。奥尔加，乔纳森，欢迎来到 TechStrong 电视台。

***奥尔加*** 很高兴来到这里。

***乔纳森施耐德:*** 感谢。很高兴来到这里。

***艾伦·希梅尔:*** 谢谢。所以唯一的规则是一次只能有一个人说话，但是你们两个都可以畅所欲言。但是为什么我们不从你们每个人开始呢？奥尔加，如果你不介意的话，为什么不先跟观众分享一下你的背景，以及你今天是如何来到这里的。

***奥尔加*** 伟大。我的背景是，我在 Pivotal 从事 Spinnaker 连续交付解决方案的工作，我和 Jonathan 就是在那里认识的。我们在那里一起工作了大约一年半。在此之前，我在 EMC 的工程部门工作了几年，担任过不同的职务。因此，当我们在 Spinnaker 上合作时，我们与许多业内人士进行了交谈。人们对该产品很感兴趣，我们意识到每个人都有类似的问题。我们会开始谈论一些旧的功能，然后会回到，嗯，我的所有应用程序仍然停留在这个旧的、老化的框架上，让我在一年后当我将所有这些迁移回来时再跟你谈。    所以这些问题都是高度可重复的，而且都是相同的框架、相同的第三方漏洞、相同的库、API，所以反思之后我们意识到这真的不是巧合。这是现代应用程序开发实践的结果。我们现在的软件 90%依赖于第三方，开源，API，所以这个问题是高度可重复的。这是一种引导，引导我们回到 Jonathan 早些时候与网飞一起开发的技术，并利用它，开发更多的功能到那种大规模的 分布式 分解 中，这将帮助我们解决这些类型的问题，框架迁移、API 迁移、跨所有这些开源和第三方依赖的 CVE 补丁。

我将让 Jonathan 谈谈他的背景和一点关于开源框架的内容。

乔纳森·施耐德: 是的，网飞有一种叫做自由和责任的工程文化，所以产品工程师可以自由地做他们想做的事情。他们可以使用他们的，一个不同的构建工具，他们可以使用他们特定的 Java 风格，他们可以使用他们想要的任何库，等等。因此，作为一个核心团队，如果你在一个工程生产力团队或者你在一个平台团队，你试图在组织内部实现一些改变，我们不能在产品工程师面前设置障碍，比如说，如果他们不遵守某件事情，就会破坏他们的构建。取而代之的是，你试图建造工具来帮助他们在旅途中与你同行，我不断地从工程师那里听到同样的事情，嘿，我有很多事情要做。如果你为我做的话，我很乐意向你想看到的新模式前进。如果你只是为我做这项工作，我很乐意承担。

*真好。*

*乔纳森·施耐德: 当然，你知道，你认为我们有两个人，而他们有 700 个人，这不能很好地扩展。对吗？这就是我们开始研究一种实际上自动化源代码转换的方法的地方。当我们开发这种技术时，这种自由和责任的结果之一就是没有一致的代码风格或一致的模式。因此，我们构建的 重构 必须进行转换，看起来像是开发人员在代码库中进行风格一致、百分之百准确的更改。我们从中得到了一些有趣的结果，所以当 Olga 和我一起工作时，你会听到，“哦，我仍然被困在 Spring Boot 1 号，我正试图去 Spring Boot 2 号，”或者，“我被困在 JUnit 4 号。我正在努力达到 5，”我们刚刚在一个高度可重复的问题空间中找到了另一个更大层次的应用。*

**很公平。你知道吗，我花了 20 多年的时间和创业者交流。我创办了自己的公司。这就是发生的事情。你看到了一个真正的问题。对吗？看一个现实世界的问题。一定有更好的方法来解决这个问题。有时候你会发现解决这个问题并不像你想象的那么简单。有时候是，很少。但你会克服它，这就是创业的意义所在。在你的情况下，我的意思是，看，Spinnaker，现在是 CDF 的一部分，对，是由 CDF 管理的，但谷歌，网飞在 Spinnaker 的发展中起了重要作用。但是 Spinnaker 是一个开源工具，你们在开发中走的是开源路线。为什么我们不谈谈这个呢？**

***乔纳森施耐德:* 确定，耶。我们的产品分为两部分。还有 OpenRewrite，是 GitHub slash OpenRewrite。OpenRewrite 是我们一直在谈论的核心重构技术，它可以对代码库进行风格上的 自动和 一致的更改。在 OpenRewrite 上，我们建立了方法，因此我们有一个从 Spring Boot 1 迁移到 2，从 JUnit 4 迁移到 5 的方法，来做代码清理工作，修复安全漏洞。我们希望这些食谱总是 Apache 许可和开源的。框架作者将开发配方，因此 Spring 团队将开发将您从 Spring Boot 2 迁移到 3 的配方，或者 IBM 或 Red Hat 的 Quarkus 团队将开发将您从一个版本迁移到另一个版本的配方。    Moderne 在商业上所做的是，我们获取这些配方，并大规模地运行它们，所以我可以获取这些配方，并针对数千万或数亿行代码运行它们，你可以看到，这些配方对整个组织的代码库产生的影响。**

*****艾伦·希梅尔:*** 费尔。所以你提到——怎么会——这不是现代的。是摩登。正确吗？**

*****乔纳森·施耐德:*** 对，我们叫它 Moderne。是啊。**

*****艾伦·希梅尔:*** 摩登。这就是公司的名字。**

*****乔纳森·施耐德:*** 是公司的名字，耶。**

*****Alan Shimel:*** 而 OpenRewrite 就是它的开源方面或者——**

*****乔纳森施耐德:*** 没错。**

*****阿兰·希梅尔:***–主人 之解。奥尔加，让我们稍微了解一下这位企业家的想法。在此之前，您曾在 Pivotal 和 EMC 工作多年，因此看到了这个问题。你看到了这个问题。一定会有解决办法的。你什么时候说过，你知道吗，这是值得开公司的事情，对吗？当我开始创建公司时，一个大问题是，这是一个功能还是一个产品？对吗？它只是别人产品的一个特性，还是它本身就是一个真正的产品？很明显，这对于你在建设什么，你的目标是什么，都有很大的影响。奥尔加，我想听听你的意见。功能、产品，你是如何–在说“你知道吗，这可能是它自己的公司”时，你的思维过程是什么样的？**

*****Olga Kundzich:***我认为，类似这样的东西对于管理现代云原生应用程序至关重要。这些正在成为，应用程序有点像是教所有这些第三方组件的胶水代码。它们以自己的速度发展和变化，开发人员现在真的只是将这些东西重新组合在一起，升级 CVs ，升级版本，这真的需要大量的时间——我们听人们说，他们 20%到 30%的时间(工程时间)都花在了这些繁琐的迁移上。因此，如果我们能够自动化这一点，我们可以释放创新，工程组织的生产力，并帮助许多企业真正创新。**

*****艾伦·希梅尔:*** 明白了。乔纳森，你那边呢？好吧，让我问你们两个。这是你第一次开公司吗？**

*****乔纳森·施耐德:*** 第一次开公司，耶。我觉得这对我很特别。我认为我喜欢这个行业的一点是，我们真的在帮助组织修复他们的代码，我们的结果和我们未来的成功直接取决于我们能够修复多少代码，我们能够提供多少帮助。我们不是报告和说，你知道，这是你，工程团队，需要解决的问题。当我们与一个组织合作时，我们有点像是在战壕里与他们一起解决这些问题。    我们最近与一个组织进行了交谈，这就是为什么我认为它是一个产品而不是一个功能。我们最近与一个组织进行了交谈，他们说我们只看了他们内部的一系列静态分析工具报告的十大问题，他们说，这些工具估计需要 1，700 个开发人员工作日来修复这十大问题。这相当于开发人员花了 4.8 年的时间来解决他们遇到的十大问题，而且这些都不是误报。这些只是他们目前面临的十大关键问题。所以我们开发了很多这样的配方，他们的工程师说，你知道，“我们估计用这些配方需要五天来应用这些变化并完成它。”    当我想到 1，700 个开发人员日或 4.8 年的时间时，这对我来说真正的意义是无限的，或者说它意味着工程团队永远不会完成那些积压的问题。五天似乎是可能的，那是，我们有这条线，基本上软件增长到无法再维护，我认为我们的业务是保持软件处于可维护状态，以便业务可以继续创新和繁荣。**

***绝对。所以公司现在就推出——我们甚至没有提到网站。可耻——***

******乔纳森施耐德:*** 耶。***

*****艾伦·希梅尔:*** 网址是什么？**

*****Jonathan Schneider:***对，所以网站是 moderne.io，所以是带 e 的 modern**

**艾伦·希梅尔: 你能拼出来吗，乔纳森？M-O-–**

*****Jonathan Schneider:***对，就是 M-O-D-E-R-N-E，那么现代带个 E，点 I-O.**

*****艾伦·希梅尔:*** 【点输入输出】**

*****乔纳森施耐德:*** 没错，没错。我们现在确实有一个受限的测试版，你可以在那个网站上注册，我们会邀请你，你可以看到我们如何在数千万行代码中应用这些方法。**

***绝对。你正在与 CDF 和 Spinnaker 社区合作吗？***

******乔纳森·施耐德:*** 我们现在真的处在一个相邻的产品空间。我认为运营自动化有很多价值，Spinnaker 在做什么，不同的 APM 供应商在做什么。我认为我们正在努力解决这个问题，我们只是看到了一个邻近的痛点，于是我们决定去寻找它。***

***好东西。好吧，伙计们，我只想祝你们成功。总是，你知道，我得对你说实话。我总是喜欢采访新公司走出秘密和测试，第一次创业，因为你让世界转动。祝你好运。保持联系。回来告诉我们更多关于你的事情，因为故事将在这里继续展开。***

******乔纳森·施耐德:*** 是啊，期待很快再次交谈。***

*****艾伦·希梅尔:*** 好吧。**

*****Olga Kundzich:***谢谢。**

*****艾伦·希梅尔:*** 乔纳森和奥尔加来自 Moderne，M-O-D-E-R-N-E，dot I-O，这里是 TechStrong 电视台。我们要休息一下。我们马上回来。**

***【音频结束】***