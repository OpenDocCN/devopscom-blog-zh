# 保护数据免受内部威胁

> 原文:[https://devops.com/protecting-data-from-insider-threats/](https://devops.com/protecting-data-from-insider-threats/)

“内部威胁”可以定义为员工或承包商利用其授权权限有意或无意地危害组织安全的威胁。当然，随着组织变得由数据驱动，拥抱数据民主化并以极快的速度发布新的应用程序，内部威胁的可能性正在急剧上升。

内部威胁的一个常见示例是向随叫随到的 SRE 工程师授予权限，这些工程师可能需要访问跨多个数据库的系统表，检查 S3 存储桶的内容，并对生产环境进行更改以修复可用性问题。每两周，团队的组成可能会发生变化，服务和数据库的组成可能会发生巨大变化。

虽然完全防范内部威胁是不可能的，但组织可以通过投资于以下最佳实践来更好地保护其数据:(a)降低此类威胁发生的可能性，(b)限制内部攻击的爆炸半径，以及(c)帮助尽快检测到攻击。第三点尤其重要 Ponemon Institute 最近的【2020 年内部威胁全球成本报告称，检测和遏制内部攻击平均需要 77 天。

## 用于保护数据免受内部威胁的 DevOps 框架

为了使安全措施有效，它们必须是非侵入性的，特别是在敏捷组织中，在那里 DevOps 团队被期望一天发布几次。

**按代码实施访问策略**

以代码形式实施访问策略可以自动化用户和服务访问授权的工作流。使用这种方法，手动策略实践被“代码”(您的团队和实施策略的系统可读的策略文件)所取代，因此您团队中的适当人员可以立即请求、批准和发布策略更改。

作为一个例子，下面是如何将上述场景实现为代码:

工程师可以通过在 GitHub 中向 Terraform 脚本推送代码来将自己添加到待命状态，只有团队领导有权批准此操作。(参见下面的示例 1。)

![insider threats](../Images/88c4f488048b6678c2b3dbea48c14c2c.png)
例 1

使用像 Sentinel 这样的框架，对生产环境的更改可以仅限于随叫随到的工程师。(参见下面的示例 2。)

![insider threats](../Images/05040a086d9378470263932c88ea06c9.png)

示例 2

类似的策略可以只限制那些能够通过从保险库中获取密钥来读取 S3 桶的未加密内容的工程师。(参见下面的实施例 3。)

![insider threats](../Images/430cbfc8e9b4ab936b2646b3d086cfb8.png)

示例 3

上述示例展示了护栏，使工程师能够履行自己的职责，同时大大减轻了主管的管理负担，从而减少了错误。这种方法的另一个好处是，它强制对策略的所有更改进行公开审查，这使得安全模型更加健壮。

**零站立权限**

零常设权限(ZSP)是一个 DevOps 友好的安全原则，它要求用户仅在需要时才可以使用任何管理特权，并且只在需要的时间内有效。它使团队能够通过管理权限在有限的时间内配置对其基础架构的高度关键组件的访问，并限制这些权限的范围。

下面是一些团队如何为他们的数据库实现 ZSP 的例子:

*   在数据库上创建一个可以更新和删除数据库表的 SRE 角色，以及一个允许随叫随到的工程师承担这个角色的 db-admins 私有 Slack 通道。
*   实现可用于通过此 SRE 角色请求和授予访问权限的服务，默认时间为 60 分钟。过了这段时间后，访问将自动撤销，需要再次授权。
*   在 BrewOPA 中进一步实现限制 SRE 删除表和数据库的策略，这可以避免任何灾难。

**特许活动的审计跟踪**

SIEMs 日益成为每个安全组织的神经中枢。虽然有效的威胁搜寻和事件响应需要数年的专业知识，但 DevOps 团队可以通过投资于日志收集和环境中所有特权活动的基本分析来显著增强其云平台的安全性。

这些工具包括如下服务:

*   使用 Cmd 的所有 Linux 机器的会话记录
*   使用数据云服务记录跨数据库的活动
*   使用 CloudTrail 等服务集中和收集所有环境日志。

这些日志可以在像 Kibana 这样的工具中可视化，团队可以查看活动模式异常。这些可能包括:

*   有人打开了与组织外部的 FTP 连接
*   在数据库之外创建表的手动副本
*   跨资源的身份验证失败次数增加

虽然“最低权限”作为防范内部数据威胁的概念已经存在了一段时间，但云原生和 DevOps 方法的出现加剧了实施的挑战。近年来，[安全即代码](https://devops.com/?s=security%20as%20code)和[基础设施即代码](https://devops.com/?s=infrastructure%20as%20code)已经成为实现安全解决方案的良好模式，并植根于上述框架。未来将鼓励不同利益相关方之间的协作，记录安全策略以便于审查，并建立在现有工具和工作流的基础上。这将有助于限制内部威胁、限制特权蔓延和防止“用户疲劳”