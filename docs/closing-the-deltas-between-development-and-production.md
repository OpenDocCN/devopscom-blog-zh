# 缩小开发和生产之间的差距

> 原文：<https://devops.com/closing-the-deltas-between-development-and-production/>

谁没听过“它在我的机器上工作！”或者，“如果有真实数据，那就更容易了！”？在这两种情况下，如果开发发生在生产中，问题就可以避免了！幸运的是，在 DevOps 的世界里，生产和非生产之间的壁垒被打破了，使得在生产中开发和测试的现实变得更加有形。排名不分先后，以下是我为打破这些壁垒所做的一些事情。

从单一代码行开发和部署。

很多时候，我们发现自己处于围绕部署和产品缺陷修复的复杂过程中。例如，对于候选发布版本，代码是分支的，部署是从分支中完成的。发布前的分支本身并不复杂，但是，当有一个产品 bug 时，工程师发现他们自己重复或者合并修复到至少两个，如果不是几个，不同的地方。重复几次，哦，现在有一个问题，因为有许多移动部件和生产中到底是什么的问题。不幸的是，这些差异很可能是无意的。

相反，简化流程，让每个人都使用相同的代码行，并将相同的代码行直接部署到产品中。现在只有一个代码库，因此不存在生产中运行什么代码的问题。生产不是一成不变的，因此部署后仍会发生变化。需要用符号来表示所部署的版本，这样您仍然可以重现产品。

让测试在生产数据库上进行。

好吧，即使我没有那么疯狂，但让开发人员使用生产数据库的副本。这有两个非常重要的方面。第一，经常刷新。我建议每天。我很幸运地使用 EBS 快照在不同的服务器上获得了数据库的副本，但是如果您的数据库很小，良好的旧 SQL 转储也可以工作。第二，让它安全。设置一些安全防护措施，以确保不会意外地对实际的生产数据库进行更改。保持您的 ACL 严密，更改密码和实践适当的数据库用户管理。最后，一个额外的结果是您不断地测试您的数据库备份和恢复过程。

尽量减少开发和生产之间的步骤。

开发人员的机器和产品之间的每一步，尤其是手动步骤，都是可能引入意外变化的另一点。这听起来是显而易见的，但盖茨的代码在进入生产之前必须通过，必须是有目的的，并证明它们的有用性。例如，如果代码必须经历回归，但是没有发现回归，那么这个步骤是没有用的，只会增加非预期变化的可能性。我参与了一个过程，其中代码必须被部署到“staging ”,然后连接到实时生产数据库，但只能以只读方式执行。在对许多许多版本这样做并且很少在生产前发现缺陷之后，我们决定更好地部署到生产中，并且消除了部署到阶段中。最终，我们变得更快，而且对质量没有任何影响。少可以多。

这取决于您的情况、数据库大小、法规遵从性等。你也许能够做到所有这些，但是打破这些藩篱将会产生更好的代码，更少的错误，更快乐的工程师和更少的不眠之夜。所以，拿起那个毁灭之球，打破几堵墙。