# AWS 最佳实践—企业视角

> 原文：<https://devops.com/amazon-aws-best-practices-enterprise-perspective/>

亚马逊 AWS 改变了初创公司和成长型公司的 IaaS 游戏。在采用和实现 AWS 服务的过程中，我们必须认识到几个实践的重要性。非常欢迎读者评论、建议修改，甚至添加他们自己在推出和实施过程中遵循的小实践。当客户开始尝试云计划时，最好避免常见的陷阱。以下最佳实践是这一努力的良好开端。以下是我们在 aws 部署过程中总结出的十大最佳实践，我们将在未来对其进行扩展。我们期待着今后扩大这一清单。

1.**谨慎选择您的 VPC 基础设施**

a.当您进入 AWS 环境时，公司通常想做的第一件事是创建 VPC，问题是什么类型的架构适合您？这个问题的答案取决于预期的用例。通常，基于互联网的组织会选择包含公有子网和私有子网的 VPC。选择这种类型的 VPC 可以确保不需要直接访问互联网的服务位于隔离的子网中，同时将公共服务访问定位到公共子网。

b.打算突入云的现有企业通常不打算利用面向公众的服务，而是可能选择专用子网，并在企业和公共云之间创建安全隧道。

c.具有最大灵活性的架构往往是公共/私有子网，确保公共子网在必要时可用，在不需要时可以保持未填充。

2.CIDR 块选择由两个事实驱动:VPC 地址空间是固定的，并且在创建之后不能改变。

a.确保您的 VPC 地址空间不与您的公司空间重叠，对于基于互联网的公司来说，这不是一个问题，但是对于企业来说，这可以避免在投入大量时间和资源后重建环境的需要

b.虽然 AWS 允许 CIDR 块大到/16，但不要浪费空间，当需要支持多 AZ 服务或其他最终需求时，拥有几个非常大的子网会降低灵活性。另一方面，不要过度约束你的环境。

3.**环境隔离是一个重要的考虑因素，**物理环境中存在的隔离也应该存在于云环境中。云使企业在实施这种隔离时更加灵活，以努力控制成本，开发、集成/测试和生产环境可以在单独的帐户下注册，从而确保准确的计费和成本控制。

4.**安全性:使用安全组来隔离服务和管理规则**

a.使用子网将公共流量与私有流量分开

b.创建一个 SSH 网关作为 SSH 通信的入口点

c.为管理访问创建 VPN 隧道

5.**VPC/企业整合**

当将 AWS 集成到现有的企业环境中时，规划将确保最少的返工。通常，关键的考虑是将 IP 范围分配给不与公司空间重叠的 AWS。这样，公司局域网和 AWS 之间的路由将是无缝的。

6 **。IAM** :在 Linux 系统中，主 AWS 帐户应该像传统的根用户一样对待。

a.创建一个专门用于管理的独立帐户，拥有执行手头任务所需的最低权限。

b.为每个用户或服务创建单独的帐户，以确保审计的可追溯性

c.应该将权限分配给组，并将用户分配给组，这将最大限度地减少重复工作

d.所有用户都应该使用强密码，在这种情况下，请参考您公司的密码策略。云密码应该像企业基础设施一样安全。

e.不要共享凭证，这将破坏审计可追溯性和公司政策，使用角色来分配权限。

f.定期轮换凭据，就像轮换公司凭据一样。

7.**灾难恢复**:请记住，灾难恢复旨在故障后获得备份。传统的企业环境通常受到以下问题的限制:我们是否需要构建一个重复的系统来进行恢复，或者我们是否可以通过供应商 SLA 来执行数据恢复。就云而言，企业客户能够(以较低的成本)跨可用性区域、地区和供应商复制其环境，以创建异常灵活的服务产品。

a.务必创建多个可用性区域。

b.务必使用自动化的配置管理工具来维护您的配置

c.务必创建卷的快照。

d.务必进行演练，以确保一切按照设计运行。

e.务必不止一次运行 drill。

f.确保所有相关人员都了解该程序

g.设计您的环境时要有足够的冗余，以最大限度地减少所需的恢复工作。

8.安全组:像传统防火墙这样的安全组应该设置为完成任务所需的最低权限。

a.决定安全组方法；通过创建组来管理对服务的访问，ie 允许将成为 web 服务器的节点访问端口 80 和 443。

b.创建 ssh 网关/堡垒节点和组:

I .只允许外部 SSH 访问 SSH 网关

二。只允许来自安全组内部或网关节点的本地 SSH 访问，这最大限度地降低了攻击者在区域之间穿越网络的能力。

c.定义一个企业命名约定并坚持下去。

d.利用将多个安全组分配给单个资产的能力(每个资产最多 5 个组)。

9.**命名约定:** AWS 资产应该以一种易于识别的方式命名，这是一种围绕实例的用途、环境、区域和序列号的标准化建议。这方面的一个示例可能是 haddop_dn_prod_usw1_001，它代表美国西部 1 区的一个生产 Hadoop 数据节点。

a.在命名 AMI 时，将创建日期作为其名称的一部分以及完整的描述是一个很好的做法。这将在为新实例选择 ami 时最大限度地减少混淆。

b.在命名安全组和密钥对时，继续使用约定的目的、环境、区域和功能。例如 db_prod_usw1_key 或 ws_prod_usw1_sg

10.**弹性负载平衡:在发生环境故障时，使用多个可用区域来平衡流量(这种情况仍可能在云中发生)**

a.使用 Route53 来平衡地区之间的流量，ELB 不支持此功能

b.使用 ELBs 不仅仅是 web 流量，几乎任何协议都可以被 ELB 支持，确保你的服务可以支持它

c.40 秒后 ELB 超时，确保您的应用程序在此之前接触套接字，以防止会话超时。

这些是我的前 10 名。让我知道你认为我错过了什么。