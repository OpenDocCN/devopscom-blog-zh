# 对抗部署焦虑:来自专业人士的 5 条建议

> 原文：<https://devops.com/fighting-deployment-anxiety-5-tips/>

你知道这种感觉:你花了几个小时开发一个新功能。它已经通过了 QA，测试并通过了所有利益相关者的检查，现在您可以开始部署了。尽管你有经验和准备，但你心里有个坑。如果出现问题，导致您的应用程序瘫痪，该怎么办？如果它不能在您的生产环境中正常运行，该怎么办？我们都经历过。幸运的是，我们也有一些方法可以帮助。

Electric Cloud 首席技术官 Anders Wallgren 最近与首席技术官 Gene Kim 一起参加了一个网络研讨会，他是“凤凰计划”和“DevOps 手册”的作者之一由《DevOps.com》主编 Alan Shimel 主持的[网络研讨会](http://electric-cloud.com/resources/webinars/diving-deeper-into-devops-deployments-with-gene-kim)讨论了从大规模开发运维转型中吸取的经验教训、开发运维的商业价值以及应对部署焦虑的一些最佳技巧和诀窍。我们从 Kim 和 Wallgren 那里找出了五大技巧和窍门，让部署担忧成为过去。

## 技巧 1:自动化您的部署

Kim 和 Wallgren 的网上研讨会的主题都是“自动化”其中一个重要原因是，通常，当您自动化部署时，您也自动化了对这些部署中的问题的诊断。你不能总是依赖命令行工具的退出代码来告诉你事情是好是坏。为了帮助保持您的部署健康，您将希望在整个过程中进行测试，可能是蓝绿色部署或部分部署。但是，如果没有自动化支持，很难快速完成。如果没有自动化，您可能会开始依赖个人的巨大努力——因此，每次您进行部署时，都需要有人进行比喻性的走钢丝来完成所有工作。这为您的员工创造了一个艰难的环境，并可能导致长时间的停工(和利润损失)。

## 技巧 2:支持对任何基础架构的自助部署

您可能想知道为什么这是一个独立于自动化部署的主题。这是因为在给定的发布管道中发生的大多数部署都没有进入生产环境。大多数部署都在测试环境中结束(性能测试、回归测试或仅仅是开发人员测试)。让您的工程师能够使用相同的部署方法(工件、过程定义、环境定义等)也很重要。)而不管他们部署到哪里。从成本角度来看，允许 QA 在本地 Kubernetes 集群上进行测试可能比在 Amazon Container 服务上运行测试更具成本效益。但是，允许团队使用相同的批准的自动化作为每个部署的一部分——到任何位置——意味着更彻底的排练，因此更少引起焦虑的部署。

自助部署的能力还能让您的团队在需要部署测试时大幅加快速度，因为他们无需开罚单并让您的运营团队参与进来。通过允许自助部署，您可以避免四处奔波寻找合适的人来完成您需要运行的部署的过程，并使您的组织能够跨不同的组更加自主地做出反应和构建。结果是更好地测试和构建部署(导致更低的部署压力和更少的错误)。

## 技巧 3:自助服务环境

我们继续以自动化为主题，但这一次我们讨论的是自助服务环境。我们经常使用复杂的分布式应用程序。这意味着我们需要集成容器化的微服务应用、DBMSs、消息传递、关键价值存储、传统应用和第三方供应商，所有这些都使我们的部署变得复杂。当您在应用程序的生命周期中提升应用程序时，能够一致地供应复杂的环境是能够成功地重新创建部署的一个非常重要的部分。

确保您的工程师，尤其是您的 QA 和开发工程师，能够方便地访问环境，而不是站在那里等待访问，这一点很重要。如果您无法正确调配和配置虚拟机或容器来接收您的应用，就会遇到问题。其中一个问题是你快速测试的能力变得更加困难。当您不能在几分钟内建立一个接近生产质量的环境时，这意味着您只需要几行代码的 bug 修复可能需要几周的时间来测试。突然，您需要申请一组虚拟机来进行测试(这可能需要几周时间),然后再花一两天时间来进行部署，只有这样，您才能完成测试。事情变得非常缓慢。而且，当涉及到测试和修复错误时，慢就等于压力。

## 技巧 4:工件仓库

想对你的作品更有信心吗？看看你的藏物库。在生产环境中使用共享的工件存储库已经被证明是部署成功的一个很好的预测。如果您没有对二进制文件进行版本控制，并且对二进制文件的来源和构建方式知之甚少，这可能会导致部署失败。

让您的工件库保持一致可能不容易或不简单，但从长远来看，这是一项将会获得巨大回报的工作。Electric Cloud 与一家大型在线抵押贷款公司合作，该公司面临着将大型工件(千兆字节)部署到多个数据中心的挑战。为了让一切都跟上速度，有必要将那些工件从他们的构建和测试基础设施转移到他们的预生产和生产基础设施中。由于工件的大小和对文件全球可用性的担忧，Electric Cloud 与这家金融服务公司合作，使用亚马逊 S3 作为存储库服务器的后备存储，以创建灵活、可扩展的长期解决方案。

## 技巧 5:安全性和可审计性

如果你在一个受监管的行业工作，你已经知道可审计性和治理会引起的心痛。安全性是许多应用交付管道中最重要的方面之一(如果不是唯一的话)。事实是，我们只是刚刚开始触及未来基础设施遭到黑客攻击时将会看到的问题的表面。我们的建议是什么？这又回到了自动化。在 ElectricCloud，有一句话:自动化就是审计，自动化就是文档。

这背后的想法是，通过自动化您的部署任务，您实际上创建了一个非常真实和有形的文档记录，它显示了您打算做什么(自动化定义)和一个关于发生了什么的报告(自动化日志)。当您依赖手动部署时，您会突然失去工作流的可重复性和可预测性。在这一点上，你被迫根据人们的电子表格、电子邮件和记忆进行报告。这是那些直到成为真正的大事才成为大事的事情之一，借用另一句话说，一盎司的预防抵得上一磅的治疗。就可审计性和安全性而言，因为您的步骤总是相同的，所以能够追溯您的步骤是使您的审计更加顺利的一个相当简单的方法。

为了提供一个真实世界的例子来说明自动化如何使审计和安全变得不那么痛苦，ElectricCloud 的一个客户是一个具有非常严格和苛刻的安全标准的航空航天客户。过去，在每个版本结束时，会有一个为期两周的过程，每个人都必须坐下来，编制一份作为该版本一部分部署的每个签入的列表。他们必须了解它是在哪里制造的，以及它是如何测试的，然后将所有这些信息汇集成一份报告。这是一个极其耗时，但似乎是必要的过程。但是，通过自动化管道中的许多步骤，审计响应工作从两周的过程缩短到了几个小时。他们之所以能做到这一点，是因为他们需要的 99%的信息都在自动化系统中，只是作为流程的一部分被收集起来。任务从手动提取数据变成了将数据转换成可消费的格式。

## 摘要

到目前为止，您肯定已经看到了我们为减轻部署压力而提出的建议中的一个主题，即自动化！通过努力实现自动化和流水线化，你可以让曾经非常耗费人力、有时令人反胃的过程变得更加愉快。从长远来看，这不仅可以节省您的时间和金钱，还可以让您专注于构建更好的软件、进行更多部署，以及专注于为您的企业和客户带来真正价值的任务。

有关如何缓解部署焦虑的更多详细信息，以及有关从大规模企业开发运维转型中吸取的经验教训和开发运维的商业价值的其他讨论，请观看[完整回放](http://electric-cloud.com/resources/webinars/diving-deeper-into-devops-deployments-with-gene-kim/)。

## 关于作者/山姆·菲尔

![sam-fell](img/53dac31aeb1cc7d8f6129b23ab36dfb2.png)山姆·菲尔是电气云的营销主管，负责推动对我们 DevOps 发布自动化和加速解决方案的认知和需求。20 年来，Sam 通过营销、销售和实施 DevOps 发布自动化、IT 变更管理和应用性能管理解决方案，帮助公司取得了成功。在加入 Electric Cloud 之前，Sam 曾在 BMC、CA、Marimba 和 Nimsoft 担任领导职务。在 [Twitter](https://twitter.com/samueldfell?lang=en) 上关注他，在 [LinkedIn](https://www.linkedin.com/in/samueldfell/) 上与他联系。