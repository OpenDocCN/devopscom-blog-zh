# 使用 PAM 支持 DevSecOps 中的“Sec”

> 原文:[https://devo PS . com/using-PAM-to-support-the-sec-in-devsecops/](https://devops.com/using-pam-to-support-the-sec-in-devsecops/)

***尽管 PAM 被认为缓慢而复杂，但它可以有效地包含在 DevOps 管道中***

DevOps 实践的引入导致了软件开发的一场革命。然而，随着公司采用这些新技术、工具和方法，整合[特权访问管理](https://www.beyondtrust.com/resources/glossary/privileged-access-management-pam) (PAM)变得越来越复杂。尽管如此，公司政策、行业标准和政府法规要求安全和运营团队必须管理和审核越来越多的用户和服务帐户的权限和凭据。作为最佳实践，最低特权访问控制模型是必须的。

使问题更加复杂的是，保护开发人员环境的传统方法涉及手动干预和限制性控制，这极大地阻碍了开发和运营团队的敏捷性。正因为如此，DevOps 避开了 PAM，认为它太慢、太复杂，难以部署和管理。

更复杂的是，云中运行的应用程序、虚拟机、服务和工作负载都有身份。事实上，现在非人类身份代表了许多组织中的大多数“用户”。这种非人类身份的扩散加剧了获得最低特权的难度。

像人类身份一样，对这些身份的访问必须受到严格的监视和控制，以便自动拒绝未经授权、未经验证的访问。支持现代应用程序到应用程序密码管理(AAPM)方法的 PAM 解决方案可以实现这一点。DevOps 所有者可以在不影响敏捷性的情况下控制特权访问，让他们专注于他们最擅长的事情，同时最终将“Sec”放入 DevSecOps。

AAPM 消除了在应用程序中以明文形式存储凭据的需要。相反，开发人员在他们的代码中引入 API 调用，以编程方式访问 vault 并检查密码。密码存储在应用程序内存中，不会写入磁盘。一旦应用程序终止，内存将被释放，密码也将消失，不会给威胁参与者留下任何线索。使用这种方法，vault 可以保护凭证并控制对凭证的访问。保险库还可以自动轮换密码，增加破解难度。由于依赖的应用程序现在通过 API 调用来获取它们，DevOps 团队不再关心在密码改变时更新他们的代码。

## 帕姆和德沃普斯:AAPM 在行动

这是 AAPM 的一个基本方针。然而，还存在其他选择，这些选择的特点是不断提高网络风险缓解水平和运营效率:

**第 1 级:AAPM 检索保险库 ID 和密码**

如上所述，这是传统的 PAM 方法。虽然存储密码通过从代码中删除密码提供了额外的安全层，但密码仍然是最弱的身份验证形式。即使使用自动密码轮换，它们也会持续到下一次计划的轮换(通常是几天或几周)，这给了攻击者足够的时间来尝试破解。要将它们从 vault 中签出，每个工作负载都需要一个服务帐户。这可能很快导致数百个(如果不是数千个)额外的帐户，从而增加管理开销和攻击面。

**第 2 级:AAPM 检索一个保险库 ID 和 SSH 密钥**

由于广泛使用共享特权帐户进行身份认证，人工管理员和工作负载给组织带来了额外的风险。安全外壳(SSH)密钥通常作为一种更安全的替代方案来实现，允许工作负载签出存储的 SSH 密钥，而不是签出存储的密码。

SSH 密钥的使用包括与存储密码相似的风险和好处。它们也是静态的，依赖于预定的旋转。它们也可以在开发人员之间和工作负载之间共享。开发人员和 IT 管理员通常被赋予足够的权限来随意创建 SSH 密钥，而没有任何监督或集中管理。这使得他们很难跟踪和知道他们是如何使用，由谁使用，用于什么目的。如果他们丢失或开发人员离开，系统和服务的可用性会受到影响。

然而，从积极的一面来看，SSH 协议采用了公钥加密。SSH 密钥(公钥和私钥)比任何密码都长且复杂。与密码不同，它们不是通过网络发送的。所有这些使得他们更难妥协，因此也更安全。

也就是说，每个工作负载仍然需要一个服务帐户来验证 vault 并检查 SSH 密钥，这两者都是潜在的攻击媒介。

第三关:AAPM 取回临时令牌

临时令牌(例如，OAuth2)可由 vault 按需自动创建，并提供一种现代形式的安全访问，该访问是临时的、基于时间的并自动过期。这将 DevOps 从处理安装、配置和轮换问题中解放出来，同时有助于实现最佳实践的“即时”访问控制方法。但是，与以前的方法一样，每个工作负载仍然需要一个服务帐户来验证 vault 以获取令牌。

虽然这种令牌可以持续存在，但它们通常在会话或事务期间是短暂的，这大大减少了威胁参与者的机会。

**第 4 级:使用委托机器凭证和临时令牌的 AAPM**

现有方法的特征都在于每个工作负载的服务账户需求。使用委派的机器凭证方法，每台机器只需要一个服务帐户。

当机器在 PAM 服务中注册时，它就建立了相互信任的关系。PAM 服务为该机器创建唯一的委派机器凭证、机器身份和服务帐户。然后，本地工作负载可以附带该机器身份，利用委派的机器凭证向 vault 进行认证，将其交换为 OAUth2 承载令牌，该令牌可用于后续 API 调用(例如，检查密码或获取令牌)。)由于并非所有的工作负载都是相同的，OAuth 作用域可以限制每个工作负载可以访问哪些 API。因此，通过使用委派的机器凭证，服务帐户的数量几乎减少到零，从而消除了数千个潜在的漏洞。

这种方法也解决了缺乏将 PAM 引入 DevOps 的愿望，正如我在开始时强调的。这种方法可以完全自动化并自然地插入到 CI/CD 管道中。

所有这些方法都根据组织现有的 PAM 成熟度、风险承受能力和法规遵从性压力，为组织提供了更多的选择。它们最终允许开发运维团队自动化、简化和集中 PAM 安全管理，同时改善组织的安全状况，而不牺牲敏捷性。