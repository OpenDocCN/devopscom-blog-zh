# 配置管理系统还有多久？

> 原文：<https://devops.com/so-long-configuration-management-systems/>

早在 2009 年，当我还是 Ning 的一名运营架构师时，我们正在努力管理 50 多种不同应用服务器的部署和配置，也就是现在酷孩子们所说的微服务。应用程序部署在三个不同的环境中:开发、试运行和生产。这些环境没有一个与另一个完全相同，这些依赖关系的差异以及人为错误经常会破坏我们的部署。

宁绝不是第一家遇到此类问题的公司。在 20 世纪 90 年代中期，随着公共互联网的出现，当时对 IT 运营的许多理解受到了扩展面向互联网的系统的需求的挑战。在互联网繁荣之前的许多年里，用户的最大数量被严格限制在一个公司的雇员数量之内。随着万维网的出现，这一切都改变了，在万维网上，为成千上万的用户同时服务的需求很容易就超过了最大、最昂贵的计算机的计算能力。

随着三层应用程序体系结构被分解为服务并分布在数十或数百台单独的服务器上，服务器的激增被证明是运营团队难以应付的。最糟糕的问题存在于应用程序部署过程中，在连续的软件版本中，环境和需求是不断变化的。服务器的寿命很长。一旦部署完毕，服务器就会受到运营和开发人员的反复修改，这就是所谓的“配置漂移”变化、人为错误和未知状态的综合影响会造成灾难性的停机，从而损害品牌和破坏在线收入。站点需要几天甚至几周的时间才能从这些中断中恢复。有些人永远不会恢复。

正是在这种混乱中，现代配置管理系统诞生了。CFEngine 是第一个出现在学术界的，学术界很早就感觉到了管理多个 UNIX 系统的需要。后来，Puppet、Chef、SaltStack 和 Ansible 直接从 web 规模的系统中出现。配置管理系统满足了几个重要的需求。首先，他们抽象了操作系统之间的差异，为系统管理员提供了一种高级语言来描述所需的状态。第二，它们在大量服务器之间自动同步所需状态，减少了代价高昂的人为错误。最后，他们提供幂等性来确保破坏性操作不会被不必要地应用。

天下没有免费的午餐。更好的抽象带来的好处在一定程度上被构建和维护更加复杂的配方的需要抵消了。由于包管理特性从配方第一次被编写时起就被更新、重命名或以其他方式改变，配方经常被破坏。即使配方有效，它们也经常被环境差异或运行时错误所破坏。配置管理系统本身开始遭受规模挑战，并发展了消息总线架构来提高它们的速度和响应能力。通过克服这些障碍，配置管理系统现在已经成为管理网络规模系统的一线工具。

但在宁，Puppet 和 Chef 等现代工具仍处于初级阶段，根本无法应对我们 60，000 多个节点的虚拟化环境的规模。宁身边有很多优秀的软件工程师，他们开始创建自己的部署自动化系统 Galaxy，后来又创建了一个名为 Cosmos 的 meta-orchestrator。银河和宇宙是伟大的工具，但他们需要不断的照顾和喂养，并遭受严重的规模问题。在试图为一家热门的初创公司扩展顶级社交网络的同时，处理这些自动化系统非常复杂。

当我们开始分析和事后检查我们的部署失败时，很明显大多数问题源于主机和环境配置错误。我们需要一种更简单的方法来部署我们的软件。虚拟机映像是一种很有前途的方法，可以通过久经考验的真正的“黄金主映像”方法来确保环境之间的一致性。这种方法的问题是，从自动化的角度来看，构建完整的系统虚拟机很困难。一旦部署，虚拟机也会受到配置偏差的影响。此外，虽然我们渴望采用虚拟化来获得更好的资源隔离，但我们也担心虚拟机管理程序会产生开销。我们的基准测试表明，如果我们采用虚拟机，我们将需要增加物理服务器容量来适应开销。

当时，内核中已经有了 Linux 容器，但是发行版几乎不支持管理它们。在我们的运营副总裁的坚持下，我设计了一个基于监狱的替代解决方案，编写了一个名为 Warden 的小程序来构建和管理它们。(注:与 Cloud Foundry 中的典狱长完全无关)。Jails 为我们提供了裸机性能、资源隔离以及为每个应用服务器一致部署整个环境的方法。有了 Warden，我们可以在运行中自动构建监狱图像，并使用我们现有的工具 galaxy 和 cosmos 一致地部署它们。嘿，这是一个困境的创可贴，但我和大楼管理员的经历触动了我的大脑。我已经看到了轻量级虚拟化消除复杂性的方式，我当时就知道这是未来的发展方向。

今天，随着 Docker 的成功，我们终于在构建、部署和管理分布式应用程序的过程和工具方面经历了彻底的变革。与此同时，随着早期解决方案被淘汰，我们即将进入一个短暂的容器幻灭期。当这一切结束后，随之而来的是分布式应用的黄金时代。我称之为容器应用平台，它介于我们今天所认为的平台即服务(PaaS)和无服务器之间。在不太遥远的将来，容器将成为软件构建过程的默认输出，容器在哪里部署将不再是事后才想到的事情。这种独角兽魔法将来自于自省容器以确定其环境依赖性的能力，以及自动处理部署、扩展和依赖性解析的完全集成的工具链。我只给你一个猜测，哪家公司最有可能拥有未来。[一枚戒指统治他们所有人。](https://www.docker.com/)

我们漂亮的配置管理系统会发生什么？在过去的几年里，在聪明的人当中有很多关于 T2、T3、T4 的争论。这些争论大多归结为某种共存模式。事实上，配置管理系统对于处理容器平台之外的各种操作问题非常有用。虽然毫不奇怪，Chef、Puppet、Salt 和 Ansible 都迅速加入了 Docker 支持，但我认为我们会看到这些工具开始更多地关注罗布·希施菲尔德所说的实现“就绪状态”。也就是说，在您可以放下您的容器平台之前仍然需要做的所有事情也仍然需要自动化。现在，仍然有大量的工作要做，而且在使用正确的工具完成正确的工作方面，这是一个非常安全的界限。

## 关于作者/詹姆斯·托马森

![james-thomason_dsc0492](img/11390ffa7b440b436a37e257ad92294b.png) James Thomason 是戴尔 HyperGrid 的首席技术官，他在该公司担任首席技术官，负责领导戴尔云市场的愿景、技术战略和产品路线图。他于 2012 年通过收购 Gale Technologies 加入戴尔，担任首席技术官期间，他负责公司旗舰云和融合基础架构自动化软件 GaleForce 的产品路线图、架构和工程。在加入 Gale Technologies 之前，Thomason 是 Virtiv 的首席技术官和创始人，Virtiv 是一家专注于 Linux 虚拟化的旧金山云自动化初创公司，于 2011 年被 Gale Technologies 收购。17 年来，作为分布式系统和大规模基础设施领域的专家，Thomason 一直是许多著名硅谷初创公司的企业家和创新者，包括 Exodus Communications、Digital Island、Netli、NetVMG、Netscaler、3Leaf Systems 和 Ning。在 [LinkedIn](https://www.linkedin.com/in/jthomason) / [Twitter](https://twitter.com/fef1f0) 上与他联系。