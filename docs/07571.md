# 语言和 DevOps: API 优先

> 原文:[https://devops.com/languages-and-devops-api-first/](https://devops.com/languages-and-devops-api-first/)

开发带来显著变化的地方之一是在 API 领域。如今，一个程序几乎不被认为是一个合适的应用程序，除非它提供 API 来完成大部分可以通过 UI(甚至命令行)完成的事情。这是一件大事，原因有几个:首先也是最重要的，对作品进行细分，然后对每个细分进行测试的能力。一个合适的 API 做一件事，并且做得很好。测试可以验证这种说法对于任何给定的 API 都是正确的。它还允许分布处理。使用负载平衡器来扩展 API 比扩展单一应用程序要容易得多。最后，它有助于可移植性，因为使用 API-first，开发人员用户不关心它在什么平台上运行，只关心它可以通过 URL 访问并按预期响应。

一切都是一种权衡，API-first 有几个地方存在问题。集成测试客观上更难。一般来说，松散耦合的应用程序更难测试，并且要求应用程序的多个部分都可用来运行测试变得很麻烦，特别是当 API 层开始构建时。第二，安全性是另一个问题——特别是如果你提供面向公众的 API，但也供内部使用。一旦攻击者能够访问网络，内部专用 API 对他们来说与外部 API 没有什么不同。聪明的 IT 部门设计的内部 API 具有外部所需的相同控制。第三是一般的 DevOps。API-first 在[敏捷](https://www.agilealliance.org/agile101/) /DevOps 世界中成长，但是因为存在级联依赖，实际上比大多数单一应用程序更难管理 DevOps。最后，文档——API-first 存在的祸根。记录不良的 API 的数量远远超过记录良好的 API。即使是记录良好的 API，如 Google Places，也需要一些思考和测试才能很好地使用。记录很差的——我最喜欢的是，“这是 mysite.com/users——每个人都知道那里有什么！”–如果没有学习曲线，几乎毫无用处。

说了这么多，语言呢？这很大程度上取决于你在做什么。用户不关心它是用什么语言实现的——如上所述，他们关心的是可以通过 URI 访问该 API，以及它的行为是否符合预期。所以你有选择。事实上，在 API 发展的这一点上，语言选项是如此开放，以至于你可能会选择 API 定义语言而不是编程语言，并指示你的定义工具吐出选择的语言。

等等，什么？

对于那些在过去几年中没有密切关注 API 开发的人来说，事情是这样的。API 变得标准化了，然后 API 成了一件大事，然后聪明的人开始考虑代码生成。如果您可以使用一种规范语言来描述您想要做的事情，然后选择您的语言并告诉工具生成 API，会怎么样？如果您可以对整个 API 层次结构做到这一点，会怎么样呢？这就是我们的处境。我最熟悉的是 OpenAPI 和 RAML，但是还有大量的规范，以及大量的工具可以在其中开发。在我的 API 朋友抓狂之前，*当然*这是对所发生事情的过度简化。我最多只有 1000 字，我的编辑希望更少。放松一点。

然后你生成。

这里我将依靠我自己的经验，但是实际上有几十种工具可以让你从 idea 到 API 接口(做接口背后的工作就是你的用武之地)。用 [Swagger](https://devops.com/?s=swagger) CodeGen，我最熟悉的工具，你指定 API，然后生成服务器接口(他们称之为存根)，生成客户端库。最后，您在服务器端开发接口背后的内容，并且(您或其他人)在客户端使用 API。当我说“生成”时，我的意思是“告诉它你最喜欢的语言，然后点击生成。”它给出了可以用来充实 API 的代码。它不会把信息吐出来让 API 进入你的 DevOps 工具链，所以你必须为此做工作。这意味着您可以在一个批处理中生成的 API 越多，您需要做的 DevOps 提升就越少(如果/当我们讨论微服务时，会有更多关于这方面的内容)。由于大多数语言可以很容易地通过它们的构建工具放入 DevOps，我不想让这听起来太麻烦——安全和测试将是一个更大的问题。

API 安全性正在慢慢自动化，并被直接放入生成的代码中，但所有常见的部分，如证书管理，仍然需要处理。有趣的是，客户端的安全性还没有得到太多的关注。当客户端库的目的是授予对 API 的访问权限时，验证该库是否安全要困难得多。我期望我们最终将不得不为一些应用程序到达那里，但是今天，它似乎很大程度上是个人组织计算出如何最好地锁定客户端库，并且大多数限制因素结束于服务器端。

我已经通过各种工具集生成了 Python、 [Java](https://devops.com/oracle-updates-java-development-platform/) 和 Ruby APIs，考虑到问题域仍然相对较小，它们工作得很好。它解决了难题的一部分…但引入了另一部分——通过 DevOps 协调客户端和服务器更新。

继续开发运行世界的应用程序，并使用 API 生成器来进一步标准化，在后端吐出你需要的任何语言，并为客户端提供一个可移植的接口。

**你。摇滚。**

无论您选择哪种语言，最终都可能是您的构建工具将它与 DevOps 联系起来。您对 DevOps 最大的担忧可能是可移植性，至少在不久的将来是这样。同时，继续摇摆。你在做需要做的工作，即使这不是每个人目前都在谈论的 DevOps 的一部分。