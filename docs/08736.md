# IaC 自动化工具的 5 大必备

> 原文:[https://devo PS . com/top-5-must-haves-for-IAC-automation-tools/](https://devops.com/top-5-must-haves-for-iac-automation-tools/)

如今，有许多不同的 DevOps 工具来完成许多不同的工作。几乎每天都有新的创业公司推出新的创新产品或现有工具的更新(甚至更好)版本。最大的创新之一是“基础设施即代码”(IaC)。让基础架构管理员和开发人员能够使用代码文件创建、操作和销毁基础架构，改变了我们管理环境的方式。虽然这些工具是革命性的，可以解决许多问题，但有时它们会带来一系列全新的问题——任何类型的工具都可以，真的。T3】

通常，IaC 工具首先在本地运行。当基础设施管理员或开发人员刚刚开始使用它时，他们将文件存储在本地；可能在存储库中，然后克隆文件以在本地执行。这是完全可以接受的，也是很常见的做法。当将这种实践扩展到团队时，问题就出现了；例如，在可见性和治理方面。如果每个人都在本地运行他们的部署，团队就不能清楚地了解谁在部署什么，何时部署，以及使用什么变量。这就是 IaC 自动化工具发挥作用的地方。

有许多不同类型的工具可以解决这些问题。有些人比其他人更好。CI/CD 管道工具、定制的自动化平台、专用的 IaC 自动化平台——各有利弊。进入所有这些可能是压倒性的，我们可以就每个选项持续几个小时。但是，我们今天在这里谈得更一般一些。因此，我们将把所有这些留到下一次。现在，让我们后退一步，谈谈您正在考虑的任何基础设施即代码自动化平台的五大必备条件。因为每个公司和用例都是不同的，我们将不分先后地讨论这些考虑事项。

## **基于角色的访问控制(RBAC)**

第一个因素非常重要。我知道我说过我没有按任何顺序讨论这些，但对于任何研究 IaC automation 的人来说，这应该是最重要的。我们讨论了当您跨团队扩展时，自动化 IaC 如何会导致可见性问题。例如，您可能想知道谁部署了什么、何时、何地以及为什么部署。通常，您想要这种可见性的原因是您想要控制所有这些方面。这样你可以帮助限制浪费、预算问题、安全问题等等。您可能希望提供自助部署访问，但仅限于某些参数；也许只对某些人或团队。拥有粒度 RBAC 可以帮助您设计出最适合您的组织及其需求的安全策略。一些工具具有这种特性，一些需要一些工作来使它工作。关键是您应该对您的部署过程有某种形式的控制。

## **自托管代理/运营商**

遵循安全思路:很多 IaC 自动化工具都是 SaaS 平台。SaaS 可以非常安全。但有时，出于合规性或法规方面的原因，您可能希望对部署保持更多的控制。这就是自托管代理或运行程序的用武之地。这种类型的设计允许您以自己的方式保护您的“秘密”，例如您的云凭据和其他敏感可变信息。您可以使用任何您想要的秘密管理解决方案，无论是来自您的云提供商还是另一个第三方解决方案。它还允许您保持代码安全。当部署您的代码时，所有这些工具都必须获得要部署的代码的副本。因此，他们会进行“Git 克隆”或某种文件复制过程，从存储文件的地方获取文件，并执行它们。如果这是一个 SaaS 解决方案，那么他们基本上可以访问你的代码。同样，这对一些人来说可能不是什么大问题，但对其他人来说却是如此。如果你不想给第三方这种级别的访问你的代码和秘密的权限，一个自托管的代理或运行程序可以帮助你保持所有的安全和在你的控制之下。

## **拉式请求计划**

对于工作流来说，这是一个很大的特性。有些人可能甚至不知道拉动式请求(PR)计划有多重要，直到他们意识到它可以让他们的生活变得多么简单。根据平台的不同，这个特性的名称可能会有所不同。关于 PR 的计划，PR 计划，投机计划等。本质上，这意味着每当您针对分支打开一个 pull 请求时，您的自动化平台将完成一个部署，直到“计划”阶段，这样您就可以确切地看到这个代码更改将会做什么。例如，如果您不小心在变量或代码文件中添加了一个额外的 0，您可能会得到 100 个实例，而不是 10 个。理想情况下，您希望在部署变更之前知道变更会发生什么，这样您就可以在实际发生之前快速修复潜在的错误。在 DevOps 中，您总是希望“更快地失败”,并关闭循环，以便在重大错误发生之前发现它们。这就是这个特性如此重要的原因。如果您选择的自动化平台做得正确，当它运行这个计划阶段时，它会自动直接用可能的更改作为注释来更新拉请求。这样，您的开发人员可以在尝试将部署合并回主分支以部署到生产环境之前，看到将要发生的事情。如果他们更进一步，将服务检查添加到拉请求中，您甚至可以配置它，以便如果部署计划由于任何原因失败，开发人员实际上完全被阻止合并 PR，直到它被解决。所有这些特性都有助于实现在 GitOps 方法中工作的能力。不要让我开始胡乱滥用术语 GitOps——它非常具体。虽然 GitOps 的中心支柱之一是使用您的存储库作为您应该部署什么的“真实的单一来源”,但它不仅仅是使用 Git 来存储您的 Terraform 文件；它是通过拉请求方法的基础设施管理。如果你想了解更多关于 GitOps 的信息，可以在这里 阅读更多 [。](https://www.gitops.tech/)

## **连续部署**

这个特性对大多数人来说是必不可少的。但是，根据工作流程的不同，它可能不太重要。即使它现在不是必备的，但当您发展和成长为新的工作流时，它可能会出现。连续部署是自动化平台拥有 webhook 或其他到源代码存储库的连接的能力，以便它可以在您提交或推送到存储库时自动触发部署过程。这个特性与我们刚刚谈到的计划拉取请求特性密切相关。为了使该功能正常工作，还需要 CD 功能。现在，我想确保我澄清。仅仅因为您启用了持续部署，并不意味着每次提交或推送完成时，它都会在一天当中推送到生产环境中。您仍然应该能够在计划阶段之后暂停部署过程。通过这种方式，您可以在批准部署之前验证计划是否可以接受。对于一些用例，比如开发人员沙箱，您可能会“自动批准”部署，因为您不在乎必须首先获得验证。这完全取决于您的工作流程和过程。一个好的平台会让你有能力掌控这一切。

## **左移扩展性**

这个有点不确定。根据不同的情况，它可能意味着很多不同的事情。本质上，我在这里谈论的是在部署过程中集成——或者至少是可互操作的——许多其他工具的能力。有一个叫做 [持续验证](https://thenewstack.io/continuous-verification-the-missing-link-to-fully-automate-your-pipeline/) 的概念，意思是将一些遗留的工具和流程转移到部署流程中，这样您就可以在问题开始之前掌握它们。在前面的 PR plan 特性部分，我们讨论了在部署之前捕捉问题。这不仅仅是资源配置的问题。那么[的安全问题](https://devops.com/?s=DevSecOps)呢？合规问题？性能问题？甚至是预算问题？如果您的 IaC 自动化工具使您能够将用于验证这些东西的过程和工具集成到部署过程中，那么它们就不再是事后的想法了。如果您在每次部署时都不断地验证预算，您就永远不必担心超出预算。如果您在每次部署期间都验证安全性，就不必担心安全性问题。这种类型的功能在不同的工具之间可能会有不同的外观和命名。但只要你有能力获得所有这些其他群体(安全、金融等。)参与得越早，大家都会过得越好。就像我们之前说过的，在 DevOps 中，越快失败越好。将这些检查集成到您的部署中可以帮助您实现这一目标。

**结论**

我们已经通过了所有五个！我们已经讨论了一些基本的安全特性。我们讨论了一些自动化工作流必备组件，让您的生活更加轻松。我们甚至触及了一些下一步要研究的事情，如持续验证。这已经很多了——希望这对任何研究 IaC 自动化平台的人都有帮助，并且您现在已经知道要寻找什么了。有些功能可能名称不同，但背后的思想是一样的。如果你的平台做不到这些，可能就不是适合你的。或者，可能是这样的，而这个特性对你来说并不重要。正如我提到的，您的里程可能会有所不同。每个组织都不一样。

* * *

要了解更多关于云原生的话题，请加入[云原生计算基金会](https://cncf.io/?utm_content=sponsor-disclosure)和云原生社区，地址:[kube con+CloudNativeCon North America 2021–2021 年 10 月 11 日至 15 日](https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/)