# 门控进展的涅槃

> 原文：<https://devops.com/devops-nirvana-gated-progression/>

一套功能强大的企业级 DevOps 服务的基本目标是完全自动化。老实说，拥有正确的 DevOps 策略师(或有远见的人)来领导这项工作，对于实现这个目标来说，与必须解决的所有挑战和主题的组合一样重要。所以为了讨论，我们假设你有一个(如果没有，请随时联系我——我现在正在看🙂 ).

有了关键的领导，首要目标总是构建和部署过程的自动化。这很容易被认为是 DevOps 的核心或心脏。但是一旦实现了这种自动化，发布协调这个更棘手的话题就开始出现了。策略是释放编排，就像味道对于食物一样:有一个正确的编排会带来很大的不同。

为了使我们的代码进入生产阶段，固有的假设是所有的测试都已经成功完成。听起来像是常识。但是，有多少测试是人工进行的呢？用户验收测试(UAT)规程本质上需要人来掌控。但现实是，每当人类必须与从开发级环境到生产途中的所有测试环境(集成、性能、用户接受度和 QA)的代码进展进行交互时，创新的势头就会放缓——一直到人类的水平。

## 测试类型的复杂性

第一个自动化测试开始出现在开发或(DEV)类环境中，程序员在严格的指导下实现测试驱动的开发。这需要新的特性/功能测试，作为开发中构建或部署自动化的一部分。如果附带的测试没有“通过”，那么构建或部署都不能说是成功的这也代表了我们的第一个“门”复杂的发布协调(RO)软件可以检查在构建或部署过程中设置的“标志”,以查看测试是否已经成功完成。如果是这样，代码可以进入软件开发生命周期(SDLC)中的下一个测试级环境。

在 SDLC 早期完成的另一种有用的测试类型(最常见于开发中)是检查代码覆盖率。开发组织可以开始检查他们的代码有多少被测试，并在目标应用程序能够前进之前设置任意的百分比作为最低标准。在开发类环境中增加替代类型的测试确实增加了创新工作的质量。然而，它带来了在测试下的版本的自动化进展——和审计——的增加的劳动力。

例如，特性/功能测试可能使用一个单一的存储库来存储给定版本代码的结果。我去了我的测试库，我可以从我的应用程序的 1.4 版本或 1.5 版本中查找我想要的结果。如果监管官员或内部审计员要求我证明我的应用程序 1.5 版本的质量，我只需要咨询我的测试库，并向他们展示在我的应用程序 1.5 版本部署到生产环境之前，执行了多少测试，有多少测试通过或失败。

当您将代码覆盖测试添加到流程中时，我现在需要咨询两个不同的测试存储库，生成两个独立的报告来评估我的应用程序的相同版本的质量。这没有错，但是与使用单个测试存储库相比，这确实会产生更多的工作或精力。随着我们不断增加用于证明质量的工具种类，这个问题只会越来越严重。例如，安全测试(确保代码没有固有的安全漏洞)倾向于使用不同的工具，或者，更糟糕的是，需要人类同行观察的过程，这又会增加创建自动化和审计可追溯性的工作量。这些是测试(和/或过程)的关键类型，因此它们必须完成，但是它们也伴随着自动化工作的内在成本。

小型企业可能不担心这些问题，但是大型组织会担心，特别是如果他们仍然处于从遗留的瀑布方法(在那里控制很高)到新的敏捷方法(在那里审计员感觉像狂野的西部)的过渡过程中。编译一个测试日志，使之与被审查的代码版本相匹配，这样它就可以自动地被复制，这将恢复内部审计员和来询问的监管官员的信心。但是添加每一种新的测试工具都需要更多的努力来维护编译这些测试日志的能力。

## 测试反应的复杂性

接下来，考虑非二进制响应对门控代码进展的自动化工作的影响。我的功能有用吗(是/否)？这是一个二元评估，真/假或是/否，很容易设置我的进度标志以测试响应。评估我的代码覆盖率的结果并确保这个应用程序超过 70%或者在 70%到 90%之间是另一回事。这类问题不是二元的(换句话说，有一个真实的结果可以比较，而不仅仅是通过/失败)，并且需要进一步的努力来设置门控通过/失败的二元标志。当评估问题根本不打算给出二元答案时，比如从 1 到 5 的评分，其中 1 代表糟糕，5 代表优秀，我现在通常会强迫一个人做出关于代码是否应该继续的明智决定。

多个测试存储库需要额外的自动化工作。多种类型的响应需要额外的自动化工作，通过或失败的标准也可能随着时间的推移而改变，需要在进行测试时跟踪目标。创建可以从构建过程或部署过程中调用的独立测试自动化是明智的。关联这个测试自动化(无论是脚本还是模拟，等等。)同版本的应用程序代码是明智的。努力减少要检查的存储库的数量是明智的。严格地从构建中分离测试自动化，允许在需要的时候在更高级的测试环境中重新执行。

## 绘制涅槃之路

RO 受益于尽可能全面的自动化水平。我将在另一篇文章中更全面地讨论 RO 主题，但是自动化变更进展的基础依赖于证明质量的门控历史。只要被审查的代码继续通过测试，将进度标志设置为绿色或“是”或“通过”，RO 软件就可以继续沿着生产的道路前进。失败的代码必须被送回开发环境，在那里开发团队可以解决问题，然后从头到尾再一次通过自动化过程。

如果组织有意决定让人类充分参与测试和评估周期，它必须意识到该决定的一些影响。日常的生产活动变得不太可能——通常需要一到两周的时间来对变更进行大量的人工审查(取决于测试自动化的水平)。人类智能决策的结果也必须记录在测试库中，以便为审计保存历史。当出现问题时，这可能会导致一种“责备游戏”式的思维，因为它会立即与“谁”批准它相关联，而不是与他们“为什么”这样做相关联。显然，劳动力成本在任何创新周期中都是最高的成本要素，所以在这种情况下，买家要小心。

另一方面，“涅槃”是所有测试(除了 UAT)完全自动化和门控的状态，并为 RO 软件提供了基础，以便尽可能频繁地将代码转移到生产中来证明质量。这可能意味着完全自动化的发布，而不是周末发布。这可能意味着每天都有多个版本投入生产。这可能意味着发布本身不再被认为是“事件”，而是默认为“非事件”涅槃不会危及变更和发布经理的生命——它实际上给了他们一个生命。为了一个“改变”(原谅这个双关语)，他们开始发现一些他们依稀记得的东西…工作之外的生活。

要继续对话，请随时[联系我](/cdn-cgi/l/email-protection#5a312833292e333b3474343f362935341a32352e373b333674393537)。