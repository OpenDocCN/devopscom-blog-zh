# 3 开发运维安全最佳实践您的组织不容忽视

> 原文：<https://devops.com/3-devops-security-best-practices-your-organization-cant-afford-to-ignore/>

CI/CD 管道是当今许多企业日常运营的核心。这些过程，当设置正确时，通过自动化许多手工任务和提供软件如何工作的可见性，有助于保持交付过程的一致性。

DevOps 也是您的基础设施访问许多不同资源的技术平台，从开发和生产环境到分析密钥和代码签名凭证。您的管道可以访问的资源越多(安全机密、专有代码、数据库等。)，保持 CI/CD 系统的安全就越重要。

在本文中，我们将讨论 CI/CD 管道 DevOps 安全性的不同部分，并重点介绍一些改进这些方面的方法。我们通常将安全实践分为三个部分，您可以使用不同种类的解决方案来解决:

1.  安全管道配置
2.  代码和 Git 历史分析
3.  安全策略实施

这三个方面同等重要。让我们更深入地了解一下这些类别以及解决它们的方法。

## **安全管道配置**

使用您的 CI/CD 管道配置可以降低发生安全问题的可能性。

首先，安全地存储您在连接数据库和第三方服务的管道中使用的秘密。根据您使用的 CI 平台，您可以选择使用静态加密环境变量，或者使用上下文功能。上下文用于提供对跨项目的环境变量的访问。它们的使用也可以由组织的管理员限定为特定的安全组成员。

另一个选择是使用第三方解决方案，为您的工作从他们的安全存储中动态获取机密。为了确保您的凭证不会暴露给不应该看到它们的人，您不应该以纯文本的形式将这些凭证签入到您的存储库中，即使存储库是私有的。

其次，对于像代码签名密钥这样的敏感文件，我建议在加密文件和存储库之间增加一层隔离，以增加安全性。在存储库中对它们进行加密，并将解密密钥存储在环境变量或上下文中，仅在需要时在 CI/CD 作业中对它们进行解密。这使得暴露或泄露这些高度敏感的文件变得更加困难。

第三，您绝不能让您的 CI/CD 环境在没有监控的情况下运行。因此，确保在需要敏感信息的作业完成运行后销毁用于管道的容器和虚拟机。

第四，额外注意你的 CI/CD 系统如何处理来自你的库的分支的拉请求的构建。如果您的构建阶段需要秘密来工作，分叉的拉请求可能会通过您的管道获得对它们的访问。

通过解决这四个方面的问题，您可以显著降低 CI/CD 管道配置带来的安全事故风险。接下来，代码和 Git 历史分析。

## **代码和 Git 历史分析**

我们都喜欢 Git 全面的变更历史，能够用一个简单的 CLI 命令浏览项目的历史，并看到谁最近修改了一行代码，还有其他好处。这也意味着，如果 Git 存储库被暴露，任何进入 Git 历史的敏感信息都可能被攻击者访问，即使存储库的最新状态不再包含秘密。

[**松露猪**](https://github.com/dxa4481/truffleHog) 和 [**GitLeaks**](https://github.com/zricethezav/gitleaks) 这两个工具可以帮助你识别已经提交到代码库中的秘密，以便你可以停用和替换它们。这两个工具还将扫描您的 Git 历史，寻找您的团队在过去可能已经添加到存储库中的秘密的痕迹。

一旦你的 Git 历史没有秘密，你就可以进入下一个阶段:确保你当前的版本不包含任何易受攻击的依赖项。

**静态应用安全测试(SAST)** 技术可以检查提交的应用并分析其依赖关系。如果任何依赖项包含任何问题或已知的安全漏洞，您的提交将被标记为不安全，并且不允许进行部署。

**动态应用安全测试(DAST)** 技术更进一步，在您的 CI 作业中旋转生产环境的副本，以便扫描生成的容器和可执行文件。动态方面有助于系统捕捉在启动时加载的依赖项，例如，SAST 不会捕捉到的依赖项。

## **安全策略实施**

有些安全方面无法基于已知漏洞进行静态检查，而是特定于您的特定公司，因此需要作为策略进行整理。这些可以采取自动或手动合规性检查的形式。

某些任务将是手动的，例如审查有权访问您的存储库的所有帐户的列表，或者确保您的入职和离职流程同步。我们建议您设置提醒来定期执行这些操作。

有些任务实际上很容易实现自动化。例如，第三方服务可以提供一种便捷的方式来编纂一组规则，这些规则将在您的 CI 渠道中进行匹配，例如，证明符合管理您的数据的法规。如果不匹配，构建将会失败。

## **一些重要的零件不能自动化**

如今，保持 CI/CD 管道的安全比以往任何时候都更加重要，因为自动化 CI/CD 实践需要比过去更多地访问开发和生产环境、分析密钥和代码签名凭证。关于安全性的困难之处在于，如果你只答对了三个类别中的一个，你就不会有 33%的安全性。你将 0%安全，直到你得到所有的基地覆盖。

有了上面列出的方法，你会比没有它们时更安全。但是，对于 CI/CD 安全性来说，一些最重要的方面是无法自动化的，也无法通过自动化策略检测到。这些方面是由你的团队的行为和文化决定的。

## **开发人员的心态**

您的团队是您最有价值的安全研究人员，因为他们最了解您的应用程序，并一直致力于这些应用程序。如果您的团队成员发现任何安全问题，您是否为他们实施了一个清晰的报告流程，您是否花费时间来修复他们发现的安全缺陷？你会表扬那些公开报告问题的人吗？在许多公司里，答案并不是立即“是”,而且应该是“是”。

您团队中的某个人需要多长时间来报告可疑活动？他们是否需要在多个闲置渠道发布帖子来吸引注意力，或者是否有一个简化的流程来调查这样的问题？你如何对待那些报告误报的人——你会责怪他们浪费团队的时间，还是进行一次无可指责的事后分析，以便团队中的每个人都能从错误中吸取教训？所有这些问题都可能成就或破坏您注重安全性的开发文化。