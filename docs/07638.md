# 实现可靠的可观测性第 1 部分——使云原生可观测性更加鲁棒

> 原文:[https://devo PS . com/making-cloud-native-observability-more-robust/](https://devops.com/making-cloud-native-observability-more-robust/)

作为 AIOps/可观察性研讨会的一部分，我与一位 CxO 级别的客户进行了一次对话，据我所知，大多数人对如何正确运营云原生生产环境感到困惑，尤其是监控/可观察性部分。对话是这样进行的。

“Andy，我们正在考虑让[供应商]根据您最近的研究来使用我们的可观察性解决方案。你怎么看？”

“嗯，我不想支持任何特定的供应商，因为他们都擅长自己的工作。但让我们来谈谈你想做什么，他们能为你做什么，这样你就能弄清楚他们是否适合你。”对话持续了一会儿，但最后一段还是值得具体叫出来的。

“因此，我们将在 ____ 地区的 AWS 中运行我们的生产微服务。我们计划使用这个特殊的可观测性提供者来监控我们的 Kubernetes 集群。”

“有几个项目要讨论。首先，您意识到您所说的这个特定提供商也在与您相同的云提供商的同一地区运行，对吗？”

“我们并不知道。这会是个问题吗？”

“不是特别喜欢。然而，你可能会陷入‘循环依赖’的境地。”

“那是什么？”

“作为一名企业架构师，我总是呼吁将职责分离作为最佳实践。例如，让您的开发人员测试代码是一个坏主意，让您的开发人员弄清楚如何部署是一个坏主意。就像您的生产服务与您的监控软件在同一个区域运行一样，如果云区域受到影响，并且您的可观测性解决方案与您的生产服务同时停止运行，您如何知道生产中断？”

"我们是不是应该扔掉它们，转而采用另一种解决方案？"

“不，我不是说这个。弄清楚你想要达到的目标，并为之制定一个计划。对可观察性工具的选择应该符合你的总体战略。”

对于那些不理解上述对话的人来说，这里是为什么这种情况可能是一个问题的原因。

来自[企业架构](https://devops.com/?s=enterprise%20architecture)背景的我们被教导，作为一种最佳实践，要操作生产系统以避免循环依赖。这包括不要让两个服务相互依赖，或者不要将监控、治理和法规遵从性系统作为生产系统本身的一部分放在一起。如果您要监控您的生产系统，您将从一个单独和隔离的子系统(服务器、数据中心机架、子网等)进行监控。)来确保如果您的生产系统出现故障，监控系统也不会出现故障。公共云区域也是如此，尽管不太可能，但个别区域和服务确实会经历中断。如果您的生产基础架构在与 SaaS 监控提供商相同的地区运行相同的服务，您不仅不会意识到您的生产系统停机，而且也不会有数据来分析哪里出了问题。拥有一个好的可观察性系统背后的整个想法是快速知道事情何时变坏，哪里出了问题，问题在哪里，为什么会发生，这样你就可以快速修复它。你可以看看[的博客，我会在里面详细解释。](https://thefieldcto.com/aiops-vs-observability-vs-monitoring-what-is-the-difference-are-you-using-the-right-one-for-your-enterprise/)

最佳做法是:

1.  考虑一个可观察性解决方案，它运行在与您的生产工作负载不同的区域。更好的是，考虑一下在不同的云提供商上运行的东西。尽管这种情况非常罕见，但是跨地区的云服务中断还是存在的。两家云提供商同时倒闭的可能性很小。例如，如果云区域关闭(云中很可能出现区域范围的中断，而且最近似乎更加频繁)，那么您的可观测性系统也将关闭。除非您有一个“热”生产备份，否则您甚至不会知道您的生产服务器停机切换到备份系统。您的客户不仅会在您之前发现您的停机，而且您甚至无法启动您的行动手册，因为您甚至不知道您的生产服务器已经停机。
2.  考虑将您的可观察性解决方案放在不同的位置/地区，但仍然离您的生产服务足够近，因此延迟非常低。大多数云提供商都在附近运营，所以很容易找到。
3.  另一个选择是获得一个为您提供部署灵活性的解决方案。例如，有几个可观察性解决方案允许您将它部署在任何云中，并从任何地方观察您的生产系统——无论是在云中还是在本地。
4.  您还可以考虑将监测数据从您的仪器发送到两个可观测性解决方案位置，但这将花费您更多的钱。或者，询问供应商的业务连续性/灾难恢复计划是什么。虽然有些人认为成本可能会高得多，但我不同意，原因有两个。首先，因为监控主要是时间序列度量数据，所以传输的量和成本不像日志或跟踪那样高。其次，除非你的可观测性提供商是 VPC 对等的，否则你的数据很可能会通过互联网传送，即使它们托管在同一个云提供商那里。因此，不会有更多的额外费用。在停机期间，始终拥有关于生产系统的可观察性数据是非常重要的。
5.  一个经常被忽视的考虑是监控你的全栈可观测性系统。虽然最好在生产服务运行的每个区域都有监视实例，但由于成本或可管理性的原因，这可能不可行。在这种情况下，监控监控系统。您可以通过检查监控 API 端点(或者进行随机数据输入并检查以确保其工作)来进行综合监控，以确保您的监控系统正确地监控您的生产系统。更好的办法是，找一个能代表你做这件事的监控供应商。

当/如果你在凌晨 2 点接到可怕的电话，你的行动计划是什么？只要在事情发生之前想清楚，准备好剧本，这样你就不会在危机中惊慌失措。