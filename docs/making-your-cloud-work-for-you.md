# 让您的云为您服务

> 原文：<https://devops.com/making-your-cloud-work-for-you/>

您的云为您工作，还是您为您的云工作？鉴于与云计算相关的巨大依赖性和成本，这是目前越来越多的 DevOps 团队提出的问题。在十多年来高层要求将工作负载转移到公共云的压力下，DevOps 团队现在面临的现实是，有太多的云。

别想歪了。我在这里不是要告诉你云本质上是不好的，或者我们应该回到所有关键工作负载都在办公室后面的壁橱中的裸机服务器上运行的时代。公共云服务提供了许多关键优势，开发运维团队应该充分利用这些优势。

然而，要负责任地使用云，控制两个风险至关重要。首先是云计算成本，如果管理不当，很容易失控。第二个是对公共云服务的严格依赖，这会削弱敏捷性，并使大规模部署应用程序变得更加困难，这与云应该做的事情完全相反。

在本文中，我们将了解导致这些风险的原因，以及 DevOps 团队如何做出响应，以确保他们的云策略真正交付价值。

## 风险 1:云计算成本

你可能听过很多关于云如何省钱的讨论。如果你有效地使用云，那是真的。然而，由于云计算成本结构的复杂性以及将云计算成本与内部成本进行比较的困难性，[在支付了比您预期的高得多的云计算账单后，很容易以云后遗症告终](https://www.stratoscale.com/blog/cloud/avoid-cloud-hangover-keep-cloud-on-prem/)。

在预测和了解您的云的真实成本方面，有几个明显的挑战。让我们来看看每一个。

### 永不停息的云计算成本

当您将工作负载迁移到云中时，您的成本会逐月变化，并且会随着时间的推移而分散。起初，迁移到云感觉像是一个很好的省钱之道，因为它让您不必预先购买大量的本地硬件。然而，正如从长远来看，对大多数人来说，租车的成本最终会比拥有车的成本更高一样，每月为别人的基础设施上托管的云服务付费也会增加。如果你忽略了这个事实，你可能最终无法意识到你的云计算账单的长期真实成本。

### 不可预测的云成本

与内部部署相比，云计算成本的另一个根本挑战是，在云中，成本结构不透明且不可预测。公共云供应商不经通知就改变服务价格。相同的服务在一个云区域的成本可能比另一个更高，而一些服务有多项附加费用。例如，如果你在公共云中存储数据，你不仅要支付每千兆字节的存储费用，还要支付每次移动数据的费用。这给预测你真正的云计算账单增加了巨大的困难。

当然，内部成本也不完全容易预测。有一些波动的费用，如电费。然而，本地计算成本的最大部分是硬件本身，这是一项非常简单且切实的支出。这也是一次性支出，可以在服务器的生命周期内分期偿还。一旦您购买了服务器，您就不必担心它的有效成本会逐月变化，就像您在公共云中购买虚拟服务器一样。

### 被忽略的工作负载

在云中，增加新的工作负载非常容易。当您不再需要某个工作负载时，也很容易让它继续运行，而且当您有已激活但闲置的资源时，公共云供应商不会特意通知您。你不能责怪他们；这就像一个餐馆告诉你你点了太多的食物，或者一个建筑商告诉你你的房子比你需要的要大。

如果您不仔细管理您的云工作负载，它们会增加额外和不必要的成本。

当然，您也可以在本地环境中运行不必要的工作负载。但不同之处在于，每个额外的工作负载不会带来大量的内部成本增加。您已经为服务器支付了费用，并且没有为您在自己的基础架构上运行的每项服务付费。

## 风险 2:缺乏云灵活性

除了不必要的成本或低效的成本结构，过度依赖公共云也会削弱开发运维团队的敏捷性。

当您在公共云中运行服务或工作负载时，将其转移到不同的基础架构可能会面临挑战。不仅通常很难从一个云迁移到另一个云，而且这样做需要适应新的成本结构，并可能为同一组服务支付更多费用。

这里有一个讽刺:传统观点认为，迁移到云的一个主要原因是云天生比内部基础设施更具可扩展性和灵活性。在某些情况下，这可能是真的，但是当您考虑从一个云迁移到另一个云的成本和难度时，云很快就会变得不那么灵活和可伸缩。

当然，内部基础架构也不总是能够轻松扩展。我对此没有异议。但是当谈到可伸缩性和敏捷性时，云并不总是如宣传的那样。内部部署和基于云的基础架构在这方面都有局限性。

## 切断绳索:让云为您服务

既然我们已经确定了云计算固有的(且未被充分认识的)成本和灵活性挑战，那么让我们来考虑解决方案。

### 优化云计算成本

成本优化是任何基础设施都应该做的事情，云也不例外。

有许多关于云成本优化的指南。一些供应商还提供工具，用于监控您的云工作负载，识别未充分利用的资源，或者帮助您调整云服务实例的规模。这些都是帮助你减少云计算账单的好方法。

### 与云无关

另一个有用的策略是以尽可能与云无关的方式来设计云工作负载。不要与特定的云供应商的服务深度集成，尽可能依赖第三方工具。

例如，如果您在云中运行容器化的应用程序，请在标准虚拟服务器实例中运行容器，并使用第三方注册中心，而不是使用一个云供应商的容器注册中心和托管容器服务。这将需要您做更多的工作，但是它会让您自由地将工作负载轻松地转移到另一个云。它还支持经济高效的可伸缩性，因为您不必受制于与供应商的托管容器服务相关的成本结构。相反，您只使用虚拟服务器实例(可能还会附带一些存储)，这些实例在公共云上的定价要灵活得多。

### 不要害怕内部部署

我的最后一个建议，也是最重要的一个建议，是采用内部基础架构。

再说一遍，我这样说并不是因为我想倒退，回到一个一切都在内部运行的世界。我不是反云。

然而，从成本和灵活性的角度来看，公共云并不是每种工作负载的最佳选择。公共云中具有非常复杂的成本结构的工作负载，或者在不牺牲大量移动性和可扩展性的情况下难以在公共云中运行的工作负载，通常更适合内部环境。

您可能认为采用内部部署意味着牺牲云的所有优势，或者必须放弃云原生工作负载。幸运的是，事实并非如此。有些软件供应商提供公共云的服务，但是是在您自己的企业基础架构上使用公共云 API。

因此，您可以获得内部基础架构的成本和灵活性优势(更不用说安全性优势)，同时仍能运行云原生应用。事实上，您甚至不需要检修您的 CI/CD 管道；您只需将您的云原生应用交付到内部基础架构上，该基础架构运行旨在与公共云兼容的服务，即使它们托管在您自己的服务器上。

## 结论

不要仅仅因为似乎应该这样做或者因为有人告诉你这样做一定更好，就将工作负载迁移到云。一些工作负载在云中工作得更好，而另一些工作负载最好在内部托管。全方位云策略通常不是您可以采用的最具成本效益或最敏捷的架构。

— [阿里尔·迈斯洛斯](https://devops.com/author/ariel-maislos/)