# 为微服务安全构建坚实的基础

> 原文：<https://devops.com/building-a-solid-foundation-for-microservices-security/>

威胁的发展速度往往超过开发实践和技术的发展速度，这一点在当前应用程序开发的微服务方法中可以看出。虽然微服务通过模块化、可独立部署的服务支持应用部署，为开发人员带来了明显的好处，但它们也为新的安全漏洞打开了大门。

因此，软件开发方法的这些变化要求开发人员改变他们关于如何考虑和实现安全性的思维方式。安全性现在必须是每个服务的核心组成部分——能够承受这些交互服务不断变化的特性的安全性。每个服务必须是一个有弹性且安全的单元，能够与其他应用程序和服务进行交互，而不会影响安全性。此外，每个服务必须小心处理边缘数据的方式，以确保每个可能的交互都是安全的，即使与不符合所需安全标准的服务进行交互也是如此。

为了完全解决这些安全挑战，开发人员还需要改变他们在代码中处理隐私和安全的思维方式。这意味着从程序的起源和代码本身考虑安全性，而不是依赖基础设施来保护应用程序。这种方法使开发人员能够通过将安全性视为代码的基础而不是附属品来开始他们的架构决策。

## 从一开始就确保安全

从更大的角度来看，DevOps 团队必须充分意识到并理解没有单一的安全方法，安全和隐私问题必须具体情况具体分析。虽然还可以有更多，但是开发人员可以做五件事情来使微服务安全性成为开发过程的基础。

### 划分

首先，开发人员必须开始划分软件开发任务，试图使他们的微服务尽可能重要。尽管如此，开发者必须小心不要走极端，否则会产生一大群执行单一任务的纳米服务。总体目标是将责任减少到这样一个程度，即每个单独的流程缺少足够的信息，如果被违反，就会成为一种责任。

### 加密

加密在开发人员的新思维中扮演着重要角色，因此必须对每个微服务需要的所有数据进行加密，并通过易腐通道发送。这允许取消受损的通信信道、轮换所使用的加密密钥以及在不同的信道上重试消息或向不同的节点重试消息，而不用担心泄露。

一个很好的例子是在高可用性(HA)布局中失去控制的节点。通过取消所有消息队列并使用旋转密钥重新发送消息，可以继续运行，而不用担心无响应的节点可能会受到威胁，并避免完全停止。

### 一次性频道签名

通过向他们控制下的服务发送可任意处理的信道签名和加密数据，开发人员将极大地改善他们在软件开发生命周期(SDLC)中的安全状况。这将允许他们取消凭证，并避免数据泄漏，即使在节点上的控制丢失时也是如此。

### 不同的钥匙

开发人员开始理解使用尽可能多的不同密钥的功效，因为存储在加密方面是一个弱点。另一种方法是使用定期轮换的密钥。然而，这需要绕过持久性解决方案并重新加密大量数据，这并不理想。此外，加密层将确保存储密钥的一次泄漏不会授权访问普通数据。此外，使用不同的密钥进行存储和传输也很重要，因为读取时重新加密很容易。这一过程避免了分散键并保持键紧密的需要。

### 关键字存取

最后，开发人员将受益于确保所有键都允许尽可能少的访问，同时记住他们需要尽可能地根据每个键的目标用途来定制生存时间(TTL)。尽管这种方法可能会导致复杂的权限架构，但它在遵守安全最佳实践的同时，大大减少了攻击面。

## 结论

其中一些可能是常识，对一个开发人员有用的东西对另一个开发人员可能不够。一般来说，对开发人员来说，定期挑战他们编写的每个服务中的这些假设是有好处的，但是上面制定的准则将通过提供一个稳定的基础来开始他们的思考，从而很好地服务于几乎每个开发人员。他们应该采取的普遍观点是，安全性必须是他们软件 DNA 的一部分。

奥拉西奥·杜兰