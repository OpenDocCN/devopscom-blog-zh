# 与 MSIX 一起打造可靠的应用安装体验

> 原文：<https://devops.com/building-a-reliable-app-installation-experience-with-msix/>

简单、安全、可靠的软件安装和卸载总是最好的，但要做到这一点并不容易。应用程序会互相破坏，甚至破坏操作系统本身。

[【MSIX】](https://docs.microsoft.com/en-us/windows/msix/overview)，微软的打包格式，是几十年来微软软件安装程序(MSI)和 setup exe 安装程序技术的最新替代品。由于 MSIX 提供的好处:安全性、易用性和应用程序安装的可靠性，它正被越来越多的人接受和采用。

MSIX 提供了一个全新的现代运行时环境，旨在保护您的应用程序和最终用户系统。企业用户更喜欢 MSIX 格式，因为它为[实现应用程序现代化](https://devops.com/?s=modernize+applications)提供了最合适的框架；同时减少 IT 部门在准备交付给成百上千最终用户的应用程序包时的工作量。

随着构建 Windows 桌面应用程序的开发人员接受在 MSIX 容器中运行代码的概念，理解某些关键概念可以简化和增强他们的应用程序安装体验。

## 为什么是 MSIX？

在 MSIX 容器中运行代码可以解决来自非容器化部署的开发人员遇到的常见问题。这包括作为 Win32 构建和交付的产品。或者当从头开始一个新项目时。

除了提供干净的安装和卸载流程，MSIX 还通过修改包实现独立包中的企业定制。它还支持通过企业工具(例如，微软端点管理器)或云(Azure 虚拟桌面、MSIX 应用附加)部署应用的能力。

## 对开发人员和 IT 专业人员的价值

MSIX 改进了更具限制性的 UWP 模型，同时仍然在容器中运行。它允许开发人员以他们喜欢的方式编码(例如，使用 Windows 窗体的非托管代码，使用 XAML 和调用 Win32APIs 或托管代码)。NET 框架版本的 API)。

然而，一些策略必须改变以在 MSIX 容器内运行。除了最大限度地减少工作，它还有助于构建现代 it 生态系统，更快、更频繁地部署应用程序和更新，并将应用程序现代化到集装箱化软件包的新世界中。

MSIX 还支持通过企业工具(例如，微软端点管理器)部署应用程序，甚至部署到云。

## 对用户的价值

通过为用户提供更加简化的安装体验，MSIX 为客户和最终用户带来了诸多好处，包括:

*   **保证全新安装**:这可以防止在安装、卸载、重新安装或其他已安装应用程序出现的问题上浪费时间。
*   **应用程序之间的隔离**除非不需要隔离。
*   **更高的安全性**保护客户和应用。
*   **改进的功能**包括自动更新、差异更新和磁盘空间优化，无需定制代码或打包流程。
*   **单实例存储；**对任何已安装软件包中的任何文件进行自动块级重复数据删除。
*   **更少的支持电话:**这减少了所有相关人员的烦恼、延误和费用。

## 成功的 MSIX 项目的要素

MSIX 项目需要一种不同于许多开发者习惯的方法。为了向客户提供尽可能最好的程序包文件，请考虑将以下元素作为项目的一部分。这样做将加强额外的项目活动、项目设置、测试和调试以及支持的模式。

1.  **数字签名**:通过将应用程序安装到应用程序容器并使用数字签名(使用有效的代码签名证书)强制应用程序包，提供 MSIX 包的安全安装。仅安装受信任的应用程序，在部署后加强包及其容器的完整性。
2.  **包组件:**MSIX 包包括本质上是一组成分的文件——有些是直接生成的(例如，开始菜单的图像文件),有些是作为构建过程的一部分创建的(例如，其他供应商工具的输出)。成分文件(包括根和虚拟文件系统(VFS)文件夹)将被传递给 MakeAppX 命令来生成包。
3.  一个高效的 MSIX 构建过程:有时需要对一个包进行定制修改，比如当 PSF 适合处理一些意想不到的场景时；这需要将提取的内容重新打包到 MSIX 包中。无论是否需要这样的修改，高效的构建过程总是必要的。使用微软 提供的 [文档，可以在没有任何打包工具的情况下手工构建 MSIX/APPX 包。或者，像](https://docs.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-manual-conversion) [InstallShield](https://www.revenera.com/install/products/installshield.html) 这样的工具可以自动化这个过程。
4.  **MSIX 捆绑:**。msixbundle 安装确保只安装适用于设备架构的包。MSIX 捆绑包针对不同的系统架构、语言特定的资产、各种图像规模的资产或适用于特定设备的资源。
5.  **修改包:** MSIX 支持创建旨在修改或扩展现有包的修改包。这些允许客户为您的包创建定制的配置或包含一个插件。
6.  **共享包容器:**当使用两个独立的包时，每个包都有自己的开始菜单和其他入口点，共享包容器可能是合适的。这个额外的 XML 文件可以安装在最终用户的计算机上，告诉操作系统这些包应该共享一个容器，而不是相互隔离。
7.  **AppInstaller (XML)文件:**虽然 MSIX 和捆绑文件一般直接安装到操作系统中，但操作系统有助于自动安装和管理更新。微软 now [通过使用 AppInstaller XML 文件执行安装，告诉操作系统在哪里可以找到当前的 msix 文件，在哪里可以找到更新的 AppInstaller 文件以及软件包的更新设置的配置，从而使该功能对外部交付的软件包可用](https://docs.microsoft.com/en-us/windows/msix/app-installer/app-installer-file-overview) 。
8.  **MSIX 核心:** [MSIX 核心](https://docs.microsoft.com/en-us/windows/msix/msix-core/msixcore) 是为原生不支持 MSIX 的老 Windows 版本打造的。这允许在以前版本的 Windows 上安装 MSIX 应用程序(只要这些应用程序是为在那些版本的 Windows 上工作而构建的)。
9.  **基本 AppXManifest 结构:**最后但同样重要的是，MSIX 包中最重要的文件是 AppXManifest 文件，这是一个 XML 文件，它定义了应用程序如何与操作系统集成以供最终用户访问，包括影响运行时容器功能的应用程序模型。尽早了解 AppXManifest 的结构和元素标记(包、属性、资源、依赖项功能、应用程序/应用程序元素标记)将有助于确保适当的项目设置。

随着 MSIX 的不断发展，您的项目也可以不断发展。最终结果将是应用程序包，它不仅简化了 IT 部门的工作，还减少了最终用户的麻烦。