# 保护和防御:仓库

> 原文：<https://devops.com/protect-and-defend-repositories/>

当您创建部署到生产中的工作时，通常会涉及到一个存储库。它可以是代码库、部署中心、权威软件库、虚拟机或应用程序模板库等。

通常，您可能不会再三考虑这些存储库中有什么或者您是否可以信任它们的内容——毕竟，您和您的团队构建了这些存储库，对吗？那可能是真的，但是如果你的信任是错误的呢？

最近的 Target 违规事件说明(除了其他事情之外),您假设部署过程的“收件箱”是值得信任的可能是不正确的。在目标示例中，有一个准备部署的补丁队列，但是有人在没有被注意到的情况下向该队列添加了额外的恶意代码。自动部署过程获取授权代码和恶意代码，并将其分发到网络中的每个销售点设备。不是个好结果。

他们的工作流程包括一个值得信赖的流程，在代码被签入部署队列之前对其进行测试，但是该流程中也有一个缺陷:没有适当的控制来检测任何人何时绕过该流程并对存储库进行任意更改。换句话说，即使您将受信任的包放入队列，这些包也可能被修改，并且可以添加额外的代码，而不会被注意到。

我们可以从这种情况中学到的是“信任但验证”这一屡试不爽的原则的价值:不要假设你可以信任你的存储库而不验证那里有什么。记住这个概念，想想你的环境——有没有人们可以在不被注意的情况下改变的存储库？如果是这样，这可能会给组织的安全性和可靠性带来问题。

为了纠正这一点，我们需要像对待银行账户一样对待我们的存储库——记录所有进出的数据，并持续监控存储库的内容，以查找任何未记录或未授权的“事务”(添加、删除或更改)。我们还必须将验证检查添加到部署过程中，以确保在部署发生之前考虑到所有的事情。是的，这可能意味着您需要在您的部署工作流上做一些额外的工作，为工具添加技术，等等。但是，通过更好的安全性、责任性和可用性，它不仅仅是收回成本。

顺便说一下——同样的原则也适用于您所依赖的脚本和自动化工具。如果有人在你不知情的情况下改变了这些工具，你可能会得到你不喜欢的结果。您还应该考虑到，您的自动化部署存储库并不是不受信任的代码进入生产环境的唯一载体——对生产环境的持续监控也是一项至关重要的活动。

保护和捍卫您的存储库—这很重要。