# DevOps 最佳实践:打破孤岛，避免漂移，优化流程

> 原文:[https://devops.com/breaking-down-silos/](https://devops.com/breaking-down-silos/)

在试图通过稳定性和质量来实现敏捷性的组织中,(团队、工具和流程的)竖井成为管理预生产和生产系统之间的配置偏差的主要绊脚石。打破这些孤岛、提高配置漂移的可见性以及促进协作以改善流程是克服这一挑战的关键。

**双方都在移动时保持同步的挑战**

生产环境不是静态的。无论您是应用补丁来提高安全性、优化可用性和性能设置，还是为了技术更新而进行更改，生产系统都在不断发展。随着新版本的开发、测试和试运行，生产前环境也在不断发展。理想情况下，您希望开发时考虑到产品，但当双方都在变化，不同的团队负责不同的环境并生活在他们自己的“世界”中时，这变得越来越难(例如，QA 团队、发布团队和生产运营部门之间的共同划分)。

即使在前期制作中，保持同步也是一个巨大的挑战。例如，因为应用程序依赖于中间件，而每个应用程序的中间件设置都是唯一的，所以保持系统从 QA 到 staging 的同步可能是一个真正的挑战。

QA 和试运行环境定期重新配置，以支持同时进行的多个版本。最大限度地减少变更通常采用的高成本方法是为某个应用程序或版本“保护”QA 环境，这会导致低利用率和瓶颈。移动应用程序向前端遗留系统的快速扩散通过增加另一个依赖层放大了挑战。

**不连贯的团队、信息和观点(那些讨厌的筒仓)**

如果我们知道问题所在，为什么这些挑战如此难以克服？许多 IT 团队在他们的“自己的世界”中运作，使用定制的但互不关联的工具和信息资源。筒仓之所以发展，是因为它们允许处理 it 日常处理的巨大的、不断增长的复杂性所需的专业化，但它们现在已经成为敏捷性和质量的最大障碍。

例如，运营团队可以访问大多数其他人无法访问的系统管理警报，工程师可以构建其他人无法访问的系统和脚本，开发人员可以访问其他人无法访问的功能需求和故事，更改批准存储在只有特定人员(通常是经理)可以访问的记录系统中，这只是其中的几个例子。

在这些团队之间协调工作和共享信息通常等同于大量的会议、电话会议和电子邮件线程。这不是完成工作的最有效方式，在共享信息以保持环境同步方面也不是特别有效。

“你没看到我昨天的电子邮件吗？附件列出了今天测试所需的所有中间件设置。”“你不是在三周前的会议上说过，除了 Windows 机器之外，可能还需要一台 Unix 服务器吗？”“我在周五的一条即时消息中告诉某某人在他使用 PTO 之前运行这个脚本，但是他一定是忘记了。还有谁有 root 权限在他外出时运行它？”

可悲的是，在大多数 IT 商店中，这种说法是正常的，而不是例外。

现实情况是，在管理应用程序所有者、开发、QA、发布和生产功能之间的所有步骤和移交时，协调效率低下。相反，我建议将软件开发和部署生命周期视为一个必须从头到尾进行查看和管理的“超级变更”和“超级协作”过程；从业务需求，到开发，到 QA，到试运行，再到生产。所有不同的团队都必须有一种统一的协作方式，能够访问上游和下游团队的关键信息，以确保端到端的平稳生命周期。

自动化≠ DevOps

DevOps 的核心是协作和管理变化，但对话似乎经常从自动化开始。这里的谬误是相信我们可以通过将人从过程中移除并依靠机器来消除协作和管理变化的需要。这种机器和人之间失衡的观点造成的问题比它解决的问题还多。

自动化工具虽然重要且必要，但并不是真正解决这些同步和部署问题所需要的全部。此外，在事故扑救过程中，仅通过自动化工具改变环境而不通过人工改变环境是不现实的。你需要用智慧和部落知识武装你的人来推动你的自动化，但是我们太经常地依赖那些观点不一致、意识有限的人，所以事情会被错过或忽略。

自动化做了它应该做的事情，但是它做了一个重要的假设；正在改变的是如何配置它应该配置的。如果因为关键设置被修改以补救事件或合规性问题而发生漂移，而自动化工程师并不知道这一变化，则自动化部署将导致您听到一声巨响

正如一位流行的 DevOps Twitter 用户所说，“犯配置错误是人之常情——在一千台服务器上犯错误才是 DevOps。”虽然这似乎是一种为喜剧效果而设计的极端说法，但如果说每天有数千个部署失败是因为系统没有按照我们期望的方式进行配置，这并不极端，因为多层应用程序现在所依赖的复杂软件堆栈在很多方面都有所涉及。单靠自动化并不能解决 DevOps 挑战。

**对业务的负面影响**

当然，我在这里提出的问题不仅仅是 IT 问题；它们是真正的商业问题。*上市时间通常是最受影响的领域*。例如，如果一个两周的开发冲刺被用来解决一个关键的业务需求，但是由于资源限制和配置问题，这个冲刺需要花费数周的时间才能通过质量周期并进入生产，我们取得了什么成果？*T3】*

*稳定性和质量是下一个大的影响领域。*当通过新版本快速引入变更，并且环境中出现意外变化时，性能和可用性会受到影响。It 部门被认为速度慢、对业务反应迟钝是一回事，但当他们被认为速度慢、质量差从而影响业务时，则完全是另一回事。

就在它认为情况不会变得更糟的时候，企业提出了一个可能很简单的问题:“发生了什么？”这是典型的回答，“让我回头再告诉你。”然后开始几个小时、几天或几周的争夺，因为人们拼命想找出哪里出了问题。这显然不是对企业最好的信心建立者。

*合规性通常是另一个受害者*,因为开发人员通常对运营政策知之甚少，所以部署包和指令对合规性问题不敏感。构建和测试应用程序时，如果不完全了解整个多层堆栈的策略治理，那么在尝试部署到生产环境中时，必然会带来延迟和错误。

**可视性、配置透明性和协作性；更好的方法！**

1.  **了解整个应用服务的漂移。**不是每个人都对数据库、应用中间件、网络或防火墙以及服务器配置有各自不连贯的观点，而是让团队成员从业务服务(或应用)的角度理解，直接了解应该如何配置和实际如何配置整个多层应用堆栈之间的差异。这使您能够创建更智能的自动化，并在必要时启动更改流程以使配置恢复正常，而不是等待失败的部署发生，找出根本原因，并在业务等待时进行纠正。
2.  **针对流程进行优化，而不是针对单个** **流程**。如前面的例子所述，在不考虑对 QA、试运行和生产的影响的情况下，使一个过程更快(例如开发)会产生新的下游约束。相反，将开发运维视为一个从目标和需求一直到部署到生产的连续过程，并在这些方面定义团队的成功。当您针对流程而不是孤岛进行优化时，您会惊讶于团队是如何共享更多内容并更好地协作的。

通过更好的可见性、理解漂移和协作打破孤岛的好处是显著的:

*   更快的上市时间；
*   对竞争压力的快速反应能力；
*   错误更少的部署；
*   更好地遵守政策；和
*   提高每个人的生产力。

**总而言之，如果您打破孤岛，识别并解决漂移，并管理流程(同时避免自动化、信息和人员的孤岛)，您就可以释放敏捷性，保持稳定性并确保您的业务所需的质量。**