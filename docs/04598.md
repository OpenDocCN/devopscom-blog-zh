# 相关的持续测试:DevOps 的首要关键

> 原文:[https://devo PS . com/relevant-continuous-testing-primary-key-devo PS/](https://devops.com/relevant-continuous-testing-primary-key-devops/)

我最近的博客“DevOps 的 7 个支柱”确定了构成成功的 DevOps 的 7 个基本最佳实践领域，并解释了这些支柱不是孤岛，而是需要保持平衡的基础。其中一个支柱是持续测试(CT)。

对于平衡良好的 DevOps，CT 执行的测试足够快，刚好符合时间预算，但又足够彻底，足以涵盖部署到生产所需的质量。尽管需要平衡，但 CT 可被视为 DevOps 的真正支柱，因为测试是一个支柱，它证明了运行所需的更改的有效性，并验证了其他支柱在整个管道中端到端的正确运行。

与旧的测试策略相比，在旧的测试策略中，大型软件变更在“发布到 QA”之后作为完整的产品进行测试，DevOps CT 战略性地在一系列 DevOps 阶段对变更进行增量测试。CT 始于开发中发生变更的时刻，并贯穿于开发运维管道的所有阶段。发布就绪性是通过分析部署前积累的测试结果来判断的。使用蓝绿色、A/B 和金丝雀测试策略，一些测试可能会在部署后持续到实际环境中，其结果可能会影响未来的 CT 活动。

像持续集成(CI)一样，频繁、小规模、增量测试有许多优点。对问题的快速反馈使得由许多单独的变更组成的发布可以放心地进行增量测试。当变更被增量测试时，问题的根本原因可以被更快地隔离。问题是确定哪些测试与在 DevOps 管道的每个阶段运行的内容最相关，并且从一个变更到下一个变更，变更的风险变化很大。

鉴于测试是一个随机抽样的过程，在任何绝对意义上，都没有 100%的测试。如果不加以检查，测试的内容将会成倍增长，超过被测试产品的内容。即使使用弹性的按需云基础设施，再多的测试资源也无法满足不断增长的测试需求。关键是创建和选择与管道中正在处理的变更最相关的测试，而不是试图运行所有的测试，而不考虑您希望检查的实际变更。在管道的每个阶段选择最相关的测试的策略是最佳的。

下面描述了创建和选择相关测试的几种策略。这些相关的测试策略可以单独用于特定的 DevOps 阶段，或者多个这些相关的测试策略可以在流水线上端到端地使用。

1.  选择关注源代码缺陷的测试。基于静态分析扫描的度量可以确定源代码的哪些区域有最多的缺陷。测试创建和选择算法可以为那些领域编写的测试提供更高的权重。这似乎是个好主意；然而，有几个限制。扫描工具仅限于特定的语言，可能会遗漏关键缺陷，并且不具备关于特定缺陷的系统范围相关性的智能。
2.  为低测试覆盖率的代码区域创建和选择测试。这听起来也是个好主意，但事实并非如此。最明显的原因是测试可能无法选择，或者覆盖率本来会更高。此外，代码覆盖算法，尤其是在系统级，仅限于简单的度量，如语句覆盖，这不是一个系统级性能的良好指标。
3.  创建并选择与构建变更的工件相匹配的测试，包括构建依赖。在这种方法中，测试被映射到构建变更，并且测试被选择来匹配变更。这听起来合乎逻辑，但不幸的是，测试和构建工件之间的静态映射可能无法反映变更对系统的影响，因为与构建依赖链之外的模块的交互可能会导致严重的故障。
4.  根据风险分析创建和选择测试。这种方法保留了与测试结果相关的代码变更的运行记录。当代码模块被改变时，最容易失败的测试被选择。与其他方法相比，这种方法有几个优点。测试选择不限于实现语言或构建依赖关系图。在测试的随机环境中，经验比代码结构与风险更相关。同样的算法可以应用于流水线中的每个阶段。并且可以为每个流水线阶段运行动态地调整流水线度量。

上述 CT 实践表明，相关的测试策略减少了 CT 执行的时间并降低了 CT 的基础设施成本，而不会牺牲交付给生产的质量。

## 摘要

你怎么看？你同意上述相关的持续测试实践吗？还有其他你推荐的吗？

虽然与所有七大支柱一起实施的 DevOps 为长期企业业务改进奠定了坚实的基础，但了解 **DevOps 不是一个孤岛**非常重要。实施 DevOps 的企业应该知道 **DevOps 与其他 IT 系统和实践互操作。**建议企业制定治理政策，鼓励选择工具不可知的 it 合作伙伴，这些合作伙伴的解决方案最适合每个独特企业的需求，并且能够将开发运维与其所有 IT 系统集成并发展。

[马克·霍恩布洛尔](https://devops.com/author/marc-hornbeek/)