# AWS 密钥管理服务

> 原文:[https://devops.com/aws-key-management-service/](https://devops.com/aws-key-management-service/)

无论是存储在内部还是云中，数据和应用程序的安全性一直是影响最大的问题。到目前为止，AWS 已经为其客户提供了帮助保护和加密数据的服务，例如亚马逊 S3、亚马逊弹性块存储(EBS )(一种服务器端加密服务)、亚马逊红移、亚马逊 RDS for SQL 等等。所有这些服务都利用了在 AWS 中创建、存储和管理的“主密钥”。

最近，AWS 推出了一个新的甚至更安全的密钥管理选项，这将有助于管理在云和内部运行的应用程序和服务的密钥。

**AWS 密钥管理简介**

AWS 密钥管理服务是一项全面管理的服务，可帮助您对加密密钥进行统一、集中的控制。它利用**硬件安全模块(HSMs)** 来保护您密钥的安全，并通过提供高度可用的密钥存储设施和管理，使您能够轻松地在 AWS 基础架构和您自己的应用程序中加密您的数据，您可以创建、轮换、禁用、定义使用情况并执行审计解决方案，以仔细检查用于加密您数据的加密密钥的使用情况。

**AWS 密钥管理服务提供:**

1.  一键加密
2.  完全控制您的加密密钥
3.  集中管理密钥的地方
4.  强制密钥轮换策略

[![AWS KEy Management](../Images/568bb501c34546cd2df8a52b9d0a019c.png)T2】](https://devops.com/wp-content/uploads/2014/12/AWS-KEy-Management.png)

**关键管理服务组件:**

AWS 密钥管理服务有三个主要组件，它们是

**1。创建和管理密钥:**

您的组织的所有加密密钥都存储在一个位置并可在该位置查看，因此易于实施创建、轮换、使用策略和审计。

**2。使用密钥加密您的数据:**

AWS 密钥管理服务与 SDK 配合使用，可以将加密简单地集成到您的应用程序中。它与亚马逊 S3、亚马逊 EBS 和亚马逊 Redshift 等 AWS 服务相集成。

**3。审计密钥用法:**

它向 CloudTrail 提供所有审计跟踪信息，通过提供日志来检查和验证谁在何时使用了哪些密钥、使用了哪些资源，从而帮助满足监管和合规性要求。

**主要优势:**

AWS 密钥管理服务为您的密钥提供了高可访问性、低延迟和高水平的持久性。以下是 AWS 密钥管理服务提供的一些好处:

**1。集中式密钥管理**

它为您提供了对加密密钥的统一、集中的控制。您可以从 AWS 管理控制台或通过使用 API 轻松创建、旋转、禁用、定义使用和启用日志记录。组织 KMS 中使用的所有键提供了它们的单一视图。

**2。与 AWS 服务集成**

AWS 密钥管理服务(KMS)与亚马逊 S3、亚马逊 EBS 和亚马逊 Redshift 相统一，以简化这些服务中的数据加密。通过这些集成，加密和解密是自动完成的。你只需要选择你想用来加密或解密的 KMS 主密钥。

**3。为您的所有应用程序加密**

AWS 密钥管理服务与 SDK 和命令行界面集成。它将加密和密钥管理以编程方式集成到您的应用程序中。不管数据存储在哪里，KMS 都可以轻松组织用于加密数据的加密密钥。

**4。内置审计**

AWS 密钥管理服务与 AWS CloudTrail 一起运行，为您提供 KMS 发出或发出的 API 调用日志，甚至帮助开发人员进行审计。这些日志有助于您检查和验证谁使用了哪些密钥、使用了哪些资源以及何时使用了这些密钥。

**5。完全管理的**

基础设施的可访问性、物理安全性和硬件维护由 AWS 管理。而 AWS 密钥管理主要关注的是应用程序的加密需求。

**6。低成本**

您只需为您创建的补充主密钥和密钥使用付费。在您的帐户中存储默认密钥是免费的。

**7。安全**

AWS 密钥管理为您提供了一个安全的位置，使任何人都无法访问您的主密钥。它利用了加固的系统，其中你的未加密密钥只在内存中使用。该服务的任何更新都由亚马逊内部的一个独立小组进行检查、验证和评估的多级审批流程管理。

**AWS 密钥管理使用示例:**

在这个例子和用法中，我们将

1.  在 AWS KMS 中创建密钥
2.  使用此密钥加密 S3 桶中的文件
3.  修改此项的访问权限
4.  审核与此密钥相关的所有活动

**例:**
这里调用了三个 IAM 用户，分别命名为

1.  Admin1-管理
2.  用户 1-财务报表的用户
3.  用户 2-合规官

**使用 AWS 密钥管理服务创建密钥**

登录到一个 **AWS 管理控制台**和**点击 IAM** 。
在 **IAM 仪表盘**上，你会在细节部分的底部看到**加密密钥**

点击此选项，您将到达 AWS KMS 控制台。AWS KMS 键是地区特定的，只能在创建它们的地区使用。在本例中，我们点击**美国西部(俄勒冈州)。**

**接下来点击创建密钥，开始创建主密钥的三步流程**

1.第一步是给一个名为 Allias 的主密钥命名。Allias 是主密钥的显示名称，并且是必填字段。这里我们定义

**Allias name-" Financial _ Report "**

“描述码”选项也与“名称”选项一起显示。该密钥用于给出有意义的描述以及主密钥将保护什么。我们将其定义为

**描述密钥-受保护 _ 公司 _ 财务 _ 数据**

**我们点击下一步**。

2.在这一步中，我们为正在创建的**财务报告**主密钥定义**密钥管理员**。

单击“下一步”后，将出现一个屏幕，您可以在其中通过选择一个或多个 IAM 用户和/或角色来定义允许哪些 IAM 用户管理新密钥。这里添加的用户**可以编辑、启用、禁用和旋转主密钥**。他们也可以在这个主密钥的帮助下**加密和解密数据**。在该屏幕中，我们**选择 Admin1** 并启用他/她，然后**点击下一步选项**。

3.在这一步中，我们决定允许哪些用户、角色和其他 AWS 帐户使用密钥来加密和解密数据。我们选择的用户和角色可以在其应用程序或 AWS KMS 中使用 Financial_Report 键。

这里我们选择用户 1 的选项。
如果您希望允许另一个 AWS 帐户能够使用此密钥，那么您可以在外部帐户选项中输入帐户或 Amazon 资源名称。

要完成密钥创建过程，我们单击“完成”按钮。一旦创建了这个主密钥，我们将使用这个 **Financial_Report** 密钥来保护我们已经上传到亚马逊 S3 的文件。

**使用亚马逊 S3 的密钥**

1.现在，一旦我们进入亚马逊 S3 控制台，我们的首要步骤是**创建一个桶**和**上传**一个**财务报告**文件在桶中，并使用您创建的财务报告密钥加密这个文件。

我们将点击**创建存储桶**开始并进入

**名称-财务。美国 2014 年报告**

**地区——俄勒冈州**

确保您选择区域应该与您为主密钥创建的区域相匹配。现在点击创建桶选项。

2.创建存储桶后，我们必须上传此文档。为此，我们**点击操作**按钮，然后**点击上传**。

**点击设置细节按钮**选择我们想要的文件加密选项。屏幕上会出现两个选项，其中第一个是默认按键选项，因此我们选择第二个按键选项。

当我们选择第二个选项时，会出现一个下拉列表，询问您的主密钥名称。一旦您写下您的主密钥名称 **Financial_Report，**所有其他细节，如描述、帐户、密钥 ID 将自动填充。填写并检查所有详细信息后，单击开始上传按钮。

**修改并审计与该键**相关的所有活动

现在，我们假设作为用户 2 的合规官也需要使用加密文件进行审计，并且他需要访问 **Financial_Report** 密钥来解密该桶中的文件。我们可以通过使用亚马逊 S3 控制台授予他 bucket 访问权限。这可以通过做一些简单的改变来实现。

首先回到 AWS KMS 控制台。当屏幕出现**时，点击该页面上密钥使用部分**下的财务报告密钥**，点击添加**按钮，用户和角色列表出现**点击用户 2** ，然后**点击附加**。

**用户 2** 现在可以使用**财务报告**主密钥对文件进行加密和解密。当**用户 2** 不再需要访问该密钥时，您可以返回同一页面**点击用户 2** 并点击移除。

AWS KMS 主密钥可以根据您自己的需要禁用和启用。只要该密钥被禁用，受该密钥保护的所有数据都将变得不可访问，从而取消您对该密钥的收费。为此，我们首先进入加密页面并**选择财务报告选项**，然后进入**按键操作选项**并**选择禁用**，同样您也可以使其启用。

[https://www.youtube.com/embed/-5MPXHvKDnc?feature=oembed](https://www.youtube.com/embed/-5MPXHvKDnc?feature=oembed)