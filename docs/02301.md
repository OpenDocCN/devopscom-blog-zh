# 如何创建无 Bug 的区块链应用

> 原文:[https://devops.com/how-to-create-bug-free-blockchain-apps/](https://devops.com/how-to-create-bug-free-blockchain-apps/)

虽然所有的开发人员都在努力实现无错误代码，但这在交换敏感数据或其他机密信息的区块链部署中尤为重要，比如在医疗保健或金融领域。然而，一些企业已经从惨痛的教训中吸取了教训。币安加密货币交易所最近披露了一个[毁灭性的安全漏洞](https://techcrunch.com/2019/05/10/binance-security-hack/)，导致超过 4000 万美元的损失。虽然这是一大笔钱，但对于丢失私人信息、机密合同等的企业来说，安全漏洞的代价可能更高。

重建(和重获客户信任)不是组织应该花费时间的地方。更好的方法是公司领导层从一开始就强制执行区块链测试自动化策略。

虽然大多数软件测试人员熟悉测试 web 应用程序，但是他们可能不确定如何进行区块链测试。好消息是，web 测试的一些相同的焦点领域也适用于区块链测试(功能、性能和安全性)。然而，区块链涉及更多的测试、工作和重点领域，如基础设施协调、在分布式环境中准备和模拟场景，这需要更高水平的专业知识。

由于这些附加功能，修复区块链应用程序中的漏洞需要几个额外的步骤，因此，这比修复其他应用程序中的漏洞更耗时，成本也更高。例如，为了重现错误或验证代码，开发人员应该多次执行这些步骤:

1.  形成新的端点。
2.  将新代码部署到新端点。
3.  将当前数据迁移到新的后端。
4.  暂停旧的后端。
5.  将所有前端更新到当前版本。

之后，验证由测试人员或持续集成(CI)工具执行的 bug 修复将再次需要这些步骤。这种复杂性使得发布无 bug 的区块链应用程序变得困难，然而这样做会使组织和他们的客户面临财务损失的风险。由于部署区块链应用程序的高风险性质，将测试纳入管理愿景和战略至关重要。

要发布代码无错误的区块链应用，企业应遵循以下指导原则:

### 将测试自动化集成到您的区块链测试策略中

测试自动化可以将测试人员从手工执行数以千计的编排测试中解放出来，这既困难又低效。一个好的系统架构应该是可伸缩的、可维护的和可测试的，这样团队可以独立地测试组件和模拟组件。如果一个测试需要不同的环境或基础设施，那么基础设施作为代码(IaC，比如 Puppet、Chef、Ansible 和 AWS)在建立适当的测试环境方面是非常宝贵的。该策略的另一个关键部分是为基础设施提供声明性定义，并允许开发人员实现支持测试自动化的代码。

### 运行单元和集成测试，涵盖后端和前端代码

区块链应用程序至少包含一个后端(一组在区块链上运行的智能合约或链代码)和一个前端(用户可以与存储在区块链中的数据进行交互)。执行单元测试将涵盖后端和前端代码，由于它对区块链应用程序的关键作用，它的主要焦点应该是链代码。然而，集成测试应该覆盖各种类型的 oracles 和前端应用程序。通过验证 UI 和链代码之间的集成，执行额外的测试将消除任何可能威胁后端的漏洞。

### 在本地基础设施中执行测试

虽然公共区块链(如比特币或以太坊)有几个测试网络，但最好在本地基础设施中执行测试。对于单元和集成测试来说，本地基础设施是轻量级的、更快的和更稳定的。例如，在 Ganache 本地基础设施中，可以在一个小时或更短的时间内对五个 Ethereum 智能契约运行 1000 多个单元测试，部署大约 3000 次。

### 持续更新安全系统测试套件

区块链是一个多方基础设施，在某些情况下，它是一个公共网络。因此，这些应用程序将对许多利益相关者可见，甚至可能对全世界开放源代码。这种透明度意味着黑客能够研究程序，并根据特定的系统策划攻击。持续更新安全系统测试套件将确保应用程序免受所有常见安全漏洞的影响。

### 尽量减少开发过程每个阶段的连续测试管道

本地基础设施中的分层集成和单元测试以及对安全系统测试套件的持续更新创建了对高质量区块链代码至关重要的持续测试管道。在多个环境中持续验证代码变更，例如本地区块链和测试网，确保高质量的代码被交付到生产区块链。然而，这些测试对于每个代码更改可能会持续几个小时或几天，因此团队最大限度地减少和创建关注测试阶段、测试类型和测试环境的精益管道，并在开发过程的每个阶段为代码开发多个管道是非常重要的。

### 构建定制的测试套件以消除潜在的作弊漏洞

测试团队还需要定制管道中的测试套件，以涵盖功能和安全性测试。涵盖安全案例是重要的，但是单元测试模块也应该运用智能合约单元潜在的安全威胁，比如溢出和重入，以尽可能地消除潜在的欺骗漏洞。

由于底层基础设施的分散化和编排的性质，为区块链应用程序开发无错误代码比其他应用程序面临更多的挑战。通过采用传统软件测试的最佳实践，尤其是测试自动化，并为区块链开发定制它们，企业可以实现无错误的区块链编码，并保护他们最易受攻击的应用程序。

— [通阮](https://devops.com/author/thong-nguyen/)