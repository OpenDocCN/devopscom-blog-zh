# DevOps 聊天:Phoenix OSS 框架和 DockYard

> 原文:[https://devo PS . com/devo PS-chat-phoenix-OSS-framework-with-dock yard/](https://devops.com/devops-chat-phoenix-oss-framework-with-dockyard/)

无状态应用程序架构是当前事实上的方法，对吗？不一定。即使在今天的云原生应用程序时代，通过 TCP 套接字进行通信的有状态应用程序也可以成功构建。

本期 DevOps Chat 的嘉宾是 Chris McCord，他是 Phoenix 开源软件的创造者，也是 DockYard 的建筑工程师。Chris 是一名使用 PHP、Java 和 Ruby 的开发人员。当 Chris 得知 WhatsApp 是使用 Elixir 构建的，运行在 Erlang 虚拟机上时，他很感兴趣。我们需要一个开发人员友好的 web 框架来创建 web 和移动应用程序。

Chris 在 2011 年开始开发 Phoenix 框架，并在 2014/15 年看到采用率上升。快进到今天，Chris 是一个充满活力的开发人员社区不可或缺的一部分，该社区使用 Phoenix 来创建面向 web 的移动嵌入式实时应用程序，这些应用程序可以用更少的代码支持大型事务服务器。

加入我们，与 Chris McCord 一起谈论 Phoenix，他为什么创建了今天扩展到 Phoenix LiveView 的开源项目，以及 Phoenix 狂热开发者挑战赛(获胜者将在 10 月初至 10 月中旬选出。)

像往常一样，下面是流媒体音频，然后是我们的谈话记录。

## 

[https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/686288455&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true](https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/686288455&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true)

## 副本

米奇·阿什利:大家好。我是 DevOps.com 的米奇·阿什利，您正在收听的是另一个 DevOps 聊天播客。今天我请到了船坞的建筑工程师 Chris McCord。我们今天的主题是凤凰城，灵丹妙药的网络框架。现在克里斯也是凤凰城的创造者，他也是一个作家，所以我想我们今天会有很多要谈的。克里斯，欢迎来到播客。

克里斯·麦考德:谢谢你邀请我。

阿什莉:很高兴你能来。你能从自我介绍开始吗？告诉我们一点关于你做什么和船坞做什么。

当然，是的。正如你提到的，我是一个叫做 Phoenix 的网络框架的创建者。它运行在运行在 Erlang 虚拟机上的 Elixir 编程语言上，我相信我们会对一些不熟悉的观众解释这一切的意义，但本质上，除了构建框架之外，我还与 DockYard 合作，为我们的客户构建完整的堆栈项目，因此这是从财富 100 强公司到初创公司的所有项目，我们使用 Elixir 为这些客户提供所有解决方案。我们也做设计和 UXD，但就我而言，它真正关注的是后端系统和构建可扩展的平台。

**Ashley:** 如今，我们创建的所有应用程序都需要整合和扩展，这无疑是一个巨大的需求。让我们直接进入你的工作，我将首先从什么是凤凰开始，也许对不知道长生不老药和长生不老药/二郎神的人有一点背景知识。

是的。Phoenix 有点像 Elixir 框架的事实上的 web 库，所以最快的概要是 Elixir 是一种运行在 Erlang 虚拟机上的编程语言。所以 Erlang 是一种已经存在了 30 多年的语言。它实际上是由 Erikson 在 80 年代开发的，用于运行电信系统，所以他们在 80 年代建立了这种利基语言来解决一系列非常具体的问题，同时编程社区普遍关注面向对象、单线程语言。快进到今天，莫里斯定律开始生效，我们开始增加更多的内核来跟上 CPU 的速度，我们所有的传统语言都突然遇到了一堵墙，好像突然之间我们再也不能指望我们的程序每年速度翻倍。我们必须添加多个内核，但大多数语言都不是为多核时代设计的。

事实证明，Erlang 在 80 年代解决的一系列特定问题实际上完美地映射到了多核时代，所以我认为我们在这个 Erlang 虚拟机中有这种创新，这种创新在很大程度上没有被注意到，然后 Elixir José Valim 的创造者在 2011 年加入进来，并认可了这种创新，并使用程序员在这些主流语言中习惯的一些功能来构建现代语言，并在 Erlang 虚拟机上构建一种语言。Elixir 是在这个利基虚拟机的基础上诞生的，并不是说 Erlang 有自己的成功——你知道，我们听说过 WhatsApp 以 200 亿美元收购了它。他们每台服务器运行 1000 万用户，我认为他们总共有 30 名工程师来支持。

阿什莉:太棒了。

McCord: 是的，这是一种传统，它让 Elixir 语言的发展速度比一种典型的新语言要快得多，当然，我能够站在巨人的肩膀上，在 Elixir 的基础上建立一个 web 框架，这给了我们所有这些令人惊叹的、可扩展的功能。

阿什莉:这正是我在想的比喻，我们都站在巨人的肩膀上。这就是我们这个行业的一个伟大之处，那就是旧的又是新的，我们建立在过去的成功之上。谈谈你为什么着手在 Elixir 上创建一个 web 框架？你是否正在做一个项目，并且说，“嘿，我一直在构建相同的代码”或者“我有朋友有同样的需求，也许我应该去构建一些东西”？创作凤凰城的灵感是什么？

是的，所以对我来说，我的背景是 Java，然后是 PHP，然后是 Ruby，但是在之前的六七年里，在我进入 Elixir 之前，我一直在专业地做 Ruby，我很喜欢它。为熟悉 Ruby on Rails 框架的人做了很多 Ruby on Rails 的工作。

Ashley: Ruby 是一门伟大的语言。爱死了。

是的，我有很多快乐的客户。随着网络向这种更加实时连接的本质发展，我们有了越来越多的要求，我想构建的越来越多类型的应用程序都是实时连接，在页面上显示实时更新，做一些你希望能够做的事情，或者我们希望能够作为今天的网络用户来做的事情。我和露比一起撞墙。我试图让库支持实时应用程序，但事情非常脆弱，根本不能很好地扩展，所以当我开始环顾四周说，你知道，如果我可以选择一种语言来编写实时应用程序，我会选择什么？这就是我发现 Erlang 和 WhatsApp 刚刚被收购的地方，所以我看到了他们如何在每台服务器上运行数百万用户，我问，“他们是怎么做到的？”

我希望能够做到这一点。那时我发现了长生不老药，长生不老药的创造者 José Valim 来自 Ruby 社区，所以我有点记得，哦，你知道，他去创造了这种语言；也许我应该去看看他在做什么。这引发了我的兴趣，然后我爱上了 Elixir，我说，“我唯一需要做的就是编写一个 web 框架，这样我就可以在其中构建我所有的客户端应用程序，”这就是整个事情的开始。

Ashley: 如果我没记错的话，在 Ruby 中，我认为库被称为 gems 或库包，所以我如何在你正在使用的这种新语言中体验这种东西，这将最终引导你创建 Phoenix。多棒的故事啊。

是的，没错。这是在平台的承诺下，对吗？所以我想，对于任何技术来说，你都需要一个信念的飞跃，我潜心阅读了 Erlang WhatsApp，每台服务器数百万个连接，然后假设我们可以做到这一点。长话短说，两年内——或者当我们在 Phoenix 达到 1.0 时，我们进行了基准测试，我们的实时层在单个服务器上进行了多达 200 万次连接的基准测试。

阿什利:哇。

是的。我们的唯一限制是，我们必须启动大约 45 台服务器来发送如此大的流量，而我们刚刚用完了连接，所以我们在服务器上没有限制。我们本可以更进一步。这是一段有趣的历史，这是一种信念的飞跃，假设你读到的技术是真实的，假设你可以轻松实现或者你个人可以实现，然后经历并表明我们可以扩展到数百万用户，所以这是一段非常有趣的旅程。

阿什莉:非常好。嗯，如果我知道你是在 2013 年左右开始的？我认为第一个公开或生产就绪的版本 1.0 大约是在 2015 年，所以它已经在社区中有一段时间了。我相信从那以后它已经成熟了。凤凰城今天的状况如何？

是的。所以我们从 2015 年开始就是 1.0。我想我的第一次承诺是在 2013 年。灵药始于 2011 年。直到 2013 年，它才真正得到使用，所以一旦仙丹到了 1.0，也就是凤凰 1.0 之前，那么可能是 2014 年？因此，从那时起，我们已经看到语言和框架中相当稳定和大量的采用，所以 Elixir 本身和 Phoenix 仍然是单点发行，无论是语言还是 Phoenix，我们都没有——我们没有 2.0 的计划。我的意思是，在未来的某个时候会有 2.0，但我们还没有，我们有一些反对意见，但还没有出现这样的情况，你会说，好吧，现在我必须重写一切。所以我们的目标基本上是在语言层面和框架层面有一个稳定的核心，我们已经有公司进来了，我们就像一个漂白报告一样吹捧。这是我们经常提到的一个很大的例子，因为很多人都知道他们是谁，所以这就是体育新闻网站。他们每个月有 8000 万到 1000 万的访客，他们现在几乎完全建立在仙丹和凤凰城的基础上。因此，我们已经有公司进入并在此基础上进行建设，到目前为止已经取得了巨大的成功。

Ashley: 有没有特别适合菲尼克斯的应用程序，比如你提到的体育网站？它可能会提供大量的视频内容或照片内容，或者是否有其他更面向事务的应用程序，如通过 web 框架处理支付或其他任何内容？真正利用 Phoenix 的最好的应用有哪些？

是的，所以我的意思是最基本的答案是任何连接到 TCP 插座的东西*【由于串音听不清】*。

阿什莉:那是一大堆东西。*【笑】*

**麦科德:**对。

阿什莉:那是很多事情。*【笑】*

基本上，就你所说的任何面向网络的东西，任何带有类似通知的东西而言，都是如此。因此，Bleacher 报告从他们采用向用户推送通知开始，然后 Pinterest 没有他们的所有堆栈，但 Pinterest 的通知层是用 Elixir 编写的。因此，我们看到许多公司在做这种消息代理风格的用例，但我认为任何连接到 TCP 套接字的东西，无论是 web 服务器、平台的编排层，还是我们认为的 web 之外的东西，都仍然是非常合适的，但我认为我们迄今为止看到的最大采用是更加面向 web 的，因为我认为这是最大的市场份额开发者，对吗？

我们所有人都必须做一些面向 web 的事情，但我们的范围更广，这还不算，我们还可以在嵌入式领域使用 Elixir，因此您可以将 Elixir 和整个 Erlang 运行时间整合到 16mb 的 Linux 映像中，并在嵌入式设备上运行，这样您就可以获得所有这些好处。因此，它可以在从 0 到 100 核的服务器上同样出色地工作，这是最令我兴奋的事情。

**阿什利:**有意思。Phoenix 更适合有状态应用程序还是无状态应用程序，或者它真的有所不同吗？

是的，所以有状态的应用是——我的意思是，就这些主流框架而言，它是我们能够做的事情，没有人能够做，或者做得很好。因此，我们仍然可以像其他人一样实现无状态 HDP，而且我们可以以令人难以置信的速度和可伸缩性做到这一点，但我选择 Elixir 的原因是，我们实际上可以构建连接保持活动的有状态应用程序。你知道，我们不必扔掉这些无状态的连接，并试图伪造一些状态，所以这就是我创建 Phoenix 的基本原因。我们称我们的实时层通道。它类似于 Socket.IO。所以基本上它是对 web 套接字的抽象，这是我想要做的，也是我加入的原因，是保持这些实时连接的能力。

我们今天建立的任何东西最终都是一个聊天应用，对吗？无论是推特还是脸书，或者所有这些我们试图建立的东西。你需要某种实时性，你需要能够向用户推送更新，即使只是在网站的标题栏上显示通知计数。如果你真的与连接的客户端进行了对话，这是很容易做到的，而不是试图进行长时间的对话或接管稳定 __。

**Ashley:** 嗯，云很有意思，这确实让无状态应用程序设计架构走到了最前沿，但如果我没记错的话，Erlang 确实非常适合处理有状态类型的应用程序和大量的有状态应用程序，所以听起来这是吸引你进入这个环境的部分原因。

是的，没错。是的，整个无状态、无服务器的方法对我来说很有趣，因为这就像是我们在我们的平台中所擅长的相反，我们所看到的就像是——也许只是一个例子。有人在 AWS Lambda 上每月支付 16，000 美元，他们在 Elixir 中重写了这一点，现在他们每月支付 40 美元。

**阿什利:** *【笑】*

因此，我确实认为，是的，这些无状态平台有其优点，但我认为这是在替代方案的伪装下出现的。因此，如果您的平台基本上是无状态的，那么让其他人来处理您的无状态问题和扩展是非常有意义的，但是您现在可以构建一个无状态的。我认为我们有点颠倒了整个想法，我们说，“嗯，我们只需在几台服务器上运行所有这些，它将在我们的业务生命周期内扩展，”这样比其他解决方案的复杂性和成本都要低。

**阿什利:**有意思。我想你们也刚刚结束了一场演讲。是凤凰城的现场直播吗？那是会议的名字吗？我认为是你的挑战。

是的。是 ElixirConf。

**Ashley:** ElixirConf，没错。

我谈到了凤凰城的现场直播，是的。

阿什利:你们在那里谈了些什么？

我去年在 ElixirConf 上展示了 LiveView，这有点像概念验证，然后我们已经为此工作了一年，我真的展示了我们一年来的进展。因此，去年它是一种原型，有一些承诺，今年它是实际使用案例和我们能够获得的效率，甚至我们如何能够使用 Phoenix LiveView 击败传统的单页应用程序。

阿什利:酷。还有一个叫菲尼克斯·弗伦兹的东西。我认为这是一个挑战，对吗？

**McCord:** 是的，所以 DockYard 的人把他们的空闲时间放在一起，帮助建立了这个比赛网站，这实际上只是一个社区将 Phoenix LiveView 的例子放在一起的比赛，有点像是相互竞争，也有点像是在社区外培养对该平台的更广泛的认识。所以，是的，Phoenix LiveView 允许你用服务器渲染的 HTML 构建丰富的实时应用程序，所以你不需要自己写任何 JavaScript，你能够以比你可能习惯的更快的速度和更低的复杂度获得这些交互式应用程序。所以比赛是人们展示他们的作品和可能性的一种方式。

阿什莉:比赛的获胜者是如何选出的？你是董事会的一员吗，或者你如何决定这是最好的？

是的，我们有一些评委。Phoenix 核心团队中有相当一部分成员是评委，也有一部分是社区成员。所以我想我们会投票选出我们最喜欢的，谁得到的票数最多谁就赢了。

阿什莉:奖品是什么？除了表彰还有大奖吗？

**麦科德:**吹牛的权利。*【笑声】*是啊。将来我们会考虑奖励。如果有人曾经举办过这样的比赛，你会立即进入一些试图颁奖的法律领域，特别是有不同的地理和年龄限制，所以实际上这是一个试图确保我们可以在没有等待法律程序数月的情况下举办比赛的问题，但也许在未来。但目前只是全球认可。

阿什利:嗯，我认为获得一些凤凰街的信誉是有道理的，所以我认为*【笑】*这本身就很值得。

任何人都可以加入，就像我说的，对我来说，看到人们用 LiveView 制作东西真的很棒，所以我认为如果他们感兴趣，应该试一试。

**Ashley:**Chris，有机会与你交谈的一个好处是，能够与有这个想法、创建这个框架、写了像《编程凤凰》(Programming Phoenix)和《元编程灵丹妙药》(Metaprogramming Elixir)等书的人交谈是一件非常酷的事情。你在 ElixirConf 有一个关于凤凰城的演讲比赛，所以你真的围绕这个建立了一个职业生涯，但这是你出生的东西，什么，五，六年。那对你来说一定是一种很大的满足感。

是的，这是一次非常有趣的旅程。你知道，当我开始做这个的时候，我对它的发展没有任何计划。有点——我总是想从我使用开源库和框架的利他方面参与开源，所以我觉得我是在索取而不是回馈。所以当我进入 Elixir 时，它更像是一个激情项目，对吗？你知道，我希望菲尼克斯成功，但我不知道长生不老药本身是否会成功，所以随着事情的发展，是的，看到它的发展真是太有趣了，尤其是——你知道，这里有一个完整的另一个对话，我们没有时间进行，但就像倦怠一样，一旦菲尼克斯变得流行起来，人们开始使用它，然后我突然想，哦，我的天哪，我必须保持这个，对吗？

阿什莉:看我创造了什么。啊哦。*【笑】*

**麦科德:**总之，事情从——你知道，幸运的是，我能够从那里找到一条可持续的道路，因为我在工作中全职工作，然后在家里全职工作开源，所以我想如果我没有找到 DockYard，DockYard 雇我花大部分时间在开源上，我可能会住在某个地方的树林里。幸运的是，我找到了一条开源开发的可持续之路。我认为对于许多维护者来说，这是一座很难跨越的桥梁。

阿什莉:是的。

对我来说，幸运的是，我成功地跨过了那座桥，这对我自己、公司和 Elixir 社区都是互利的。

阿什利:嗯，值得称赞的是 DockYard 所做的一切，因为它找到了与你的那种协同关系，让你可以做这么多的工作，并继续这项工作。说到这，凤凰的未来是怎样的？在接下来的 6 到 24 个月中，您对未来有何展望？会发生什么？

是的，所以我认为 LiveView 可能是最大的宣传点，因为正如我所说的，你可以为一些单页应用程序创建一个等效的功能应用程序，但代码可能会少 10 倍，上市速度会快 10 倍，因为你不必编写所有这些 JavaScript，我们可以以可扩展的方式来实现。因此，我鼓励人们查看我在 ElixirConf 的主题演讲，如果他们想了解更多关于我如何做出这些声明的信息，但我们谈论了我们的优化。因此，我认为在接下来的一年左右，就社区中发生的事情而言，这种情况将处于最前沿。

阿什利:你看到了吗

除此之外，对于框架本身，我们——继续。是的，我想说的是，除此之外，我们还将在框架中添加遥测和度量集成，这样您就可以一目了然地看到您的系统中发生了什么，这样您就可以在框架中看到，如果您的系统很慢，您可以准确地查明框架级别和应用程序代码级别发生了什么，并可以诊断问题。我认为这是即将到来的尚未到位的更大功能之一，但除此之外，我认为我们将围绕这种实时应用程序进行有机增长，无论是通过 channels 还是 Phoenix LiveView。

阿什利:太棒了。嗯，绝对是一次愉快的谈话，我觉得我们可以再谈几个小时。我很想坐下来和你一起喝杯啤酒，但是谢谢你上播客。你能来真是太好了，克里斯。

是的，很有趣。非常感谢。

**Ashley:** 观众朋友们，你们已经收听了另一个播客，我们要感谢 Chris McCord，他不仅是 DockYard 的一名建筑工程师，当然也是开源项目 Phoenix 的创始人、作家、思想领袖和优秀的问题解决者，所以很高兴看到 Phoenix 取得了成功。所以，感谢你加入我们，当然我们也要感谢你，我们的听众，今天加入我们。我是 DevOps.com[的米奇·阿什利](https://devops.com/)，您已经听到了另一个 DevOps 聊天。在外面要小心。

— [米切尔·阿什利](https://devops.com/author/mitchellashley/)