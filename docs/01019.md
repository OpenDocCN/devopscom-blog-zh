# 力倍增

> 原文:[https://devops.com/force-multiplication/](https://devops.com/force-multiplication/)

最近，我发现自己在思考这句话，“成为一个力量倍增器。”当面临某种倦怠时，这通常会浮现在脑海中:从同事或朋友那里间接听到的，或直接经历的。意图是好的，并与 DevOps 的一些核心租户保持一致。通过鼓励交叉培训和协作的需要，力倍增符合 DevOps 的精神。通过一起工作和分享各自领域(开发或运营)的知识，团队成员彼此产生共鸣。这反过来又产生了下游效应，现在能够围绕交付渠道的修复/增长/运营/扩张进行更好的合作。

我一次又一次看到的唯一挑战是，当团队需要“力量倍增”的想法时，一个或多个主要瓶颈已经存在。这些瓶颈通常是真实存在的，并且是由资源不平衡造成的:服务器到达的速度快于要安装/堆叠/配置/打开的资源。数据库管理员无法处理需要审查/测试/部署的大量模式更改。开发人员必须等待某个或某些有权发布包的人，然后包才能“上线”你可能有你自己的瓶颈，你自己心里看得很清楚。

下一个问题:你(或你认识的人)是否尝试过成为“力量倍增器”？答案总是复杂的，但是在团队清理的高尚尝试中总有一个共同的主题:缺乏训练。想一想:有人教过你如何成为一个力量倍增器吗？如何打造形态良好的团队？如何有效的传递知识？让问题更加复杂的是，我们当前的激励结构实际上是在颂扬世界上的“英雄”和“独角兽”，称他们为成功的范例。我们的经济奖励那些首先进入市场的人，团队建设和规范化通常不是今天萌芽中的初创公司的优先事项。除非改进工作对底线有直接影响，否则它通常不是优先事项。在这种情况下，敢于接受成为“力量倍增器”的挑战的人往往很少成功，因为知识转移必须以同步的方式进行:代码配对、肩扛演示等。这些都是耗费时间和精力的活动。机会成本现在损失了，因为一种资源交叉培训另一种资源。最终好处会实现，但不是今天…

工作量太大。结果，事情就这样一拖再拖，直到痛苦难以忍受，必须采取行动。此时，每个人都想烧掉违规的代码，重新开始。但是下一次，我们会学的。我们不会犯上次犯的同样的错误。

## 微小的变化

问题是，当你看着面前的路时，你在不断地为下一天或下一周优化，而不是为未来的几个月或几年。在季度回报的世界里，这是驱动我们的动力。因此，当问题成为真正的问题时，很容易立即开始骑自行车的对话并开始设计 v2。下一步是重新调整优化因子。发展肉云并获得额外的资源通常需要太长的时间(至少三到六个月的工作时间)，交叉培训的时间成本可能太大，过度使用资源只能到此为止。答案是什么？

## 创造人人机会均等的局面

我分享的关于 ChatOps 和事件驱动自动化的一个想法是向用户公开小任务。通过这样做，您允许团队成员和公司中的其他人“消费”您策划的行动。作为管理者，您可以向用户公开安全的操作，并允许他们做一些曾经属于单个个人或团队的事情。我想和你分享一个真实的故事，告诉你我们是如何解决的。

## StackStorm 的瓶颈

最近，我们的团队在发布 StackStorm 的木偶模块更新时遇到了瓶颈。团队可以在测试环境中整天进行更改，但是将更改发布到整个世界取决于一个人将代码发布到 Puppet Forge。显然，这并不理想。

我们来分解一下。要将模块交付给锻造厂，用户必须知道:

*   知道如何对木偶模块进行更改
*   更新模块本身
*   更新元数据
*   更新 git 储存库(标签)
*   知道如何正确包装模块，以便交付给锻造厂
*   知道傀儡锻造厂的证书吗

从表面上看，这似乎没什么——只需将这些命令放入自述文件中，让其他人复制/粘贴命令即可。但是，我的团队里没有木偶专家。他们是开发者，渴望帮助解决有趣的问题。但是由于发布的这一障碍，自然的反应是回避做出改变——不是因为能力或意愿，而是为了避免与发布代码相关的摩擦的痛苦。这意味着对代码库的任何更改通常需要至少两个人(更改和发布)。同样，任何小的或简单的变化自然会被移交给傀儡人，因为他们知道如何管理债务和驾驭局势。

相反，让我们撒一些神奇的 ChatOps 灰尘。

## 设置

首先，让我们设置我们的用户界面:ChatOps。用户体验是 ChatOps 中反复出现的一个话题，所以最好的开始是决定如何向同事和用户公开命令。首先要设置的是 ChatOps 别名。

![Screen Shot 2016-01-27 at 10.56.23 AM](../Images/18ca6c2f879dbc455aa3d69bab153ae4.png)

来源:[https://github . com/stack storm-packs/st2-publish _ puppet _ forge/blob/master/aliases/publish-puppet-st2 . YAML](https://github.com/stackstorm-packs/st2-publish_puppet_forge/blob/master/aliases/publish-puppet-st2.yaml)

我想要一个全包围的命令，用户应该输入最少的信息量。目标是有一个可以捣碎的红色大按钮，然后神奇地释放出一个木偶模块。现在这应该发生在任何用户输入的时候！puppet publish puppet-st2…stack storm 将运行 stackstorm.publish-puppet-st2 操作，并将 branch 属性设置为用户键入的任何内容。我们选择重用 puppet 名称空间，因为它已经填充了类似的动作。

下一步是为新的 stackstorm.publish-puppet-st2 动作设置一些伴随的动作元数据。我们希望它运行一个新的工作流，处理我们上面讨论的所有操作。我需要从用户那里获得的唯一变量是 branch 参数，因此编写元数据应该很容易。我们今天只看一下工作流程。

![Screen Shot 2016-01-27 at 10.59.04 AM](../Images/56f8f7bf6ca042f27ee3f6ef2a63c8a3.png)
![Screen Shot 2016-01-27 at 11.00.26 AM](../Images/9f83a6e87e6f3daeddfaa770eaa9c9af.png)
![Screen Shot 2016-01-27 at 11.01.04 AM](../Images/9cb4ec4b0b6a8cce6304c8bdb3ffdecd.png)
来源:[https://github . com/stack storm-packs/st2-publish _ puppet _ forge/blob/master/actions/workflows/publish-puppet-st2 . YAML](https://github.com/stackstorm-packs/st2-publish_puppet_forge/blob/master/actions/workflows/publish-puppet-st2.yaml)

文件的顶部包括我们的 vars 部分。puppet-blacksmith 应用程序不是为多用户运行而构建的，所以我们的工作流需要能够适应。因此，我们需要知道 gem 将期望一个带有用户名(forge_username)和密码(forge_password)的凭证文件(forge_file)。我们还需要知道我们的暂存目录在哪里(repo_dir)，上游目标在哪里(repo_url)。很简单。接下来的几个步骤，clone-puppet-module-from-git、bootstrap-puppet-module、cleanup-vendored-gems 和 set-puppetforge-credentials 确保构建主机设置正确。这些操作从上游连续下载存储库，运行所有的引导命令，尝试确保一个原始的目录，然后设置 puppet-blacksmith forge 文件。在这一点上，实际上什么都没有做，只是一些准备。

重要的是要注意这里的第三步(cleanup-vendored-gems):这是一个经常被遗忘的小步骤，最终会创建兆字节大小的归档文件，而不是千字节大小的归档文件，这更合理，也更符合预期。

最后的步骤——标记-傀儡-模块、构建-傀儡-模块、上传-模块-锻造和推送-git-标记——是大部分工作发生的地方。接下来的步骤主要是运行几个 rake 任务，然后标记 git 存储库并向上游重新发布包。这些动作中的大部分是由木偶铁匠 gem 实现的，但是现在被封装在一个很好的工作流中，很容易被使用。

果然，如果你建造了它，他们就会来…

可宽延时间 _1

像这样的技术直接使你的团队力量倍增。本质上，你的角色从一个“负责”交付的人转变为“促成”交付的人。这是一个非常小的例子，但是很强大。让团队中的其他人成为力量倍增器可以让他们继续工作，让你专注于更重要的事情，还可以创造出前所未有的透明度。大家都知道软件什么时候发布；任何人都有这个能力。这些小积木加起来足够多，团队成员会突然更倾向于承担风险，帮助推动变革，因为他们知道背后有一个安全网。

## 值得考虑

向我提出了两个非常有趣的观点，值得在此讨论:

**敏捷宣言，规则#1:** 个人和交互优于过程和工具。试图执行人类工作流程的工具？GTFO！

这种范式延伸了多远？当然，“过程”是最糟糕的。当被调用时，它通常意味着必须严格遵守大量的文书工作或规则。缺点是许多所述过程本质上是手动，因此容易出错。类似地，在了解他们想要实现什么或者至少定义一套原则之前实施工具的公司中，工具最终决定了公司的工作方式，而不是相反。这里的重点是人类是主宰。

同意。这里不合理的是存在于这里和整个 IT 行业的潜在期望:技术专家必须对大量的事情有大量的了解。即使在我自己的专业领域，我也想不出比试图记住如何部署我已经三个多月没碰过的代码更让人泄气的事情了。最终我会记得，但这是一个拖累，并引入了不必要的摩擦。现在，在一个更大的团队中发挥这一点，并成倍增加。

**‘我会变得多余’:**我还没有看到这种情况发生。取而代之的是合作。开发人员可以专注于发布和更新他们的代码，而不会干扰运营，运营人员可以关注总体问题(容量、电源、存储)，而不是事务性任务，如“推送此代码”或“重置此密码”我认识的大多数开发人员都不怕弄脏自己，但这不是他们愿意花时间的地方。开发者想要发展。如果你能为他们提供更好的工具来做到这一点，那么每个人都是赢家。你曾经在小任务上消耗的葡萄糖可以而且经常变成自助服务，你可以去创造更酷的界面供用户使用。

## 包裹

瓶颈存在。随着公司的成长和扩张，它们能够也将会不断涌现。有时，您可能会发现自己处于这样一种情况，由于技术债务，瓶颈随着时间的推移而积累，而其他时候，您加入了一个新的团队，而这些债务可能已经获得了所欠金额的利息。无论哪种方式，都存在需要采取措施的情况。不要直接去找 RPG，烧掉房子然后重新开始，考虑更小的方法让别人做你做的事情。

今天你要带走一些想法:

*   照料你的技术花园:助理牧师，不要操作
*   做出小而透明的改变以获得持久的效果
*   一起成长:不要控制变化

下次见！

## 关于作者/詹姆斯·弗莱曼

James 现在是 StackStorm 的高级开发工程师，最近在 GitHub 协助开发和管理运营团队的系统扩展。James 还经常在世界各地的会议上就自动化主题发表演讲。

Twitter: [@jfryman](https://www.twitter.com/jfryman)LinkedIn: [https://www.linkedin.com/in/jamesfryman](https://www.evernote.com/OutboundRedirect.action?dest=https%3A%2F%2Fwww.linkedin.com%2Fin%2Fjamesfryman)email: [[email protected]](/cdn-cgi/l/email-protection) / [[email protected]](/cdn-cgi/l/email-protection)