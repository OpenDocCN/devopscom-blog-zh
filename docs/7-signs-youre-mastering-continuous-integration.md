# 你掌握持续集成的 7 个标志

> 原文：<https://devops.com/7-signs-youre-mastering-continuous-integration/>

大多数组织认为他们正在进行持续集成(CI ),然而当被问及他们是否遵循 CI 的关键实践时，例如运行测试来验证每个构建，他们中的许多人并没有。问问你自己:“我们是在每次改变时构建我们的应用程序，还是至少一天多次？我们是否避免长时间运行的特征分支？我们是否优先修复破损的构建，而不是提交新的变更？”如果你对这些问题的任何一个回答是“不”，那么猜猜会发生什么？你并不是真的在做 CI，而且你并不孤单。

持续交付(CD)是 DevOps 的基础，建立在持续集成的实践之上。因此，您必须正确实施 CI，然后才能真正通过 CD 和 DevOps 取得成功。换句话说，你必须先爬才能走。

## 掌握持续集成的步骤

为了实现业务目标，以下是组织必须掌握 CI 的七项实践:

### **在中央服务器上自动化构建——整个构建—**

这似乎是一个显而易见的问题——的确如此。当然，在实现持续集成之前，组织要么在开发人员的桌面上本地构建，让构建工程师手动集成代码，要么必须完成一系列容易出错的脆弱的手动步骤。但是，令人惊讶的是，许多声称实施 CI 的组织仍然搞错了这一点。

简而言之，您的持续集成构建应该运行一个中央共享服务器，能够完全无人值守地运行，并且是自动化的，这样相同的输入每次都会产生相同的输出。

### **尽可能频繁地构建**

实践 CI 构建的团队每天都要进行多次构建，理想的情况是在拉取请求、合并或提交时触发每次变更的构建。每次提交构建使错误一出现就被发现，并且更容易修复。

持续集成中的“持续”一词应该尽可能从字面上理解。我经常问组织他们多久进行一次构建，答案是以下之一:

1.  我们每周做 X 次“按钮式”构建
2.  我们每天晚上都做，每周做一次
3.  我们每天在 X 时间构建一次

正如您可能已经推断出的，这些不是“连续的”构建。它们可能是集中构建、自动化构建或计划构建。但是这些并没有提供持续集成的好处。如果一个构建中断了，而你有两天的 30 个提交，由 10 个不同的开发人员完成，你可能必须对所有的工作进行分类，找出并纠正构建的原因。生产力被扼杀。

### **频繁提交或合并到主线**

进行 CI 的团队可能会在每次变更时或者至少每天一次提交/合并到主干或主流程中。例如，如果您维护长时间运行的特性分支，您就不能获得频繁验证集成变更的好处。如果你分支了很长一段时间，当它被合并时，集成就被延迟了，你可能会有冲突或者错误需要修复。

### **快速构建**

如果您正在实践持续集成，您的构建可能在 5-10 分钟内完成。如果构建花费更长的时间(一些组织有超过五个小时的 CI 构建)，不仅您延迟了集成，因此延迟了有价值的反馈，而且开发人员不太可能提交变更，因为他们的生产效率的成本——或者，更糟糕的是，他们继续提交损坏的代码。

花时间来优化您的构建和验证时间。这可能需要您分解您的 CI 构建流程，以与组件或团队保持一致，然后将整个集成应用程序作为整个开发流程中的一个单独步骤进行验证。

### **验证构建**

CI 包括验证变更和生成的构建。这种测试应该是整个构建过程的一部分。如果您唯一的验证仅仅基于确认软件编译和链接，那么您就不是真正在实践 CI。大多数实践 CI 的团队在 CI 构建中包括代码扫描和单元测试。

### **在类似生产的环境中验证**

成熟的 CI 实践者确保开发、测试和生产前环境之间的一致性。最成熟的方法是使用虚拟机或容器、服务虚拟化和其他技术，以确保他们在类似生产的环境中执行验证，并降低在预生产或生产中发现下游错误的风险，即使在集成更改之后也是如此。

### **立即修复损坏的构建**

如前所述，团队快速发现并解决问题是至关重要的，这样他们就不会转移到下游。使用 CI，过程被建立起来，在那里构建被连续地验证和提交，所以如果有问题，就更容易修复。如果错误的构建被忽略，问题将更难发现和修复，但更糟糕的是它鼓励的文化。CI 以质量第一为基础。如果构建中断，“停止生产线”并修复构建。从长远来看，每个人都会因此受益。

## 不要忘记文化

如果一个组织可以看到这七个标志，并说它做到了所有这些事情，那么它就真的在做 CI。这些看起来很简单，但是当这些原则结合起来时，结果是显著的。

不能说他们遵循了这些原则的组织可能会在定期交付功能构建时遇到问题。该计划将会失败，团队成员会变得沮丧，并回到他们原来的方式。不仅会有流程问题，还会有文化问题——这是许多组织陷入困境的地方。

团队必须改变他们合作的方式，他们还必须确保他们在心态上保持一致。CI 对组织有很多好处，但是不要忘记它实际上是被设计来接受失败，而不是消除失败。持续集成创建了一个系统，在这个系统中，开发人员可以快速失败，因此他们可以尽早快速地发现并修复错误。

持续集成是真正的 DevOps 转型的基础要素之一，众所周知，这是当今许多企业的重中之重。做对— *真正做对—*—对跟上现代商业需求至关重要。

— [布莱恩·道森](https://devops.com/author/bdawson/)