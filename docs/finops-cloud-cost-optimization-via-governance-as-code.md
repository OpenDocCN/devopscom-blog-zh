# 通过治理即代码优化 FinOps 云成本

> 原文：<https://devops.com/finops-cloud-cost-optimization-via-governance-as-code/>

云实施的范围和复杂性都在持续增长。通常，这种扩张也意味着成本失控。在本文中，我们将探讨为什么新兴的云财务管理实践(FinOps)对于控制云中的成本如此重要。然后我们将讨论团队在开始应用 FinOps 方法时遇到的挑战。最后，我们将揭示通过采用治理即代码来建立持续的[云成本优化](https://devops.com/?s=cloud+cost+optimization)所带来的机会，以及这种方法如何使团队将 FinOps 理论付诸实践，以便他们可以控制云成本。

## FinOps 的出现

对于许多组织来说，一直存在利用云服务的竞赛，团队寻求实现灵活性、敏捷性和效率方面的优势。在一个组织内，不仅仅是更多的工作负载在云中运行，而是使用更独特的部署模式，更多的团队使用云服务并利用多个服务提供商。

在这个过程中，团队不得不应对必须管理和支付的实现的规模和多样性的快速增长。正是后一个方面让那些负责管理预算的人猛然醒悟。如果不加以控制，云使用的这种增长会导致成本不断攀升，随着部署变得更加复杂和频繁，预测、管理和控制这些成本只会变得更加困难。

这种对改进成本管理的需求催生了一门新学科:云财务管理；或者 FinOps。简而言之，FinOps 是一种将财务纪律和责任引入云中可变成本范式的方式。FinOps 汇集了技术、流程和团队的组合，包括来自技术、财务和业务的专业人士。通过提高理解、跟踪和管理云成本的能力，团队可以开始最大化通过云支出实现的价值。鉴于云成本管理的战略性和紧迫性，FinOps 团队的增长就不足为奇了。根据 FinOps Foundation 进行的研究，FinOps 团队比去年增长了 47%，这些专业人士预计他们的团队明年将增长 75%。

## 建立金融机构面临的挑战

虽然 FinOps 实践的建立背后有很多希望，但团队的道路上也有许多障碍。当 FinOps 基金会向受访者询问最大的挑战时，以下是五个最大的回答:

*   让工程师采取行动(39%)
*   处理分摊成本(33%)
*   准确预测(26%)
*   减少浪费或未使用的资源(25%)
*   费用全额分摊(23%)

缺乏对多云环境的全面控制和可见性意味着这些团队无法主动管理成本，并且往往在事后才发现浪费的支出和未充分利用资源的高成本。因为延伸的团队依赖于手动跟进和策略，很难让工程师根据需要快速有效地做出响应。

使这些挑战更加复杂的是，跨团队使用不同的工具和过程。例如，不同的开发团队可能使用不同的提供商服务和不同的部署工具，如 AWS Cloud Formation、HashiCorp Terraform、Kubernetes 等等。这种不一致导致了效率低下和沟通不畅，并抑制了团队的生产力。

虽然与传统的内部基础架构相比，云提供了一系列优势，但如果没有适当的治理，云成本可能会迅速失控。事实上，Gartner 分析师报告称，在未来几年内，60%的组织将在公共云中遭遇成本超支。

## 重新思考成本管理

出于上述所有原因，团队被要求采用一种新的方法来进行云成本管理，这种方法要符合 FinOps 的原则。对许多人来说，这意味着接受治理即代码的概念来优化云成本。云治理代码代表了一种在快速变化的云环境中自动和动态应用策略的方式，包括成本优化。

使用代码治理方法，策略是使用标准语言定义的。与成本策略相关的代码的创建、部署和维护方式与开发人员管理应用程序或基础设施代码的方式非常相似。开发人员不必担心跟踪或管理成本。根据云基础架构的当前状态、利用率和配置，不断评估成本策略。如果发生任何违规，可以触发自动通知和工作流。以下是使用治理即代码建立持续云成本优化的关键要求:

### 成本政策是通过直观的语言定义的

传统上，开发、运营和财务团队各自为政。每个团队都有自己的工具、工作流程和政策，甚至基本术语也可能有很大差异。

为了通过代码治理最大限度地发挥持续云成本优化的潜力，解决方案需要支持团队使用易于理解的一致语言来定义、管理和修订策略。这使得不同的团队更容易协作，并在关键成本管理政策和最佳实践上取得一致。

最后，为了有效地建立持续的云成本优化，治理即代码产品需要采用一种独立于应用程序开发人员可能使用的任何特定编程语言的语言。此外，这些语言应该适用于最广泛的应用程序、云服务、开发工具等等。这对于确保开发团队在他们可以使用的工具和服务中保持最大的灵活性是至关重要的。

### 成本策略通过 CI/CD 工作流中的 Git 进行管理和部署

一旦策略被评审和最终确定，团队必须能够在开发组织现有的持续集成/持续交付(CI/CD)工作流中应用这些策略。

通过健壮的治理即代码方法，团队可以将成本策略创建为代码工件，并通过 Git 等开源版本控制系统部署它们。通过这种方法，团队可以以与他们的软件开发和交付生命周期一致的方式应用策略。

通过以这种方式编纂成本治理，可以通过 CI/CD 管道中的 Git 部署成本控制。这种方法使团队能够避免与管理票证、请求变更等任务相关的复杂手动流程。这也有助于团队跟上当今动态云和开发环境不断加快的步伐。此外，这种方法意味着治理代码可以通过各种状态变化进行跟踪，如果需要可以回滚等等，就像应用程序代码一样。

### 实时检测并解决违反成本策略的情况

通过治理即代码的持续云成本优化，团队不仅能够进行持续检测，还能立即采取行动。可以定期采用策略，也可以根据特定事件触发策略。这种方法可以强制执行可能需要的工作流和操作。如果违反策略，会自动通知相关团队或团队成员，并触发高级工作流。例如，策略可以标识超过 30 天的 RDS 实例，这些实例在过去 14 天内没有任何连接。然后它会通知这些实例的所有者。如果他们在七天内不采取行动，实例将自动停止。

### 成本政策不断得到执行和完善

持续云成本治理(即代码)有一个永无止境的生命周期，就像团队的软件开发生命周期一样。构建、部署、测试和发布成本治理代码，并且随着时间的推移，随着新策略的开发和完善，该过程将继续。随着需求的变化，团队需要能够定期分析成本数据，并根据需要更新策略。

随着组织继续在云实施上投入更多资金，建立强大 FinOps 能力的需求只会变得更加重要。然而，随着这些云部署变得越来越复杂，实现 FinOps 的承诺会变得越来越困难。由于这些原因，采用治理即代码来建立持续的成本管理正在成为一种关键的方法。通过这种方法，团队可以实现持续的合规性并最大限度地减少浪费。