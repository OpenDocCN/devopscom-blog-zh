# DevOps 中的 API 安全:我们是不是太舒服了？

> 原文：<https://devops.com/api-security-in-devops-are-we-too-comfortable/>

Postman 对开发人员进行了年度[调查](https://www.getpostman.com/resources/infographics/api-survey-2019/),正如该调查和许多其他调查所显示的那样，开发人员普遍对他们的组织已经实现的 API 安全级别感到满意。这是一个一致的趋势，大多数开发人员对自己受到保护感到满意。

问题是大多数组织也将 API 安全性和管理放在开发人员手中。

了解敏捷/开发团队的变化速度，了解环境的复杂性，我认为这种心态类似于二战前法国对马奇诺防线的信念。

虽然 API 安全性肯定是必要的，但它不是在真空中管理的。你实际上只和你最薄弱的环节一样安全，在一个以 API 为中心的环境中有很多环节。用户凭证、令牌、SSL、请求应用程序及其身份验证、(仍然)代码注入问题……清单还在继续。

我对目前在 DevOps 环境中实现的 API 安全级别感到不舒服。我认为这对你来说很危险。只要一次错误的代码迭代，其中一个客户端实例就容易受到攻击。该漏洞暴露了有问题的客户端可以访问的每个 API，无论使用什么作为访问控制。

最终，API 必须信任某个人，否则它们就没用了。这个人通常是运行在用户连接的实例上的服务器应用程序。该应用程序通常有自己的凭据。它们是如何储存的？他们是如何受到保护的？哪些代码更改会影响该实例的安全性？

API 网关和管理工具，如果配置得当，在这里是一个很大的帮助，但它们不是万能的。由于传入连接在某种程度上必须是可信的，传出连接在某种程度上必须被认为是干净的，当这两者中的一个是错误的假设时，您应该采取什么措施呢？

场景是这样的:用户 A 有权调用 ShowMeCriticalData API。这个 API 是从实例 b 上运行的服务器应用程序调用的。服务器应用程序对用户 A 进行身份验证，然后为他调用 API——要么使用他的凭证(最好的情况),要么使用它自己的凭证(不利于跟踪问题)。如果实例 B 收到一个使其容易受到危害的更新，仍然需要用户凭据来调用 ShowMeCriticalData，这是相对安全的，只要用户 A 充分保护他们的凭据。但是，如果在实例 B 上运行的应用程序代理请求并使用自己的凭据，实例 B 就会成为一个弱点，攻击者可能会利用该漏洞调用 API 而不验证用户。更糟糕的是，如果用户 A 不注意他们的身份验证信息，组织几乎无法阻止至少一些滥用。

API 日志记录和审查可以通过用户名注意到奇怪的行为，并提供用户受到威胁的早期警告。但只会捕捉大多数问题。

当然，有一些聪明人正在研究 API 安全威胁的整个阵列，从跨站点脚本到认证欺骗，甚至到 TLS 弱点。但是，只有当我们都记得我们的安全可以更好的时候，这项工作才有用。知道存在弱点后，我们就可以寻找减轻风险的方法。众所周知，如果你有公共 API，风险将永远不会消除——公共 API 的目的是让人们使用它，这将它暴露给似乎越来越聪明的黑客——但将风险最小化是值得的。

在目前的情况下保持安全意味着你没有专注于让它变得更好。对于 API 安全性，尤其是在 DevOps 创建的动态环境中，这是一条危险的道路。假设存在致命缺陷，并努力减少整个系统中每个接入点的漏洞。

这也适用于你不拥有的 API。我们对调用 Google Places 的 API 进行了评级限制，以匹配我们的项目计划/预算。我们的应用永远不会接近谷歌的使用上限，但如果我们的一部分基础设施受到损害，我们可能会收到谷歌的巨额账单，因为我们在一个月内调用该 API 无数次。可能吗？不完全是。可能吗？而不是在几行限速代码之后。

你们都制作了一些令人惊叹的应用程序。确保它们受到惊人的保护。因为业务和用户都指望它。

唐·麦克维蒂