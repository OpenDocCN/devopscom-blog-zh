# 为什么脸书容易受到身份验证漏洞的攻击？

> 原文：<https://devops.com/why-was-facebook-vulnerable-to-an-authentication-exploit/>

## 发生了什么:

作为 bug bounty 计划的一部分，AppSecure 网络安全研究团队在脸书的认证机制上发现了一个漏洞。这让他们有可能获得对这家社交媒体巨头超过 10 亿用户的完全控制。该团队因其发现赢得了 15，000 美元的奖金。

这个漏洞是在一个利基 API 上发现的，这提醒我们，在许多情况下，最有趣的错误并不存在于主 API 上，而是存在于保护机制较少的辅助 API 上。

AppSecure 的首席执行官 Anand Prakash 被认为发现了这个漏洞，[解释了他的发现](https://www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all-facebook-accounts-f47c0252ae4d/):“通过设置新密码，我可以完全访问其他用户帐户。我可以查看邮件、他们存储在支付部分的信用卡/借记卡、个人照片和其他私人信息。”

尽管该漏洞是在 2016 年发现的，但自那以来，类似的漏洞已经被发现，并在许多情况下被利用。下面是对脸书案例的详细介绍，以及在现代应用程序开发中应该吸取的教训。

## 技术细节

该漏洞利用了脸书上的密码恢复机制。该过程的步骤是:

1.  用户通过使用他们的电子邮件地址开始“忘记密码”过程。
2.  脸书向用户发送带有 6 位临时秘密令牌的文本消息。
3.  用户输入接收到的临时代码，浏览器发送 API 调用以“用秘密令牌张贴 facebook.com/recover/as/code/"”。

![](img/1f3549819661f174e832baea01e2bf8a.png)

脸书在这个 API 上实现了一个反暴力机制，在 10 次尝试失败后阻止了用户。然而，在他们的研究过程中，AppSecure 团队发现，相同的 API 端点存在于不同的 API 主机上，分别位于“beta.facebook.com”和“mbasic.beta.facebook.com”下。这些 API 主机没有实现反暴力机制，使攻击者能够轻松地迭代通过秘密令牌并重置受害者的密码。

## 为什么当前的安全解决方案检测不到它

跟踪你的 API 不是一件容易的事情。现代组织可能有几十甚至几百个 API 主机，用于不同的环境、地区或版本。每个 API 主机可以公开多个与身份验证过程相关的 API 端点，包括登录、忘记密码和一次性登录链接。市场上的许多安全解决方案专注于保护您的主要 API，而对不太常用或较少使用的 API(如上面例子中脸书的 beta API)缺乏足够的可见性。老练的攻击者选择瞄准那些利基 API。

## 可追溯性如何解决问题

Traceable AI 监控所有 API，包括不同的环境、版本和区域。对于每个 API 主机，我们自动和手动检测您的 API 公开的身份验证端点(包括登录、忘记密码等)。

这种对 API 结构的精细理解使我们能够为您最敏感的资产设置非常严格的保护。

## 有兴趣了解更多吗？

观看我们录制的演示和[看到可追溯的国防人工智能在行动](https://www.traceable.ai/view-traceable-demo)！