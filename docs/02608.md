# 构建令人惊叹的应用程序，第 2 部分:优化后端

> 原文:[https://devo PS . com/building-amazing-apps-part-2-optimizing-the-back-end/](https://devops.com/building-amazing-apps-part-2-optimizing-the-back-end/)

这是关于在边缘构建和交付令人惊叹的应用的三篇系列文章的第二部分。要阅读第一部分，点击[这里](https://devops.com/building-amazing-apps-part-1-optimizing-the-front-end/)。

如今有数以百万计的应用程序可用，任何用户只需在屏幕上轻点几下或点击一下鼠标，就可以非常容易地下载并安装其中的任何一个。如果你想开发并交付一款让用户惊喜的应用，你需要能够与众不同。

在过去的 14 年里，我一直与提供最受欢迎的应用程序的顶级公司密切合作，帮助他们优化应用程序的速度和规模，以便用户获得出色的体验。在这个由三部分组成的系列中，我们将探索你必须采取的基本步骤，以构建和交付你自己的令人惊叹的大规模应用程序，让用户不断回来。

我们将这些步骤分为三个关键领域:

*   [前端](https://devops.com/building-amazing-apps-part-1-optimizing-the-front-end/) :覆盖最终用户与之交互的 app 部分。
*   后端:查看支持应用程序所需的原始基础设施，包括数据库、应用程序、web 服务器等。
*   中英里:探索互联网，所有信息都需要在前端和后端之间来回传递。

在本文中，我们将探讨您可以在后端做的五件事情。

## **分布式架构**

简而言之，分布式架构意味着拥有地理上分散的源(后端)基础设施，以最大化可用性和性能。

后端配置有三种主要类型:

*   **内部:**这是您的组织拥有和管理硬件和软件的地方。这种类型的后端体系结构通常更昂贵，维护起来需要大量资源，但提供了更高的安全性和灵活性，因为您可以完全控制硬件和软件。
*   **云托管:**第三方云提供商托管硬件和软件。这种类型的架构运行在专用或多租户服务器上，创建和管理起来通常更具成本效益，因为一些云提供商包含高效的基础架构配置/编排工具。
*   **混合:**这是您的架构混合了内部部署和云托管。这是最灵活和最常见的解决方案，因为传统上依赖所有内部架构的大多数公司正在慢慢地将他们的一些后端迁移到云。对于这种类型的解决方案，最好使用开源的多云工具解决方案。

您的配置目标应该是拥有一个地理位置足够分散的后端系统(大多数位置靠近您的用户)，以确保低网络延迟，同时避免单点故障，以确保服务运行，即使出现任何局部中断。

无论您的配置如何，分布式体系结构的一般思想都是相同的:使用数据中心，通过全局负载平衡器分配负载，并通过快速的光纤专用链路在数据中心之间复制关键信息。

以下是一些你可以研究的概念，它们将帮助你选择最适合你需求的分布式架构:虚拟机、容器、微服务、数据复制、无状态应用、无服务器、分布式处理等。DevOps.com 是了解他们更多信息的绝佳资源。

一般来说，您可以通过在最终用户和后端之间放置一个内容交付网络(CDN)来简化您的原始基础架构，并最大限度地提高最终用户的性能。CDN 是一个反向代理的超级分布式网络，允许您将内容放在离最终用户非常近的地方，最大限度地减少网络延迟，以实现快速的应用交互，特别是当 CDN 在其边缘服务器上缓存您的内容时。

## **自动缩放**

您可以通过选择根据当前流量需求自动扩展(上下扩展)的架构来优化成本和性能。为了有效地实现这一点，您需要监控全局流量，并设置按需启动基础架构的触发器，以便它在需要时准备就绪。大多数最大的云服务公司都支持自动扩展服务，其中一些甚至允许您调整设置以支持成本或性能。实施有效自动扩展的最简单方法之一是使用 CDN，它可以通过配置一组规则来定义哪些内容应该完全由 CDN 处理(在边缘动态生成或缓存)以及哪些内容应该从原始基础架构中提取，从而以最少的工作量自动扩展流量。

## **连续监控**

持续监控有助于保持服务质量。有许多用于持续监控的开源工具，主要分为以下四类:

*   基础架构监控:这允许您跟踪计算资源、存储、网络使用等。
*   云提供商:大多数最大的云提供商都在各自的云平台中集成了监控后端的工具。
*   应用程序性能监控(APM):监控应用程序的框架。
*   聚合器(Aggregators ):允许您跨多个监控工具聚合和分析数据的工具。

此外，用真实用户监控(RUM)工具来补充服务器端监控，以确定特定的代码部署是否会影响性能，这是一个好主意。

## **性能**

更快的后端有助于更快的前端，正如我们从本系列 的第一部分 [中所知，性能是用户体验的主要贡献者。除了专注于改善包括延迟、吞吐量和错误(所有这些都与后端性能直接相关)在内的指标之外，在您的公司中建立“性能文化”也很重要。José Pérez 在他的文章《](https://devops.com/building-amazing-apps-part-1-optimizing-the-front-end/)[培养网络绩效文化](https://jmperezperez.com/fostering-web-performance-culture/)》中概述了这个概念这是一个很好的例子，通过将性能工具集成到您的 ide 中，您可以在您的组织中实现性能文化——这可以向开发人员提供关于新代码如何根据定义的性能基线执行的即时反馈，以便在部署之前识别任何可能降低性能的代码。

对于非个性化的内容，如产品目录、新闻或媒体资产，您可以通过在后端放置 CDN(并将该内容缓存在 CDN 的边缘服务器上)来轻松提高性能。这些边缘服务器分布在世界各地，比您的后端基础设施更靠近最终用户，以最小化网络延迟和最大化吞吐量。

## **DevOps 自动化**

最后，设置有效的监控(以及快速响应故障)的一个重要部分是 DevOps 自动化。构建自动化的 DevOps 工具允许您实时自动地对变化的条件做出反应。

例如，当部署影响服务时，您可以使用 DevOps automation 通过 Slack 等聊天系统提醒您的团队，并在聊天应用程序中选择轻松回滚部署。DevOps 自动化的另一个很好的例子是 [Pinterest 实现了一个“性能侦探”](https://github.com/cshaver/perfmatters-notes/blob/master/day-1/Making-Pinterest-Fast_Jess-Michelle-Sarah.md) ，它运行一个二分搜索法(类似于 git 等分)来确定在发布后降低应用性能的违规提交。如果您将这两个自动化结合起来，您可以检测到由发布导致的性能下降；让 DevOps 团队知道它已经被回滚，并在版本控制库中跟踪有问题的代码。这只是 DevOps 自动化可以进一步优化您的后端的众多方法中的一个具体示例。

接下来，在这个由三部分组成的系列中，你需要知道的关于优化中英里的一切。

— [哈维尔·加尔萨](https://devops.com/author/javier-garza/)