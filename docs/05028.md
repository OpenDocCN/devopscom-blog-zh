# 测试驱动设计的好处

> 原文:[https://devops.com/the-benefits-of-test-driven-design/](https://devops.com/the-benefits-of-test-driven-design/)

在 John Hancock，我们对所有的新项目都使用测试驱动设计(TDD)。TDD 有三个简单的步骤:

1.  在你写功能代码之前，写一个测试来证明实现是成功还是失败。
2.  写代码，看测试通过。
3.  检查添加的功能是否改变了你的整体方法，以及你是否想要整合/重构你的一些代码。如果是，重构这些部分。

这听起来很简单，为什么要写一篇关于三步过程的文章呢？为什么我们，在约翰·汉考克数字实现公司，对 TDD 如此兴奋？ 我们已经看到了对我们的开发人员、产品和文化的重大影响:

*   增强动力和自信心。
*   更短的发布周期。
*   提高代码质量。
*   生产中的缺陷大量减少。

## **雾蒙蒙的小路**

把你的发展过程想象成一条雾蒙蒙的小路，你可以直接看到前方，但任何更远的地方都变得雾蒙蒙的，不精确。把它想象成一次探索未知的旅行。

障碍可能会突然出现，迫使你重新思考你的方法(重构)，或者你可能会在长途旅行后拨开迷雾，意识到有一种简单得多的方法可以达到你的目标(也是重构)。

这种不确定性和不断的变化可能看起来令人害怕，并引发焦虑，但 TDD 是安全网，因为你知道你所建立的可以抵御所有已识别的风险。作为一名开发人员，我可以承担更高的风险，尝试不同的方法并快速获得验证。

作为 TDD 流程的一部分构建的测试用例被理想地集成到持续集成/持续开发(CI/CD)平台中，为工程师提供快速可靠的反馈，告知他们代码变更可能导致的意外行为。因为给工程师的反馈几乎是即时的，所以开发人员熟悉导致错误的变更，并且能够快速解决它。

## **TDD 是“永远不要改变正在运行的系统”的反义词**

一个众所周知的问题是，缺陷发现得越晚，解决的代价就越大。TDD 支持快速反馈循环，因此可以快速解决 bug，并节省成本。

随着应用程序的增长，TDD 为你已经构建的一切提供了坚实的基础。您可以确信您构建的东西是可靠的，并且新的功能可以很容易地添加到其中，而不必冒破坏一切的风险。换句话说，TDD 与“永远不要改变正在运行的系统”相反，它使我们能够构建更好的软件。

## TDD 总是提供最新的代码文档

TDD 为应用程序的需求和行为提供了优秀的文档。虽然文档总是落后于功能代码，并且通常是在功能实现之后编写的，但是在 TDD 的世界中，一切都是从测试开始的。测试文档总是最新的，并为开发人员提供了一种简单易懂的方式来判断应用程序正在实现什么，而无需剖析整个代码。

特里·普拉切特的一句话最好地解释了这一点: “如果你不知道你从哪里来，那么你也不知道你在哪里，如果你不知道你在哪里，那么你也不知道你要去哪里。如果你不知道你要去哪里，你可能会走错路。”

随着应用程序的成长、发展和构建，随着它的传递和移交，TDD 给它提供文档并描述它的坚实基础。编写测试用例的行为迫使开发人员停下来思考将要实现的功能，并描述其期望的结果。

## **TDD 提供早期反馈**

通过 TDD，我们收到了关于我们即将踏上的道路的早期反馈。早期指标可以帮助我们纠正我们的假设，或者帮助我们重新表述或重写一个需求，以便我们交付客户价值。

我们遇到的早期迹象:

*   功能无法衡量:如果我们无法衡量其结果，我们为什么要实施它？
*   功能不增加任何价值。
*   功能不能被测试:类似于第一个要点，如果一个功能不能被测试，我们如何接受它的交付？
*   功能可以很容易地嵌入到需要重构的应用程序的现有部分中:这可以在我们开始实现之前触发重构。

如前所述，在开始之前考虑一下未来的步骤是非常有帮助的，这对于工程师来说是很难做到的。TDD 用一种对工程师来说很自然的语言来做这件事。

## TDD 拥抱不断变化的世界，消除对变化的恐惧

作为极限编程(XP)的一部分，TDD 接受并拥抱一个我们无法控制的不断变化的世界。随着计划变得困难/不同，变化可能会导致不适和焦虑。

在一个不稳定、无组织的软件项目中，改变被抛向它，一个坚实的基础被丢失，测试被跳过或推迟到最后，重构被跳过，所有这些都以按时交付的名义。应用程序的第一次交付可能是准时的，但是随着时间的推移，焦虑会增加，到处都是随机的 bug，修复的 bug 越多，出现的问题就越多，实际上你最终会玩一个你永远无法控制的打地鼠游戏。

在一个包含 XP 原则的项目中，比如 TDD，我们试图从一开始就保持控制，尽早面对挑战，这样他们就不会在以后咬我们。一个坚实的测试基础给了开发人员和团队中的每个人信心，让他们相信交付的解决方案将会工作，但最重要的是，它消除了对变化的恐惧。

没有对变化的恐惧，我们可以尝试各种疯狂的事情，测试各种想法，看着它们成功或失败，而不会出现代码失败，不会失去客户，也不会在呼叫中心接到电话。

## **传统的质量保证和发布周期对于这个需求不断变化的新时代来说太慢了**

随着软件的增长，它的测试变得更加激烈。因此，每一个新的功能都必须有一个相应的测试用例。这些测试的手动执行变得冗长，对开发人员的反馈变得缓慢，发布被推迟，客户不能及时获得新的功能，最终损失了金钱。

对于这个需求不断变化的新时代来说，传统的 QA 和发布周期太慢了。如果我想发布每日或每周？我们必须每次都执行测试程序吗？发现 bug 并修复怎么办？我们需要重新运行整个集合吗？

答案是肯定的——但是如果一台机器在几分钟内就完成了，谁会在乎呢？

虽然我不支持不进行人工测试，但我想说的是 95%的人工 QA 可以由机器自动执行，并且 TDD 提供了一个极好的测试集。人类可能会捕捉到机器难以识别或想象的错误，因为人类的行为很难预测，所以仍然需要现场测试以及探索性和行为测试。

## 我们剩下的是一个渴望更多，只害怕可能发生的事情的团队

在一个 [TDD](https://devops.com/tdd-unit-testing-and-the-mainframe/) 项目结束时，我们还剩下什么？我们有一个记录良好、易于理解、易于更改和稳定的代码库，由一个不怕更改的团队领导。 我们剩下的是一个渴望更多，只害怕可能发生的事情的团队。

— [尼克拉斯·斯图德](https://devops.com/author/niklas-studer/)