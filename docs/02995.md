# DevOps:让开发者体验成为现实

> 原文:[https://devo PS . com/devo PS-制作-开发者-体验-现实/](https://devops.com/devops-making-developer-experience-reality/)

作为 DevOps 专业人员，除了其他事情之外，我们有责任让开发人员的生活变得更加轻松。有多少次你听到“你有一个工作的流浪者盒子吗？”或者你需要留出几天时间来雇佣一个新的开发人员。

很多时候，开发环境是在项目开始时创建的，通常是在开发人员的工作站上。这通常意味着它可以在笔记本电脑上运行。但是，随着项目的发展，越来越多的工程师参与进来，共享这个环境的需要变得很明显。当项目变得越来越复杂，需要更多的组件和第三方服务时，这种有机发展的开发环境很快变得难以管理。

## 准备生产

开发人员环境的另一个有趣的方面是与实际生产环境的相似程度。甚至评估这一方面也需要你对产品有洞察力。如果项目在开发人员的笔记本电脑上开始，很少会考虑期望的生产设置。我记不清有多少次，当在开发团队的笔记本电脑上运行良好的“东西”没有合理的生产部署格式时，我被叫进了一个项目。

这告诉我们，即使我们开始时规模很小，我们也必须考虑项目在生产环境中如何运作，以及我们如何实现它。实际上，这意味着任何新项目至少需要以下条件:

*   一些单元测试，它们甚至可能以存根开始。
*   最小部署目标环境。
*   持续集成(CI)，运行(存根)单元测试。
*   自动交付，最好是连续部署(CD)。
*   至少一个简单的集成测试，可能只是对部署应用程序的一个`curl`来验证它是否有效。

这确实增加了项目启动的复杂性，可能超出了单个开发人员的能力。然而，它确实为至少能够在某个地方部署应用程序打下了基础。对于一个经验丰富的 DevOps 专业人员来说，添加一个基本的 CI/CD 只需要一个小时左右，并且有大量的免费云资源用于小项目。

当项目增长和开发环境变得更加复杂时，事情会变得更加棘手。上面的步骤不会真正帮助你减轻保持所有移动部件在线可能带来的挫败感。我经常看到的一种模式是，开发人员试图在他们的笔记本电脑上运行整个产品堆栈。对于一个容器化的环境，这可能意味着一个基于 [Docker Compose-](https://docs.docker.com/compose/) 的设置，甚至是 [minikube](https://kubernetes.io/docs/setup/minikube/) 来运行一个本地 kubernetes 集群。这些工具通常使用共享卷进行快速迭代，这在大量文件需要保持同步的情况下效果很好。[流浪](https://www.vagrantup.com/)是快速提升环境的好方法。这确实提供了某种程度的生产奇偶校验，但是缺少某些部分:监视提交到您的源代码存储库的 CI/CD 系统没有部署到您的本地设置，进出它的流量没有通过任何附加的基础设施，例如负载平衡器或防火墙等等。

## 本地-远程

当生产中出现问题时，“它能在我的笔记本电脑上工作！”是一个我们都曾听过的短语。如果我们能让笔记本电脑环境更接近生产环境会怎么样？如果生产中出现问题，但在本地工作站上运行良好，这不是开发人员的错。为开发人员提供使用远程基础设施进行迭代开发的选项意味着我们可以更接近生产平价。此外，这意味着团队中新开发人员的入职可以大大简化，因为所有的复杂性都在远程环境中。该远程环境以与生产环境相同的自动化方式进行调配，因此我们对其状态非常有信心。对于基于 Kubernetes 的环境，有许多很棒的工具，包括 [Skaffold](https://github.com/GoogleContainerTools/skaffold) 和 [Draft](https://draft.sh/) 。它们都提供了一种简单的方法来构建、推送和部署应用程序到 Kubernetes 集群。这使得开发人员很容易承担责任，确保正在开发的应用程序能够在目标环境中运行。

如果出于某种模糊的原因，您没有将您的应用程序容器化，而是在虚拟机中运行代码，也有一些选择。大多数现代编辑器都提供了与远程服务器的自动同步，或者是按需同步，或者是在代码更改时自动同步。Ksync 是一个工具，用于在文件更改时将本地代码同步到 Kubernetes 集群中的 pod 中。实时同步代码消除了每当您希望在部署环境中看到容器映像时重新构建并上传它的延迟。因此，代码同步工具更适合迭代开发。

最近，我和一个客户一起为一个开发团队建立了[远程呈现](https://www.telepresence.io/)。这也是一个用于 Kubernetes 环境的工具，但它提供了一个转变——开发人员可以在本地运行他们的代码，所有进出的流量都通过远程 Kubernetes 集群代理。与同步工具一样，这意味着在查看更改之前不再有长时间的延迟，IDE 调试正常工作，所有日志输出也是本地的。当代码被提交和推送时，CI/CD 系统应该用最新版本更新集群，这反过来可以用于迭代开发远程呈现。这是一个相对年轻的项目，但潜力巨大。一个额外的优势是，整个应用堆栈或环境中只有一小部分需要在开发人员的笔记本电脑上运行，这意味着它可以使用更少的内存和更便宜的 CPU。

## 结论

容器和微服务比以往任何时候都更加普遍，这使得开发人员越来越难以拥有一个类似生产的环境来进行开发。解决这个问题的关键是不要试图将所有东西都加载到一台越来越强大的笔记本电脑上，而是在开发人员工作站和远程环境之间分担负载和复杂性。

-[亚历克斯·科诺特](https://devops.com/author/alex-knol/)