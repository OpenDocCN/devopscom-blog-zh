# 如何隔离开发环境:流浪者与码头工人

> 原文：<https://devops.com/how-to-isolate-development-environments-vagrant-vs-docker/>

“它在我的机器上工作。”这一行已经成为开发人员经常滥用的借口，以逃避调查最终用户所经历的问题的负担，他们无法在他们的开发机器上复制这些问题。虽然这可能会原谅开发人员——毕竟，他们在开发期间没有经历过这个问题，因此不可能预料到它会发生在一些用户身上——但这并不能解决问题。

有时，问题是由最终用户的错误引起的，例如跳过安装过程中的某个步骤。然而，这个问题通常是由开发和服务器或用户环境的差异引起的。由于使用的机器配置种类繁多，包括不同的操作系统、硬件规格和软件版本，因此开发和生产设备配置中即使是最微小的差异也会导致许多应用程序的行为产生巨大差异。

这可能是一个严重的问题，因为它需要开发和运营团队的成员确定问题的根本原因，这可能会在部署和生产计划中引入意外的、通常是重大的延迟。特别是在 DevOps 文化中，快速开发、频繁部署和高度可靠的发布是重中之重，这种意外的延迟是完全不受欢迎的。

幸运的是，出现了许多工具来解决这个问题。在这篇文章中，我们仔细看看两个流行的工具，用两种不同的方法来解决环境差异的问题:流浪者和码头工人。像许多 DevOps 工具和技术(如持续集成)一样，这些工具适用于所有类型的项目设置，包括 [IT 人员比](https://mobilunity.com/outstaffing/)(专门的开发团队)多。让我们比较一下这两种解决方案，看看每种方案最适合哪种类型的场景。

## 流浪汉对码头工人

[vagger](https://www.vagrantup.com/)提供解决上述问题的方法，让开发人员能够轻松创建和管理[虚拟机](http://searchservervirtualization.techtarget.com/definition/virtual-machine)(VM)，他们可以在其中开发、测试和部署应用程序。通过使用虚拟机，开发人员或开发运维工程师可以确信，只要应用程序在虚拟机中运行，它的行为将是相同的，而不管运行虚拟机的计算机的实际硬件和操作系统如何。

Docker 提供了类似的解决方案，但是使用了不同的技术。它不使用虚拟机，而是使用[容器](https://www.docker.com/what-container)，类似于包含在 Linux 系统中的 [Linux 容器](https://linuxcontainers.org/) (LXC)。容器的用途与虚拟机相似，但层次更低，因此也更轻量级。容器不是将一个应用程序隔离在它自己的具有完整操作系统的虚拟计算机中，而是简单地将一个应用程序隔离在一个具有运行该应用程序所需的最少组件的环境中。这包括系统库和工具、设置和配置文件以及运行时环境。与虚拟机相比，容器从承载它的实际机器上消耗的资源要少得多。Docker 有一个全面的[文档库](https://docs.docker.com/)，其中包含了关于 Docker 和 Docker 容器是什么、如何安装 Docker 以及如何执行 Docker 运行的信息。

流浪汉和码头工人有一些共同的目标。例如，在软件开发中，这两种工具通过消除对应用程序在不同机器上的不同行为的担心，实现了更加简化和一致的软件开发和部署工作流。此外，它还为主机提供了一定程度的安全性:因为应用程序与系统的其余部分是隔离的，所以由一个应用程序引起的问题应该保持在其环境的范围内，而不应该破坏系统的其余部分。

然而，在 vagger 和 Docker 之间有许多重要的区别，使它们适合于不同类型的应用程序。让我们更仔细地看看这两者有什么不同。

### 隔离范围

虽然 vagger 和 Docker 都将应用程序包装到隔离环境中，但它们在这些应用程序的隔离程度上有所不同——或者说，在隔离环境的[范围](https://www.networkcomputing.com/cloud-infrastructure/virtual-machines-vs-containers-matter-scope/2039932943)上有所不同。对于 vagger，范围是整个操作系统:应用程序可以访问运行它的完整虚拟机和操作系统的任何和所有组件。另一方面，对于 Docker 来说，范围要窄得多，因为隔离环境仅限于单个应用程序或服务:每个容器都是专门为一个应用程序创建的。实际上，这意味着使用 vagger，一个单独的隔离环境可以同时运行多个应用程序，而使用 Docker，运行多个应用程序通常需要为每个应用程序使用单独的隔离环境。

### 资源消耗

由于游民用完整的操作系统虚拟了一整台机器，自然开销成本很高，消耗了主机大量的资源。另一方面，使用 Docker，容器中的应用程序与其他容器中的应用程序和主机本身共享相同的[内核](https://www.webopedia.com/TERM/K/kernel.html)—操作系统的核心模块或组件。这使得容器比虚拟机具有更少的开销，从而消耗更少的主机资源。实际上，一台运行带有容器的应用程序的主机最多可以运行三倍于虚拟机数量的应用程序。此外，由于在容器中启动应用程序不需要等待虚拟操作系统启动，因此 Docker 启动应用程序的速度也比 vagger 快得多。

### 限制

流浪汉和码头工人也有各自的局限性。例如，Docker 目前可用于两种操作系统:Linux，它使用 Linux 内核；和 [Windows](https://docs.docker.com/docker-for-windows/) ，它使用 Windows 内核。Docker 也可用于 [MacOS](https://docs.docker.com/docker-for-mac/) ，尽管它在 Linux 虚拟机上运行 Docker 容器。此外，Docker 有一些[安全问题](https://www.itworld.com/article/2915530/virtualization/containers-vs-virtual-machines-how-to-tell-which-is-the-right-choice-for-your-enterprise.html)——它对容器的使用使得它不如流浪者安全。由于 Docker 容器中的应用程序彼此之间以及与主机共享相同的内核，Docker 容器中的恶意程序有可能影响其他容器，甚至损害主机本身。

虽然使用虚拟环境的 Vagrant 在这方面要安全得多，但它也有局限性，因为它仅仅是一个用于[开发](https://www.vagrantup.com/intro/index.html)的工具，通常不建议在生产环境中使用。换句话说，它旨在提供一种方便的方式来虚拟化应用程序最终将部署到的服务器环境，但是一旦投入生产，应用程序必须直接在主机上运行。另一方面，Docker 在整个软件开发工作流程中，从创建到生产，为应用程序提供了一个[一致的环境](https://www.docker.com/what-docker)。

## 结论

能够将应用程序隔离到它们自己的受控环境中已被证明对软件开发非常有用，因为它消除了应用程序在不同机器上执行时可能遇到的许多硬件和软件不兼容问题。这在 DevOps 环境中特别有用，因为它通过消除意外问题的来源简化了整个软件开发工作流，从而潜在地缩短了开发周期。

我们已经研究了两个流行的环境隔离工具，流浪者和码头工人。两者都将应用程序与主机隔离开来，尽管程度不同，使用的技术也不同。vagger 使用虚拟机，它可以同时支持多个应用程序，但会消耗大量资源，只建议在开发期间使用。另一方面，Docker 使用容器，容器仅支持单个应用程序，但在资源消耗方面要轻得多，并且可以在开发和生产过程中使用。

因此，这两个工具可以满足不同的业务需求。如果你需要开发一个由多个相互交互的应用程序组成的复杂系统，使用 vagger 可能是有益的，但是如果你的目标是创建一个单独的可移植的应用程序，并且希望最小化资源消耗，那么 Docker 是一个不错的选择。

— [米隆·莫奈](https://devops.com/author/myron-monets/)