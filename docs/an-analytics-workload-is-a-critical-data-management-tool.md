# 分析工作负载是一种重要的数据管理工具

> 原文：<https://devops.com/an-analytics-workload-is-a-critical-data-management-tool/>

从组织的角度来看，分析工作负载是获得数据驱动的业务优势的一种方式。[分析](https://devops.com/?s=analytics)工作负载可以作为主要目标，转化为可操作的业务影响(例如分析 A/B 测试结果、了解用户保留情况或发现流程中的异常情况)，也可以作为分析的支持角色(例如提高数据集质量、为用户消费准备数据集或遵守数据相关法规)。

理想情况下，工作负载应具有可衡量的投资回报，并应根据关键绩效指标进行监控，如业务影响、交付时间、执行成本和总支出与分配的预算。以这种方式管理工作负载对数据团队来说极具挑战性。事实上，[大数据分析项目](https://varada.io/text-analytics/)的影响以及在这些项目上花费的精力和资源往往是不可预测的。

您可以将工作负载放在一个范围内:在一端，您的工作负载非常接近其业务消费者。另一方面，您有辅助和支持用途的工作负载。后者是最难跟踪、预算和衡量其投资回报(ROI)的。

## 查询与工作负载

当数据平台团队承担评估和实施分析工作负载所需的基础设施的任务时，他们倾向于从技术需求的角度来看待它。分析工作负载是一组读写数据集的查询；它消耗计算、存储和内存资源，并具有预期的可用性、稳定性和性能水平。

在工作负载中改善成本和用户体验的一种传统方法是专注于特定的查询——识别速度慢、负载重和成本高的查询，并逐一优化它们。虽然许多单个查询可以通过重写和优化变得更好(更快、更便宜)，但这种方法通常会忽略整体情况，把钱留在桌面上。

### 知道应该关注哪些查询

除去工作负载上下文，查询只能根据成本或响应时间进行评估。但是业务关键型查询可能不是最昂贵的，也不是最慢的。全面了解工作量有助于更有效地确定工作的优先级。

### 行为波动

周一最重要的查询可能与周五最重要的查询非常不同，因此优化一个或两个查询的效果可能很小。工作负载视角使您能够识别模式并利用洞察力进行有效的优化。

### 云弹性

与传统数据平台不同，云通过按需添加弹性资源，实现了一种强力方法来解决性能问题。虽然这种方法可以改进特定的查询，但当应用于所有查询时，成本会很快失去控制。理解工作负载是区分什么时候强力解决方案是正确的，什么时候需要花时间构建不同的数据流的关键。

### 云解耦

在遗留的 IT 环境中，查询会争夺有限的资源池，优化单个查询会产生重大影响。但是在资源弹性扩展的云环境中，查询之间的竞争规模要小得多。因此，优化单个查询对工作负载的整体性能影响很小。

### 通过查看中位数来衡量绩效

最重或最慢的查询位于查询的前百分位数。当试图改善整体用户体验时，中值性能可能更重要，但在处理极端情况时，它会受到间接影响，因此往往效率较低。

### 长尾理论

在许多工作负载中，一些高度可见的查询可能会造成误导。少于 10 个查询负责 20%的负载，而成千上万个普通的“简单”查询负责 80%的负载是很常见的。因此，当数据团队[试图降低成本](https://varada.io/blog/the-data-virtualization-evolution/)时，专注于最昂贵的查询可能会将注意力从“简单”查询中更容易实现的优化机会上转移开。

### “全局”优化

改进查询的操作(如更改数据集的布局)可能会对其他查询产生意想不到的后果。只有工作负载视角才能帮助评估跨其他查询的更广泛影响。

## 优化大数据分析的集群方法

优化数据平台的另一种传统方法是从集群的角度分析行为。大多数数据平台都提供了不错的技术指标集群监控，比如 CPU 负载和 RAM 使用情况。

但是，关注基于集群的 KPI 会将注意力从影响最大的元素上转移开。理解工作负载需要理解查询的业务逻辑:重复的查询模式、隐藏的依赖关系、失败模式。

从集群的角度来看，这将使您受限于技术参数，比如 CPU 使用率。如果不了解工作负载，数据团队将会遗漏一些问题，例如重复计算(将被纳入 ETL 流程)或不一致的计算流程(比如用不同的方法计算相同的业务 KPI)。

在不同工作负载共享集群的环境中，数据团队经常会遇到额外的挑战:

### 工作负载有业务环境，而集群没有

从集群的角度来看，查询之间没有内在的优先级，数据团队发现很难只关注业务关键型工作负载。结果往往是回到关注特定的查询，这并不能提供有效的解决方案。

### 工作负载有不同的需求

例如，ETL 工作负载可能需要大量的 RAM、运行时间，并且必须在早上 7 点之前完成。交互式数据产品工作负载可能由数千个查询组成，每个查询必须在 2 秒内返回。将集群作为一个单元进行分析可能会导致两种工作负载的行为都不理想。虽然可以认为这个示例很容易发现，但是许多看似相似的工作负载可能有着非常不同的需求。

随着[数据湖](https://devops.com/?s=data%20lake)成为生产级大数据分析架构，数据团队需要将注意力从优化查询转移到测量、分析和优化工作负载上。在大数据的早期，数据仓库是孤立的数据平台，其任务是为一组非常具体的业务问题提供见解。但是随着云的快速发展，仅仅将数据仓库迁移到云中是不够的。下一步是将生产工作负载转移到数据湖。

存储要便宜得多，而且组织希望在任何需要的时候对任何数据集运行查询。这是许多不同查询的异构集合，需要工作负载级别的可见性，以确保每个工作负载都能真正满足性能和预算要求。