# 在 Git 和 DevOps 的交叉口

> 原文:[https://devops.com/at-the-intersection-of-git-and-devops/](https://devops.com/at-the-intersection-of-git-and-devops/)

大家都知道 [Git](https://en.wikipedia.org/wiki/Git_%28software%29) 。这是最受欢迎的开发工具，理由很充分。开发人员喜欢它的灵活性、速度和就地分支的能力。这也吸引了社区发展。

但是随着开发人员在企业中采用 Git，it 经理面临着协调开发人员的需求和更大组织的需求的挑战，尤其是在 DevOps 方面。在本文中，我们将研究其中的一些挑战，并提出可以缓解这些挑战的最佳实践。

## 表演

IT 组织通常依赖性能和低延迟作为任何解决方案适用性的关键指标。针对 Git 网络操作运行的速度测试产生了令人印象深刻的结果，因为用于传输数据的 Git 协议是高度优化的。然而，随着时间的推移，一个内部实现暴露出一些限制，这些限制会影响交付管道的速度和效率。

首先，Git 非常适合小项目。然而，当项目变得越来越大时，许多团队会感受到其全有或全无架构的压力。需要处理项目的开发人员必须检索(或“克隆”)与之相关的每个文件。对于企业软件来说，这种必要性并不总是可行或可取的。大型项目可能需要大量的磁盘空间和时间来克隆，即使许多存储库内容可能与开发人员无关。Git 克隆的全有或全无的方法也损害了安全性——用户将对整个存储库拥有相同的访问权限，不管他们是否应该拥有它。

其次，Git 针对相当小的资产进行了优化，比如代码和配置文件。但许多组织需要对大型二进制文件(如图像、视频和 CAD 设计)进行版本管理。大型二进制文件通常也是构建系统的产物。这些内容会迅速扩大存储库的大小，进而扩大开发人员的文件系统。大文件的一个不太明显的问题是，一些 Git 函数需要计算存储库内容的哈希值。因此，大型二进制资产会莫名其妙地使一些操作变得缓慢，而另一些操作几乎立即执行。为了解决这些问题，您应该为您的大型二进制资产使用一个外部存储。外部资产存储没有正式的标准，但是有一些选项，包括 git-annex 和 Git LFS。

Git 提供的解决方案是将组件分离到专用的存储库中，或者使用 Git 子模块。这两种方法都会导致 Git 蔓延，这种情况会增加复杂性和风险。使用窄克隆方法可以避免 Git 蔓延。窄克隆使开发人员能够从代码库中检索他们需要的子集。尽管开发人员社区早就要求这个特性，但是 Git 目前还不支持窄克隆。出于这些原因，您应该在提供窄克隆的 Git 管理系统上标准化，同时尽可能使用浅克隆来限制文件修改。

只要存储库在逻辑上按照组件划分，开发人员可能不会遇到 Git 蔓延的任何直接问题。相比之下，构建和测试团队可能会立即感受到痛苦。试图从许多不同的存储库中找到文件的所有正确和相关的修订是一个昂贵和危险的过程。如果输入文件不正确，构建将经常失败。理想的敏捷工作流支持每次检入时的构建和测试，尤其是在主线上。如果构建经常失败，构建和测试系统将无法跟上开发的步伐，并将减慢整个 DevOps 管道的速度。

Git 蔓延可能导致的另一个不好的实践是不同团队或存储库的不一致或冲突的分支模型。对于构建和测试团队来说，处理单个开发人员或团队的特质是不必要的沮丧和低效。但是 Git 不支持跨多个开发团队定义或实施分支策略。由于这个原因，定义一个整体的分支策略，在整个组织中使其社会化，并在持续的基础上审查实践是至关重要的。

## 主办；主持

Git 云部署的托管选项非常丰富。采用 Git 的组织需要仔细评估这些选项，因为选择不仅会影响信息安全，还会影响开发运维。开发人员通常会寻找一些选项，使得创建新项目、克隆或派生并推进他们的工作变得容易，最好是使用优秀的评审工具和简单的方法来将工作单元交付给主分支。

开发人员对易用性的渴望经常与 DevOps 对可伸缩性的需求相冲突。可用的 Git 管理系统在支持企业 it 的能力上有很大差异，从单服务器拓扑一直到集群，在某些情况下还有高可用性。请注意，这些解决方案都不支持灾难恢复。因此，组织需要确定用于备份和恢复的工具，同时还要定义内部流程，以确保系统可以在灾难事件后恢复。

## 安全性

开发人员对速度和可定制性的需求也经常与企业保护 Git 中知识产权的需求背道而驰。关键问题是 Git 缺乏一个健壮的、可管理的细粒度访问控制机制。Git 仅限于以身份验证的形式提供安全性；用户必须出示凭据(用户名/密码或 SSH 密钥)才能访问私有存储库。一旦用户访问了存储库，Git 就无法控制用户做什么。虽然这对于民主化的、基于社区的开源开发来说很有效，但是它为企业制造了安全漏洞和遵从性问题。

出于这些原因，考虑必要的角色和权限至关重要，这将使开发人员和开发人员能够完成他们的工作，同时最大限度地降低托管 Git 解决方案带来的风险。应该始终为人员提供对资产的“最低特权”访问，也就是说，应该只授予他们完成任务所必需的权限。出于合规性目的，通常需要提供日志来显示谁在何时做了什么。对于医疗保健和金融等受监管行业的企业来说，这一要求尤其如此。然而，Git 让用户能够摧毁几乎所有形式的历史证据。同样，这对开发人员很有用，但对信息安全性和可管理性不利。

总之，在 Git 管理解决方案激增的同时，DevOps 正在渗透到企业的 IT 部门。在 DevOps 的环境中，竞争的 Git 管理解决方案之间的差异变得最为明显。请记住，DevOps 必须在应用程序生命周期中管理*一切*。仅仅从开发团队的角度评估 Git，而不考虑 DevOps 的需求，可能会导致您的 DevOps 计划的失败。

## 关于作者/马克·沃伦

马克·沃伦是英国 [Perforce](https://www.perforce.com/) 公司的产品营销总监。Mark 在软件开发工具和配置管理领域拥有超过 25 年的开发和产品管理团队工作经验。