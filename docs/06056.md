# 通过利用 Kubernetes 审计日志，尽早发现新出现的安全风险

> 原文:[https://devo PS . com/catch-emerging-security-risks-early-by-leveraging-kubernetes-audit-logs/](https://devops.com/catch-emerging-security-risks-earlier-by-leveraging-kubernetes-audit-logs/)

当 Kubernetes 部署遭遇安全漏洞时，安全团队可能很难诊断和确定入侵的来源及其影响。每个 Kubernetes 集群可能托管多个应用程序，每个应用程序可能由几十个甚至几百个交互的微服务组成，这些微服务被部署为 pod。

应用组件之间复杂而动态的通信，以及自动化的 Kubernetes 编排活动，使得很难理解每个应用的结构，也很难从观察到的网络活动中区分正常行为和恶意行为。豆荚的短暂性使得这项任务变得更加困难，在被处理掉之前，豆荚可能只在执行某项活动的瞬间存在。在安全团队调查违规行为时，易受攻击的 pod 可能已经消失，或者在攻击者暂停滥用、将攻击转移或升级到另一个 Kubernetes 资源时恢复正常操作。

K8s 本质上是动态的、灵活的和可扩展的，正是云原生应用程序开发人员的这一优势成为了安全专业人员的挑战。如果不深入了解应用程序的体系结构，如何理解违规的来源，更不用说它是如何在系统中传播的了？

跟踪违规问题的一个解决方案是检查 Kubernetes 审计日志，因为它们记录了所有集群管理活动，甚至是可能已经存在了几秒钟而现在已经消失的 pod。但是 K8s 审计日志很复杂，经常令人费解，需要很深的专业知识才能理解。因此，安全团队不仅需要提高他们对 K8s 审计日志的熟练程度，还需要对 K8s 日志应用自动化和软件工具，以便在事后甚至在可疑行为发生期间检测到可疑行为。

事实上，当观察可疑行为的审计日志时，可以发现许多潜在的威胁。它们包括:

*   被盗或滥用的凭证，使黑客能够访问基于 K8s 的集群或 pod。
*   基于错误配置规则的访问控制(RBAC ),支持横向攻击传播、权限提升和未经授权的数据访问或操纵。
*   利用 Kubernetes API 服务器中的漏洞，绕过集群管理请求的认证、授权、准入控制或验证。这使得用户能够访问特权和敏感资源。
*   违反安全策略偏离了合规性要求和最佳实践。

## **通过查看 K8s 审计日志，近乎实时地检测违规行为**

从最初的入侵到检测到被入侵的应用程序或对安全数据和私人信息的未授权访问，可能会有很长的时间跨度。安全团队必须尽可能地缩小入侵尝试和检测之间的差距，同时在检测到入侵后仍然能够诊断出入侵的原因，并评估其范围和影响。

由于 K8s 部署可能非常庞大和复杂，机器学习和人工智能是监控审计日志和标记可疑行为的首选工具。自动化工具可以持续扫描日志，以了解公司集群中的正常行为，然后标记异常或可疑的网络行为，以便安全团队进行资格审查、优先排序和调查。这种方法将使安全团队能够近乎实时地调查可能的安全违规，以保护应用程序的安全。

除了检测安全风险之外，利用 K8s 审计日志的安全工具应该提供易于安全团队理解和使用的报告。通过提供正确的用户体验，公司可以使他们的 K8s 日志不仅能被核心专家访问，还能为更多的安全专业人员有效地打开安全可能性的新前景。Kubernetes 艰难的学习曲线将不再是 K8s 专业人士和经验较少的新人之间的一堵墙，缓解了人手不足的安全团队的压力。

## **逐步满足安全性和合规性需求**

随着 Kubernetes 走向主流，大约有 71%的财富 100 强公司[](https://securityboulevard.com/2019/09/16-kubernetes-experts-share-the-most-interesting-current-trends-to-look-for-in-kubernetes/)使用 Kubernetes 作为他们的主要容器编排工具，公司还必须遵守旨在保护金融交易和私人或个人信息的标准和政府法规，如 PCI、GDPR 和 HIPPA。违反这些标准和法规可能会受到严厉的处罚，因此公司应该主动采用 K8s 审计日志监控作为尽早发现违规行为的方法，以限制其对客户和数据的影响，并记录应用程序和潜在黑客的行为，以便进行可能的法律调查。有效的审计日志策略对于确定违规情况下发生了什么至关重要。

## **在 K8s 中利用审计日志实现实时安全观察**

有许多工具可以保护数据中心的边界，并在应用程序开发过程中识别可能的安全风险。在运行时分析和利用 Kubernetes 审计日志的好处相对来说被忽视了。K8s 审计日志是理解 Kubernetes 编排的任何云原生应用程序的行为的主要方式，也是理解 Kubernetes 基础架构本身如何被攻击者滥用来危害其托管的应用程序的最佳方式。因此，安全团队有责任部署工具并主动实时查看 K8s 审核日志，以便最大限度地缩短违规和补救之间的时间，并在运行时验证合规性。这种经过深思熟虑的 Kubernetes 安全方法将大大有助于保护您的部署免受损害。

*要了解更多关于集装箱化基础设施和云原生技术的信息，请考虑来阿姆斯特丹的 [KubeCon + CloudNativeCon EU](https://events.linuxfoundation.org/kubecon-cloudnativecon-europe/) 。CNCF 已决定推迟该活动(原定于 2020 年 3 月 30 日至 4 月 2 日)，改为在 2020 年 7 月或 8 月举行。*

— [尼赞·尼夫](https://devops.com/author/nitzan-niv/)